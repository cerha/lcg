2007-12-05  Tomas Cerha  <cerha@brailcom.org>

	* resources/images/flags/cs.gif: File removed.

	* resources/images/flags/de.gif: File removed.

	* resources/images/flags/en.gif: File removed.

	* resources/images/flags/es.gif: File removed.

	* resources/images/flags/no.gif: File removed.

	* resources/images/flags/sk.gif: File removed.

	* lib/lcg/export/html.py (HtmlGenerator): Tag generation reworked
	to automatically support common attributes for all tags and
	simplify particular tag methods.
	(HtmlExporter._head): Generate links to language variants.
	(HtmlStaticExporter._head): Add hierarchical links to `top' and
	`parent'.

	* lib/lcg/i18n.py (format): Function removed.

2007-12-03  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator.td, HtmlGenerator.form):
	New argument `lang'.

	* lib/lcg/i18n.py (Concatenation.startswith)
	(Concatenation.endswith): Handle the case of no items.

	* lib/lcg/export/export.py: Cosmetic changes.

	* lib/lcg/parse.py: Cosmetic changes.

	* lib/lcg/content.py (Link.export): Removed old hack.

	* bin/lcgmake.py: IMS output option added.

	* lib/lcg/export/ims.py: IMS output made to work after not being
	maintained for some time.

2007-12-01  Tomas Cerha  <cerha@brailcom.org>

	* bin/lcgmake.py: Ignore stylesheet settings for the HHP output.

	* doc/structured-text.cs.txt: Updated.

	* doc/structured-text.en.txt: Updated.

	* lib/lcg/export/hhp.py: Pass export context to index file
	generators.
	(HhpExporter.Generator): New class.
	(HhpExporter.__init__): Method removed.  Implement all tweaks
	within the generator.

	* lib/lcg/content.py (NodeIndex._make_toc): Omit final newline.
	(NodeIndex._export_title): Method removed.
	(Container.export, Paragraph.export, DefinitionList.export)
	(TableRow.export, Table.export, Field.export, FieldSet.export):
	Implemented using the generator.
	(Section._header): Omit final newline.
	(TableCell): Class removed.
	(TableRow): Contain cell content directly.

	* lib/lcg/parse.py (Parser._make_table): Omit `TableCell'
	container.
	(Parser._PRE_BLOCK_RE): Exclude the initial newline from the
	group.  Old syntax disabled.

	* lib/lcg/i18n.py (Concatenation.startswith)
	(Concatenation.endswith): New methods.

	* lib/lcg/export/html.py (HtmlGenerator.tr): New argument `lang'.
	(HtmlGenerator._tag): Insert newlines smartly.
	(HtmlGenerator.h, HtmlGenerator.pre): Insert newlines.
	(HtmlExporter._parts): Don't insert newlines between pargs.

2007-11-30  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py: Import `urllib'.

	* lib/lcg/export/html.py (HtmlGenerator.uri): Escape the generated URI.

	* lib/lcg/content.py (WikiText): Renamed to `FormattedText'.

2007-11-26  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Minor fix.

	* lib/lcg/i18n.py (LocalizableDateTime): Added support for
	suppressing leading zeros in the formatted date.

	* lib/lcg/export/export.py (MarkupFormatter): Allow explicit link
	description in the markup.

	* lib/lcg/export/html.py (HtmlFormatter._link_formatter): Handle
	explicit link description in the markup.

	* lib/lcg/content.py (SectionContainer._exported_content): TOC
	generation condition fixed.
	(Link): Allow passing explicit `descr' to the constructor.

2007-11-21  Tomas Cerha  <cerha@brailcom.org>

	* Makefile: Don't pass the explicit stylesheet to `lcgmake'.

	* NEWS: Updated.

	* bin/lcgmake.py: Respect the changes in underlying the APIs.  Use
	the stylesheet `default.css' by default.

	* bin/lcg-formatter.py: Respect the changes in the underlying
	APIs.  Minor improvements and documentation updates.

	* lib/lcg/export/export.py (Exporter.Context): New class.
	(Generator, MarkupFormatter, Exporter): Pass along the
	`Exporter.Context' instance instead of the exporter itself.

	* lib/lcg/export/html.py (HtmlGenerator.td): New argument 'scope'.
	(HtmlGenerator.table): New argument 'summary'.
	(HtmlExporter): Respect the changes on node API.
	(HtmlExporter, HtmlFormatter): Expect exporter context in all
	methods.

	* lib/lcg/_test.py: Updated.
	
	* lib/lcg/util.py (SplittableText, Counter): Classes removed.

	* lib/lcg/resources.py: Minor fixes.

	* lib/lcg/read.py: Major API cleanup and documentation.

	* lib/lcg/nodes.py (ContentNode): The constructor argument and
	method `language_variants' renamed to `variants'.  Constructor
	arguments and methods `language' and `secondary_language' removed.

	* lib/lcg/content.py: Expect exporter context in all `export()'
	methods, not the exporter directly.
	(SectionContainer): Generate the index in export time.
	(ContentVariants): New class.

2007-11-20  Tomas Cerha  <cerha@brailcom.org>

	* doc/_index.txt: Updated.

	* doc/usage/usage.en.txt: Updated.

	* doc/data-formats/data-formats.en.txt: File removed.

	* doc/data-formats/structured-text.cs.txt: Moved directly to `doc'.

	* doc/data-formats/structured-text.en.txt: Moved directly to `doc'.

	* doc/data-formats/structured-text.pl.txt: Moved directly to `doc'.

	* lib/lcg/i18n.py (GettextTranslator): Use the translation path as
	a sequence to search for translations, not as a dictionary.

	* translations/help.txt: File removed.

2007-11-05  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/resources.py (SharedResourceProvider.__init__): Expect a
	sequence of input directories as an argument.

	* lib/lcg/read.py (FileReader._shared_resource_provider): New
	method.
	(FileReader._resource_provider): Pass the correct output
	subdirectory to `FileResourceProvider'.

	* resources/css/default.css: Exercise styles removed.

	* doc/usage/usage.en.txt: Updated.

	* doc/data-formats/structured-text.cs.txt: Updated.

	* doc/data-formats/structured-text.en.txt: Updated.

	* lib/lcg/i18n.py (Float): Renamed to `Decimal'.

	* lcg-mode.el: Moved to the `eurochance' project.

	* resources/scripts/audio.js: Moved to the `eurochance' project.

	* resources/scripts/exercises.js: Moved to the `eurochance' project.

	* lib/lcg/_test.py (SplittableText): Test removed.

	* doc/data-formats/data-formats.en.txt: Updated.

	* doc/data-formats/exercises.en.txt: Moved to the `eurochance' project.

	* doc/data-formats/plain-text.en.txt: Moved to the `eurochance' project.

	* doc/data-formats/vocabulary.en.txt: Moved to the `eurochance' project.

	* doc/data-formats/_index.txt: File removed.

	* translations/help.cs.txt: Moved to the `eurochance' project.

	* translations/help.de.txt: Moved to the `eurochance' project.

	* translations/help.en.txt: Moved to the `eurochance' project.

	* translations/help.es.txt: Moved to the `eurochance' project.

	* translations/help.no.txt: Moved to the `eurochance' project.

	* translations/help.sk.txt: Moved to the `eurochance' project.

	* translations/lcg-elearning.de.po: Moved to the `eurochance' project.

	* lib/lcg/export/html.py (HtmlStaticExporter._INDEX_LABEL): Unused
	constant removed.

	* lib/lcg/__init__.py: Updated.

	* bin/lcgmake.py: Don't print traceback on `SystemExit'.

	* lib/lcg/content/__init__.py: File removed.

	* lib/lcg/locales.py (LocaleData_sk.decimal_point): Added.

	* lib/lcg/feed.py: Moved to the `eurochance' project.

	* lib/lcg/content/content.py: Moved to `lib/lcg/content.py'.

	* lib/lcg/content/exercises.py: Moved to the `eurochance' project.

	* lib/lcg/content/vocab.py: Moved to the `eurochance' project.

2007-11-01  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlExporter._output_file)
	(HtmlExporter._language_selection): Use `node.language()' instead
	of `node.current_language_variant()'.

	* lib/lcg/nodes.py (ContentNode.current_language_variant): Method
	removed.

2007-10-30  Tomas Cerha  <cerha@brailcom.org>

	* resources/media/responses/c02.mp3: File removed.

	* resources/media/responses/c04.mp3: File removed.

	* resources/media/responses/i01.mp3: File removed.

	* resources/media/responses/i05.mp3: File removed.

	* translations/lcg.cs.po: Language name translation from `lcg-locale' moved here.

	* translations/lcg.de.po: Language name translation from `lcg-locale' moved here.

	* translations/lcg.es.po: Language name translation from `lcg-locale' moved here.

	* translations/lcg.no.po: Language name translation from `lcg-locale' moved here.

	* translations/lcg.pl.po: Language name translation from `lcg-locale' moved here.

	* translations/lcg.sk.po: Language name translation from `lcg-locale' moved here.

	* translations/lcg-locale.cs.po: File removed.

	* translations/lcg-locale.de.po: File removed.

	* translations/lcg-locale.en.po: File removed.

	* translations/lcg-locale.es.po: File removed.

	* translations/lcg-locale.no.po: File removed.

	* translations/lcg-locale.pl.po: File removed.

	* translations/lcg-locale.sk.po: File removed.

	* lib/lcg/locales.py: New file.
	
	* lib/lcg/util.py: Translation domain changed to `lcg'.

	* lib/lcg/_test.py (Monetary): New test.

	* lib/lcg/__init__.py: Import `locales'.

	* lib/lcg/i18n.py (Float, Monetary): New localizable types.
	(LocaleData): Class moved to the new module `locales'.

	* lib/lcg/locales.py: New file.

2007-10-29  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py: Don't use `ContentNode.meta()', but
	allow meta tags customization in derived class.

	* lib/lcg/export/export.py (MarkupFormatter): Added support for
	variable substitution.

	* lib/lcg/nodes.py (ContentNode): New option and access method
	`globals'.  The method `meta()' removed.

2007-10-25  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator.table)
	(HtmlGenerator.thead, HtmlGenerator.tfoot, HtmlGenerator.tbody):
	New methods.
	(HtmlGenerator.img): New argument `border'.
	(HtmlExporter._language_selection): Added generic support for
	language images in derived classes.

2007-10-24  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/parse.py (Parser._make_toc): Use `None' as default
	`depth'.

	* lib/lcg/content/content.py (NodeIndex, TableOfContents): Take
	`depth=None' as unlimited.  Default `depth' changed to `None'.
	(NodeIndex): Default value of `detailed' changed to `False'.

2007-10-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/_test.py (LocalizableDateTime.check_format): Updated.

	* lib/lcg/util.py (datetime_formats): Function removed.

	* lib/lcg/i18n.py 
	(LocaleData): New class.
	(Translator.locale_data): New method.
	(Translator.translate): Pass locale data to `format()'.
	(Translator.__init__): Initialize locale data, not `datetime_formats'.
	(LocalizableDateTime.format): Use locale data, not `datetime_formats'.

	(format): Expect Loc

2007-10-04  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator.th, HtmlGenerator.td)
	(HtmlGenerator.tr): New methods.

2007-09-26  Tomas Cerha  <cerha@brailcom.org>

	* translations/Makefile: Get source files using 
	`python -m lcg/i18n ...'
	(cvs-update): Overwrite locally modified files.
	
	* lib/lcg/i18n.py: Make the module executable by 
	`python -m lcg/i18n ...'

2007-09-25  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator.abbr): New method.

	* Makefile: Check python path before installation.

2007-09-24  Tomas Cerha  <cerha@brailcom.org>

	* Makefile: Allow repeated cvs-install.

2007-09-18  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/content.py (RootIndex): New class.

	* lib/lcg/export/export.py (MarkupFormatter.format): Preserve
	translatable text instances within formatter output.

	* lib/lcg/export/html.py (HtmlGenerator.select): New argument `title'.

	* lib/lcg/nodes.py (ContentNode.__init__): Don't add current language to
	`language_variants'.

2007-09-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator.noscript): New method.

2007-09-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/parse.py: Tolerate whitespace at the end of definition
	descriptions.

2007-09-11  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/export.py (MarkupFormatter._markup_handler):
	Don't perform translation here.

2007-09-07  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/nodes.py (ContentNode): Added the `active' flag.

	* lib/lcg/content/content.py (NodeIndex): Use `inactive' css class
	for inactive nodes.

	* lib/lcg/export/html.py: Misc. optimizations.  
	(fieldset): Argument order changed.

2007-08-31  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/read.py: Fixed bugs in latest chenges.

	* doc/usage/usage.en.txt: The relevant information from removed
	files moved here.

	* doc/usage/_index.txt: File removed.

	* doc/usage/custom-interface.en.txt: File removed.

	* doc/usage/generic-interface.en.txt: File removed.

2007-08-29  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/resources.py (_FileResourceProvider._resource): Handle
	also new style Resource classes.

	* bin/lcgmake.py: Print detailed tracebacks.  Use the new `reader'
	function to allow python reader as the root reader.

	* lib/lcg/read.py (reader): New function. 
	(DocDirReader._create_children): Use it.

	* lib/lcg/config.py (allow_backref): New option.

	* lib/lcg/content/content.py (Section.backref): Check 'config.allow_backref'.
	(link): Added assertion.
	(NoneContent): New class.

2007-08-28  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/content.py (Title): New class.

	* lib/lcg/i18n.py: Translate also the default text of
	'SelfTranslatableText' instance.

2007-08-27  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/_test.py: Added tests for function based variable
	interpolation.

	* lib/lcg/i18n.py: Added support for variable interpolation using
	a function.

2007-08-23  Tomas Cerha  <cerha@brailcom.org>

	* Makefile: Run cvs update with -dP.

	* lib/lcg/export/html.py (HtmlGenerator.uri): Ignore arguments
	with None value.

2007-08-22  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py: Allow `title' for `submit' and `reset'
	buttons.

	* lib/lcg/content/content.py: Wrap exported sections into divs
	named by the section id.

	* lib/lcg/i18n.py: Added support for setting translation source
	language.

2007-08-17  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator.submit): New argument `value'.
	(HtmlExporter._language_selection): Anchor name changed.

2007-08-10  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/util.py (unindent_docstring): New method.

	* lib/lcg/read.py (Reader): Allow derived classes to easilly
	define static node constructor arguments using the new constant
	`_DEFAULTS'

2007-08-08  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlStaticExporter._navigation):
	Elements marked by css classes.

	* resources/css/default.css: Improved navigation

2007-08-07  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/resources.py (FileResourceProvider._resource): Fallback
	resource constructor arguments fixed.
	(SharedFileResourceProvider): Renamed to `SharedResourceProvider'.

	* lib/lcg/read.py: Use `SharedResourceProvider' for all readers by
	default.

	* lib/lcg/_test.py (TranslatableTextFactory.check_domain)
	(check_translate): Use named arguments in translation strings.

	* bin/lcg-formatter.py (main): `SharedFileResourceProvider' ->
	`SharedResourceProvider'.

	* lib/lcg/export/html.py (HtmlGenerator.span): New argument `style'.
	(HtmlStaticExporter._navigation): Use breadcrumb navigation
	instead of `Up' and `Top' links.

2007-06-25  Tomas Cerha  <cerha@brailcom.org>

	* doc/index.en.txt: Removed references to the Eurochance related docs.

	* doc/usage/custom-interface.en.txt: Removed references to the
	Eurochance related docs.

	* doc/eurochance/*: Removed.
	
	* bin/lcg-formatter.py: New file.

	* bin/wiki-formatter.py: File removed.

	* bin/generate.py: File removed.

	* bin/pydoc.py: File removed.

	* lib/lcg/eurochance.py: File removed.

2007-06-14  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/read.py: Pass the file related arguments only when the
	child reader is a `FileReader'.  Expect a 'Reader' in a python
	source file, not an 'IndexNode'.

	* lib/lcg/content/content.py: New features in content
	construuction convenience functions.

	* lib/lcg/export/html.py: Fixed broken `div' export.

2007-06-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlGenerator): Allow css class setting
	for generated parts.
	(HtmlGenerator.map): New argument `id'.

	* lib/lcg/_test.py: Updated.

	* lib/lcg/i18n.py: Added support for translatable text with predefined
	translations (capable of self-translation).

2007-06-01  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py: Language selection anchor added.
	Generate language selection for all nodes by default.

2007-05-25  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py: Cosmetic changes.

	* lib/lcg/content/content.py: Cosmetic changes.

	* lib/lcg/resources.py (StaticResourceProvider.resource): Handle
	the `fallback' argument correctly.

2007-05-24  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/nodes.py (ContentNode._node_path): Renamed to `path()'.

	* lib/lcg/content/content.py (NodeIndex): Improved current node recognition.

2007-05-23  Tomas Cerha  <cerha@brailcom.org>

	* bin/lcgmake.py: Use the reader interface to construct the
	publication.

	* lib/lcg/__init__.py: Added the `read' module.

	* lib/lcg/resources.py: New `ResourceProvider' interface implemented.

	* lib/lcg/nodes.py: Definitely got rid of all the stuff related to
	reading the structure from input files etc (moved to the new
	module `read.py').

	* lib/lcg/read.py: New file.

	* doc/intro.en.txt: Updated.

2007-04-23  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/content.py (NodeIndex): Allow passing explicit top node.
	Support node descriptions as link titles.  Mark the current node
	by a css class.

	* lib/lcg/export/html.py: Minor formatting improvements.

2007-04-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/content.py (link): Improved docstring and assertion.

2007-04-02  Tomas Cerha  <cerha@brailcom.org>

	* bin/lcgmake.py: New command line option `inline-styles'.

	* lib/lcg/i18n.py: Handle also localizable dates used as
	translatable text substitution arguments.

	* lib/lcg/export/html.py (HtmlStaticExporter): Print navigation
	rules only if navigation is needed.

2007-03-26  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/hhp.py: Use a custom formatter.

	* lib/lcg/export/html.py: Separate file dump into a mix-in class.

2007-03-17  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/util.py (log): Flush.

	* lib/lcg/content/content.py (Link.export): Use `concat' instead
	of string `join'.

	* lib/lcg/export/html.py (HtmlGenerator.sup, HtmlGenerator.sub):
	New methods.

2007-03-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/resources.py: Derive `XStylesheet' from `Stylesheet'.

2007-03-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/exercises.py: Omit Answer sheet and Help links
	if their nodes were not set.

	* bin/lcgmake.py: Respect the changes in the `Exporter' interface.

	* bin/generate.py: Respect the changes in the `Exporter'
	interface.

	* lib/lcg/export/html.py: Improved support for `Resource' links in
	the formatter.  Changes in the `Exporter' interface.

	* lib/lcg/resources.py: Completely rewritten to support flexible
	resource construction.  Old resource classes which are bound to
	files were renamed to `X*' to make the distinction now and allow
	their complete replacement in the future.

	* lib/lcg/wiki.py: Renamed to `parse.py'.

	* lib/lcg/export/export.py: Don't support explicit resource type
	specification in link.

	* lib/lcg/content/content.py: Allow an `InlineImage' to
	be a `Link' label.  Alignment and other options for
	`InlineImage'.  `Resource' as a `Link' target.

2007-03-08  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py: Don't import `_html'.

	* lib/lcg/export/html.py: Implement an HTML generator.

	* lib/lcg/export/_html.py: Removed.

	* lib/lcg/content/exercises.py: Use generator instead of the
	`_html' module.

	* lib/lcg/export/export.py: Define a generic generator and
	instantiate one automatically in `Exporter' constructor.

	* lib/lcg/content/vocab.py: Use generator instead of the `_html'
	module.

	* lib/lcg/content/content.py: Use generator instead of the `_html'
	module.

2007-03-07  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py: Added support for image allignment
	markup.

	* lib/lcg/export/_html.py: Support the `align' argument for `img()'.

	* lib/lcg/content/content.py: New functions for convenient content
	creation.

2007-02-26  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/_html.py: Added support for file upload form
	controls.

	* lib/lcg/content/content.py (Content): Pass constructor keyword
	arguments on.

2007-02-02  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/*.py: Removed unnecessary `coding' line.
	
	* lib/lcg/util.py: Don't import `types'.

	* lib/lcg/__init__.py (__version__): Also update the namespace of
	`vocab'.

	* lib/lcg/content/__init__.py: Import also `vocab'.

	* lib/lcg/export/export.py (MarkupFormatter.__init__): Use `str'
	and `tuple' instead of `type.StringType' and `type.TupleType'.

	* translations/Makefile (clean): New target.

	* INSTALL: Rewritten.

	* Makefile (cvs-install, cvs-update): New targets.

2007-01-18  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlMarkupFormatter._BLANK_MATCHER): New
	constant.
	(HtmlMarkupFormatter._maybe_image): New method.
	(HtmlMarkupFormatter._link_formatter): Arg. `title' -> `label'.
	Use `_maybe_image()'.  Use `_BLANK_MATCHER' to find an image in
	the label.
	(HtmlMarkupFormatter._uri_formatter) 
	(HtmlMarkupFormatter._email_formatter): `title' -> `label'.

	* lib/lcg/export/export.py (MarkupFormatter._MARKUP): Link group
	`title' renamed to `label'.
	(MarkupFormatter._MARKUP): `title' -> `label'
	(MarkupFormatter._MARKUP): Require a letter at the end of email
	address.

	* lib/lcg/export/_html.py (list): Add newlines.
	(img): New argument `cls'.

2006-12-23  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (install): Don't depend on `translations'.
	(release): Depend on `compile'.


2006-12-22  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/_test.py (LocalizableDateTime): New test.

	* lib/lcg/i18n.py (Localizable): New class.
	(TranslatableText, Concatenation): Derive from `Localizable'.
	Updated docstrings.
	(TranslatableText.__add__, TranslatableText.__radd__)
	(Concatenation.__add__, Concatenation.__radd__): Methods removed.
	(LocalizableDateTime): New class.
	(Translator.__init__): New methods.
	(Translator.translate): Format `LocalizableDateTime' instances.

	* lib/lcg/util.py (_): Domain set to `lcg-locale'.
	(datetime_formats): New function.

	* translations/Makefile: Added domain `lcg-locale'.

	* translations/lcg.cs.po: Updated.

	* translations/lcg.de.po: Updated.

	* translations/lcg.es.po: Updated.

	* translations/lcg.no.po: Updated.

	* translations/lcg.pl.po: Updated.

	* translations/lcg.sk.po: Updated.

	* translations/lcg-locale.sk.po: New file.

	* translations/lcg-locale.no.po: New file.

	* translations/lcg-locale.de.po: New file.

	* translations/lcg-locale.cs.po: New file.
	
	* translations/lcg-locale.en.po: New file.

	* translations/lcg-locale.es.po: New file.
	
	* translations/lcg-locale.pl.po: New file.

2006-12-21  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/_html.py (_input): New argument `tabindex'.
	(field): New argument `password'.

2006-12-14  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlStaticExporter._navigation): Added
	"Top" label to the root node link.

	* doc/data-formats/structured-text.pl.txt: 'TON' -> `NodeIndex'.

	* doc/data-formats/structured-text.en.txt: 'TON' -> `NodeIndex'.

	* doc/data-formats/structured-text.cs.txt: 'TON' -> `NodeIndex'.

	* lib/lcg/eurochance.py (AnswerSheets._create_content)
	(Help._create_content, EurochanceCourse._create_content):
	`TableOfNodes' -> `NodeIndex'.

	* lib/lcg/wiki.py (Parser._MATCHERS): The 'TON' macro renamed to
	`NodeIndex'.
	(Parser._make_toc): Respect the name changes.

	* lib/lcg/content/content.py (TableOfNodes): Renamed to `NodeIndex'.

	* lib/lcg/export/_html.py (uri): Process also positional arguments
	as key/value pairs.

2006-12-05  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (install): Install also the user tools.

2006-12-04  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py (__version__): Changed to 0.3.4.

	* lib/lcg/_test.py (TranslatableText.check_addition): Test also
	reverse order of arguments.

	* lib/lcg/i18n.py (TranslatableText.__radd__): New method.
	(Concatenation.__radd__): New method.
	(TranslatableText.__add__, Concatenation.__add__): Return
	`NotImplemented' instead of raising an TypeError.

	* lib/lcg/export/_html.py (_input): New argument `maxlength'

	* doc/data-formats/structured-text.pl.txt: New file.

2006-11-16  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/_html.py (strong): New arguments `cls', `id' and
	`lang'.

	* lib/lcg/export/html.py (HtmlExporter._title): A copy/paste bug
	fixed.

2006-11-11  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlExporter._title): New method.
	(HtmlExporter._head): Vyu¾ívej ji.
	(HtmlMarkupFormatter._link_formatter): If there is an image name
	within the link title, let the link be this image.

2006-11-08  Tomas Cerha  <cerha@brailcom.org>

	* translations/lcg.pl.po: Updated.

	* doc/data-formats/structured-text.cs.txt: New file (translation).

	* doc/data-formats/formatting.en.txt: File removed.

	* lib/lcg/wiki.py (Parser._MATCHERS, Parser._make_toc): Allow the
	`@TON@' macro for table ov nodes.
	(Parser._COMMENT_MATCHER): New constant.
	(Parser._parse_blocks): Append the created element only if it's
	not None.
	(Parser._make_paragraph): Remove comments from the text.  If
	nothing remains, return None.
	(Parser.parse): Don't remove comments here.

	* doc/usage/generic-interface.en.txt: Minor updates and fixes.

2006-11-07  Tomas Cerha  <cerha@brailcom.org>

	* structured-text-mode.el: New file.

2006-11-04  Tomas Cerha  <cerha@brailcom.org>

	* translations/lcg.de.po: Updated.
	
	* translations/lcg.es.po: Updated.
	
	* translations/lcg.cs.po: Updated.
	
	* translations/lcg.sk.po: Updated.
	
	* translations/lcg.no.po: Updated.

	* translations/lcg.pl.po: New file.

	* translations/Makefile: Gettext domain `lcg-exercises' changed to
	`lcg-elearning'.

	* translations/lcg-elearning.de.po: New file.
	
	* translations/lcg-exercises.de.po: File removed..

	* lib/lcg/content/exercises.py (_): Gettext domain changed to
	`lcg-elearning'.

	* lib/lcg/content/content.py (VocabItem, VocabList, VocabSection) 
	(VocabIndexSection): Classes moved to `vocap.py'.

2006-11-03  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlExporter._output_file): Replace
	colons in id by hyphens.

	* lib/lcg/export/hhp.py (_Header._lines): Use `Exporter.uri()'
	instead of `ContentNode.uri()'.
	

	* lib/lcg/eurochance.py (EurochanceNode.__init__): Constant
	removed.
	(EurochanceNode.__init__): Default value od `input_encoding' set
	to None.
	(AnswerSheets._create_children, Help._create_children)
	(EurochanceCourse._create_children): Call child constructor
	directly instead of using `self._create_child'.

	* lib/lcg/nodes.py (ContentNode._INHERITED_ARGS)
	(WikiNode._INHERITED_ARGS): Constant removed.
	(ContentNode.__init__): Use parent's `language',
	`secondary_language' and `language_variants' as defaults.
	(ContentNode._create_child): Method removed.
	(FileNodeMixin._init): Default value od `input_encoding' set to
	None.  If given value is None, set `self._input_encoding' to
	`ascii'.
	(DocNode.__init__): Default value od `input_encoding' set to None.
	(DocChapter._create_children): Call child constructor directly
	instead of using `self._create_child'.

2006-11-02  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/_html.py (img): Set the default value of `alt' to
	an empty string.

	* lib/lcg/export/html.py (HtmlMarkupFormatter._link_formatter):
	Supply an empty string as the alt tag if no title was specified.

2006-10-16  Tomas Cerha  <cerha@brailcom.org>

	* translations/lcg.cs.po (Module): Updated.

	* translations/lcg.de.po (Module): Updated.

	* translations/lcg.es.po (Module): Updated.

	* translations/lcg.no.po (Module): Updated.

	* translations/lcg.sk.po (Module): Updated.

	* translations/Makefile: Pass the base directory to the i118
	dpepndency script.

	* lib/lcg/config.py (doc_dir): New variable.

	* lib/lcg/util.py (_LANGUAGE_NAMES): Some more language names
	translated.

2006-10-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/wiki.py (Parser._MATCHERS): Don't allow an empty
	description in definition list.

	* lib/lcg/export/html.py (HtmlMarkupFormatter._IMAGE_URI_MATCHER):
	New constant.
	(HtmlMarkupFormatter._link_formatter): Format image links as
	inline images.

	* lib/lcg/export/_html.py (img): New function.

	* lib/lcg/content/content.py (InlineImage.export): Use
	`_html.img'.

	* lib/lcg/i18n.py (source_files_by_domain): New mandatrory
	argument `basedir'.

2006-09-01  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/util.py (language_name): Return the code if the name was
	not found.

	* lib/lcg/content/content.py (Link.__init__): New argument `type'.
	(Link.export): Pass the `type'.

	* lib/lcg/export/_html.py (link): New argument `type'.
	(select): New arguments `disabled' and `readonly'.
	(checkbox): New argument `value'.
	(uri): New function.

2006-08-24  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/html.py (HtmlExporter._LANGUAGE_SELECTION_LABEL):
	New constant.
	(HtmlExporter._language_selection): Use the constant.  Set the
	link css 'class'.  Simplified.

	* lib/lcg/util.py (_LANGUAGE_NAMES): All names uncommented.

	* lib/lcg/i18n.py (GettextTranslator._gettext_instance): Log an
	arror when the translation file was not found and fallback was set
	to true.

2006-08-23  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/content.py (PreformattedText.export): Use
	`_html.escape' instead of saxutils directly.

	* lib/lcg/export/_html.py (escape): New function.

2006-08-16  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/_html.py (checkbox): New argument `readonly'.
	(textarea): New argument `readonly'.

	* bin/wiki-formatter.py (main): Pass `None' as the `parent'
	argument to `WikiNode' constructor.

	* lib/lcg/nodes.py (WikiNodeMixin.__init__): Pøejmenováno na
	`_init'.
	(FileNodeMixin.__init__): Pøejmenováno na `_init'.
	(WikiNode): Inherit from `FileNodeMixin', not just
	(WikiNode.__init__): `WikiNodeMixin.__init__' ->
	`FileNodeMixin._init()'.
	(DocNode): Derive just from `WikiNode'.
	(DocNode.__init__): `FileNodeMixin.__init__' ->
	`FileNodeMixin._init()'.
	(DocNode.__init__): Pass also `FileNodeMixin._init' args to the
	parent constructor.

	`WikiNodeMixin'.
	(WikiNode.__init__): Pass the `FileNodeMixin' constructor
	its arguments.  The argument `parent' removed.
	(FileNodeMixin._init): 

2006-08-14  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/_html.py (form): New argument `method'.
	(_input): New argument `disabled'.
	(field): The first argument `text' renamed to `value'.
	(submit, checkbox, textarea): New functions.

	* lib/lcg/export/html.py (HtmlExporter._language_selection): Use
	`concat', not string addition.
	(HtmlExporter._language_selection): Use `concat', not string
	addition.

	* lib/lcg/content/exercises.py (Choice.__init__)
	(Exercise.__init__, Exercise._wiki_content): Assert against str
	and unicode, not STRINGTYPES.
	(_ChoiceBasedExercise._format_choices)
	(_InteractiveExercise._results): Pass the `cls' argument to
	`_html.div' as a named argument, not positional.

	* lib/lcg/content/content.py (TextContent._TEXT_TYPE)
	(WikiText._TEXT_TYPE, PreformattedText._TEXT_TYPE): Constant
	removed.
	(Section.__init__, TableOfNodes.__init__, VocabSection.__init__):
	Assert against str and unicode, not STRINGTYPES.

	* lib/lcg/_test.py (TranslatableText.check_string_context): New
	method.

	* lib/lcg/i18n.py (TranslatableText, Concatenation): Derive from
	Python `unicode' type.  Documentation added.
	(TranslatableText.__new__, Concatenation.__new__): New methods.
	(TranslatableText._init_kwargs): Ignore the return value or
	`self._init_kwargs()'.
	(TranslatableText.__str__): Metohd removed.
	(TranslatableText.__add__): Don't use `STRINGTYPES'.  Compare just
	to `str' and `unicode'.
	(Concatenation.__init__.append): Compare to `TranslatableText'
	explicitely.
	(Concatenation.__str__): Method removed.
	(Concatenation.__add__): Don't use `STRINGTYPES'.  Compare just to
	`str' and `unicode'.
	(Concatenation.__add__): Use `concat', not directly
	`Concatenation'.
	(Concatenation.replace): Use `concat', not directly
	`Concatenation'.
	(STRINGTYPES): Constant removed.
	(concat): Compare to `TranslatableText' explicitely.

2006-08-07  Tomas Cerha  <cerha@brailcom.org>

	* bin/lcgmake.py (main): Pass single language to
	`GettextTranslator'.

	* bin/generate.py (main): Pass single language to
	`GettextTranslator'.

	* lib/lcg/_test.py (TranslatableText.check_concatenation): Renamed
	to `check_concat'.  Test also if string/unicode input is
	preserved.
	(GettextTranslator.check_translate): Pass single language to
	`GettextTranslator'.

	* lib/lcg/i18n.py (Translator.__init__): Method removed.
	(NullTranslator.__init__): Method removed.
	(GettextTranslator.__init__): Process all args here.  don't call
	parent class constructor.  Take single 'lang' argument instead of
	the list of languages.  New argument `fallback'.
	(GettextTranslator._gettext_instance): Pass single language to
	`gettext.translation'.  On error, return a `NullTranslation'
	instance if `fallback' was passed to the constructor or if the
	language is `en'.

2006-08-03  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/i18n.py (concat): New function replacing the `concat'
	alias.  When the resulting `Concatenation' is a plain string,
	return just this string (not a `Concatenation' instance.

	* lib/lcg/export/_html.py (div): New argument `id'.
	(map): New function.

	* lib/lcg/export/html.py (HtmlExporter._parts): New method.
	(HtmlExporter._part): New method.
	(HtmlExporter.page): Instead of `_body', call `_parts' directly.
	(HtmlExporter._body): Method removed.

2006-08-02  Tomas Cerha  <cerha@brailcom.org>

	* bin/generate.py (main): Pass a `GettextTranslator' instance to
	the exporter constructor.

	* bin/lcgmake.py (main): Pass a `GettextTranslator' instance to
	the exporter constructor.

	* lib/lcg/_test.py (_): Define as `TranslatableTextFactory'.
	(TranslatableText.check_interpolation): Pass a `NullTranslator'
	instance to `translate'.
	(TranslatableText.check_replace): Pass a `NullTranslator'
	instance to `translate'.  Dont use `HtmlExporter'.
	(TranslatableTextFactory): New test case.
	(GettextTranslator): New test case.
	(HtmlExporter.check_translations): Test removed.

	* lib/lcg/i18n.py (TranslatableTextFactory.__init__): Let the
	`domain' argument be mandatory.
	(TranslatableTextFactory.__call__): Set the `_domain' argument of
	`TranslatableText', not `domain'.
	(TranslatableText._init_kwargs): Argument `domain' renamed to
	`_domain' and it's default value changed to None.
	(TranslatableText.domain): New method.
	(TranslatableText.replace): `domain' -> `_domain'.
	(TranslatableText.translate): Argumnet `gettext' replaced by
	`translator'.
	(Concatenation._translate): Method removed.
	(Concatenation.translate): Argumnet `gettext' replaced by
	`translator'.
	(Translator, NullTranslator, GettextTranslator): New classes.
	(source_files_by_domain.find): Don't exclude `_test.py'.

	* lib/lcg/export/export.py (Exporter.__init__): Argument `lang'
	removed.  New argument `translator'.  Don't initialize the
	`gettext' interface, just rely on the `translator'.
	(Exporter.translate): Postpone the translation to the translator.

	* lib/lcg/export/html.py (HtmlExporter.page): Return the text
	untranslated.
	(HtmlExporter.export): Translate the text returned by `page()'.

	* translations/eurochance.de.po: Updated.

	* translations/help.*.txt: Updated.

	* lib/lcg/eurochance.py (EurochanceNode._GETTEXT_DOMAIN) 
	(ExerciseHelp._GETTEXT_DOMAIN): New constant.
	(EurochanceNode.__init__): Use it.  Log untranslated texts.
	(Instructions._DUMMY_TRANSLATIONS) 
	(ExerciseHelp._DUMMY_TRANSLATIONS): New constants.

	* translations/Makefile (%.d): The `%/LC_MESSAGES' directorty
	added to the .mo file prerequisities.
	(domains): Added `test'.
	(all): Moved prior to the `include' directive.

2006-08-01  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/i18n.py: Print the result of `source_files_by_domain()'
	called with command line arguments if the module is invoked from
	command line.
	(TranslatableTextFactory.domain): New method.
	(source_files_by_domain): New function.

	* lib/lcg/export/html.py: Import `lcg' submodules by their full name.

	* translations/Makefile: Rewritten to support multiple
	domains.

	* translations/lcg.cs.po: New file.

	* translations/lcg.de.po: New file.

	* translations/lcg.es.po: New file.

	* translations/lcg.no.po: New file.

	* translations/lcg.sk.po: New file.

	* translations/lcg-exercises.de.po: New file.

	* translations/eurochance.de.po: New file.

	* translations/cs.po: File removed.

	* translations/de.po: File removed.
	
	* translations/es.po: File removed.

	* translations/no.po: File removed.
	
	* translations/sk.po: File removed.
	
2006-07-31  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/i18n.py (TranslatableTextFactory): New class.
	(TranslatableText._init_kwargs): New method.
	(TranslatableText.__init__): Use it.
	(TranslatableText.replace): Set the `domain' argument approprietaly.

	* lib/lcg/export/html.py (_): Define explicitely.

	* lib/lcg/content/exercises.py (_): Define explicitely.

	* lib/lcg/util.py (_): Define explicitely.

	* lib/lcg/eurochance.py (_): Define explicitely.

	* lib/lcg/_test.py (TranslatableText.check_interpolation): New test.
	(TranslatableText.check_addition): New test.
	(TranslatableText.check_it): Test removed.
	(TranslatableText.check_concatenation): Use `lcg.TranslatableText'
	instead og `_'.
	(TranslatableText.check_replace): Use `lcg.TranslatableText'
	instead og `_'.
	(HtmlExporter.check_translations): Set the `_' before using it.

	* lib/lcg/__init__.py (__version__): Don't install the `_'
	function into builtins.  Update identifiers also in `util'.

2006-07-28  Tomas Cerha  <cerha@brailcom.org>

	* NEWS: New file.

	* translations/cs.po: Updated.

	* translations/de.po: Updated.

	* translations/es.po: Updated.

	* translations/no.po: Updated.

	* translations/sk.po: Updated.

	* translations/Makefile (LCG_SOURCE_FILES): Use find to locate the
	files recursively.

	* Makefile: New file.

	* bin/generate.py (main): Instead of setting `LCG_LANGUAGE' before
	importing lcg, pass the `lang' argument to the exporter.

	* bin/lcgmake.py (main): Instead of setting `LCG_LANGUAGE' before
	importing lcg, pass the `lang' argument to the exporter.

	* lib/lcg/eurochance.py (EurochanceNode): Added
	`language_variants' to `_INHERITED_ARGS'.
	(EurochanceNode.__init__): Initialize the `gettext' instance.
	(EurochanceNode._localized_wiki_content)
	(ExerciseHelp._create_content): Pass `self._gettext' a
	substitution provider for the macro formatter..
	(Unit._title_): Use `concat' for string concatenation.
	(Unit._exercise_sections, ExerciseHelp._title_)
	(AnswerSheet._title_, EurochanceCourse._create_children)
	(EurochanceExporter._version): Pass format variables to `_()' to
	allow delayed translation.
	(IntermediateUnit._exercise_sections): Enumerate the sections and
	supply the number within the section title.

	* lib/lcg/content/exercises.py (Exercise.__init__): New argument
	`title'.  Don't format the default reading instructions.
	(Exercise.export): Replace the `%d' in title by the exercise
	number within the section.
	(Exercise._wiki_content): Assert to `STRINGTYPES' instead of
	`types.StringTypes'.
	(Exercise._formatted_wiki_text): New method.
	(_ChoiceBasedExercise._export_task_parts)
	(GapFilling._export_task_parts)
	(_FillInExercise._export_task_parts)
	(_FillInExercise._export_task_parts, _Cloze._export_task_parts):
	Use it.
	(Exercise._play_button, Exercise.export)
	(Exercise._wrap_exported_tasks)
	(_InteractiveExercise._init_script)
	(_InteractiveExercise._results)
	(_InteractiveExercise._answer_sheet_link)
	(_ChoiceBasedExercise._js_choice_control)
	(_ChoiceBasedExercise._format_choice)
	(_FillInExercise._make_field): Use `concat' for string operations.
	(Exercise._sound_controls): Use `_html.form'.
	(_FillInExercise._make_field): New argument `exporter'.  Translate
	the result.
	(_Cloze._export_task_parts)
	(_FillInExercise._export_task_parts): Pass `exporter' to
	`_make_field'.
	(_FillInExercise._export_task_parts): Use 'format' for formatting
	the task.
	(Cloze._make_field): Translate the result.
	(Cloze._export_task_parts): Translate the `formatter' result.
	(Exercise._export_tasks): Translate the exported tasks and the
	template before putting them together.
	(Exercise.__init__): Make `TextContent' out of the default reading
	instructions.
	(Exercise._export_reading): Cosmetic change.

	* lib/lcg/export/html.py (HtmlExporter.__init__): Pass along the
	parent class constructor arguents as kwargs.
	(HtmlExporter._head, HtmlExporter._body, HtmlExporter._heading)
	(HtmlExporter._language_selection, HtmlStaticExporter._head)
	(HtmlStaticExporter._navigation, HtmlStaticExporter._navigation):
	Use `concat' for string operations.
	(HtmlExporter.page): Translate the result.
	(HtmlStaticExporter): Don't derive from `FileExporter'.
	(HtmlStaticExporter._navigation.link): Make difference between
	None and an empty string for the `label' argument.

	* lib/lcg/export/export.py (Exporter.__init__): New argument
	`lang'.  Initialize the translations instance.
	(FileExporter.export): Class removed.
	(MarkupFormatter._markup_handler): Translate the `_formatter' output.

	* lib/lcg/export/_html.py: Import everything from `lcg'.
	(_attr): Convert integets to string explicitely.  Use `concat'
	instead of string formatting and joining.
	(_tag): Use `concat' instead of string formatting and joining.
	Argument concat replaced by a boolean flag `newlines'.
	(h): Use `concat' instead of string formatting.
	(strong): Use `concat' instead of string formatting.
	(pre): New function.
	(p, div, form, fieldset, select): 'concat' -> `newlines'.
	(br): Use `concat' instead of string formatting.
	(hr): New function.
	(list): Use `concat' instead of string addition and joining..
	(_input): Use `concat' instead of string formatting.
	(script): Use `concat' instead of string addition.
	(script_write): Use `concat' instead of string addition.
	(js_value): Use a special rule for `TranslatableText' and
	`Concatenation' instances.
	(js_array): Use `concat' instead of string addition.
	(js_dict): Use `concat' instead of string addition.

	* lib/lcg/content/content.py (HorizontalSeparator.export): Use
	`_html.hr'.
	(TextContent._TEXT_TYPE, WikiText._TEXT_TYPE)
	(PreformattedText._TEXT_TYPE): New constants.
	(TextContent.__init__): Use _TEXT_TYPE for the assertion.
	(TextContent.__str__): Convert text to str first.
	(PreformattedText.export): Use `_html.pre'.
	(Link._descr): Use 'concat' instead of string formatting.
	(Container.export): Use 'concat' instead of string join.
	(Section.__init__): Assert to `STRINGTYPES' instead of
	`types.StringTypes'.
	(Section.title): Don't substitute the number here.
	(Section.export): Use 'concat' instead of string join.
	(Table.__init__): Assert to `STRINGTYPES' instead of
	`types.StringTypes'.
	(TableOfNodes._make_toc): Use 'concat' instead of string addition.
	(VocabList.export): Use 'format' instead of string formatting.  Use
	'concat' instead of string join.
	(VocabSection.__init__): Assert to `STRINGTYPES' instead of
	`types.StringTypes'.

	* lib/lcg/wiki.py (MacroParser._substitution): Log message fixed.
	(Parser.parse): Assertion added.

	* lib/lcg/_test.py (TranslatableText): New test case.
	(HtmlExporter): New test case.

	* lib/lcg/__init__.py: Don't initialize gettext here.  Import the
	new `i18n' module.

	* lib/lcg/resources.py: Import` `config'.

	* lib/lcg/util.py (caller): New function.

	* lib/lcg/nodes.py (WikiNodeMixin.parse_wiki_text): New argument
	`subst'.  Pass it to the macro parser without trying to supply the
	supstitution provider here.

2006-07-25  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content/exercises.py (Exercise.__init__)
	(Exercise._play_button, Exercise._play_button)
	(Exercise._sound_controls, Exercise.export)
	(Exercise._export_tasks, _InteractiveExercise._init_script)
	(_ChoiceBasedExercise._non_js_choice_control)
	(Dictation._init_script): a
	(_InteractiveExercise._answer_sheet_url): Renamed to
	`_answer_sheet_uri'.  New argument `exporter'.
	(_InteractiveExercise._answer_sheet_link): New argument
	`exporter'.
	(Exercise._results, _InteractiveExercise._results): New argument
	exporter.
	(_InteractiveExercise._results): `_answer_sheet_url()' ->
	`_answer_sheet_uri()'.
	(Exercise._export_task): Pass `exporter' to
	`_answer_sheet_link()'.
	(_FillInExercise._make_field): New argument `exporter'.
	(Cloze._make_field): Pass `exporter' to `_answer_sheet_link()'.
	(_Cloze._export_task_parts): Pass `exporter' to `_make_field()'.

	* lib/lcg/export/ims.py (_Manifest.__init__): New argument `exporter'.
	(_Manifest._create_item): Use the exporter to resolve URIs.
	(IMSExporter): Derive from `HtmlExporter'.
	(IMSExporter.export): Pass `self' to `_Manifest' constructor.

	* lib/lcg/export/hhp.py (_MetaFile.__init__, _Header.__init__):
	New arguemnt `exporter'.
	(_Contents._item): Use the exporter to resolve URIs.
	(HhpExporter): Derive from `HtmlExporter'.
	(HhpExporter.export): Pass `self' to `_Index', `_Contents' and
	`_Header' constructors.

	* lib/lcg/export/html.py (HtmlMarkupFormatter._link_formatter):
	New method /moved here from `MarkupFormatter'.
	(HtmlExporter._BODY_PARTS: New constant.
	(HtmlExporter.__init__): Pass `self' to the `HtmlMarkupFormatter'
	constructor.
	(HtmlExporter._output_file): New optional argument `lang'.  
	(HtmlExporter._url): Method removed.
	(HtmlExporter._node_uri): New method.
	(HtmlExporter.uri): New method.
	(HtmlExporter._head): Added the `Content-Style-Type' meta tag.
	(HtmlExporter._styles, HtmlExporter._head)
	(HtmlExporter.page, HtmlStaticExporter._head): `url' -> `uri'.
	(HtmlExporter._body_parts): Iterate through `self._BODY_PARTS' and
	wrap them into a div automatically.
	(HtmlExporter._heading, HtmlExporter._language_selection) 
	(HtmlExporter._content): New methods.
	(HtmlStaticExporter._BODY_PARTS): New constant.
	(HtmlStaticExporter._body_parts): Method removed.
	(HtmlStaticExporter._link): Method removed.
	(HtmlStaticExporter._rule): New method.
	(HtmlStaticExporter._navigation.link): New function.
	(HtmlStaticExporter._navigation): Use it.

	* lib/lcg/export/export.py (MarkupFormatter.__init__): New
	argument `exporter'.
	(MarkupFormatter._link_formatter): Method removed.

	* lib/lcg/content/content.py: Docstring updated.
	(Content): Docstring updated.
	(Link.ExternalTarget.__init__): Argument `url' renamed to `uri'.
	(Link.ExternalTarget.url): Renamed to `uri'.
	(Link.export): Use exporter's `uri()' method instead of target
	`url' directly.
	(Section.url): Method removed.
	(TableOfNodes.export): Pass `exporter' to `_make_toc()'.
	(TableOfNodes._make_toc): Accept the `exporter' as argument.  Use
	exporter's `uri()' method instead of target `url' directly.
	(VocabItem.__init__): New argument `media'.  Argument `parent'
	removed.  Don't allocate the `Media' resource here.
	(VocabList.__init__): Argument `parent' removed.  Don't allocate
	the `Script' resource here.
	(VocabSection.__init__): Argument `parent' removed.  Don't pass it
	to `VocabList' constructor.
	(LanguageSelection): Class removed.

	* lib/lcg/eurochance.py (EurochanceNode): Derive from
	`ContentNode' and `FileNodeMixin'.
	(EurochanceNode._title): Method removed.
	(EurochanceNode._create_content): New method.
	(Unit._brief_title): -> `_brief_title_'.
	(Unit._title, ExerciseHelp._title_, AnswerSheet._title_)
	(EurochanceCourse._title_): -> `_title_'.
	(IntermediateUnit._create_exercises): Don't pass `parent' to
	`VocabSection'.
	(VocabIndex._create_content): Don't pass `parent' to
	`VocabIndexSection'.
	(EurochanceCourse.version): Add a timestamp to the output..
	(EurochanceExporter._BODY_PARTS): New constant.
	(EurochanceExporter._version, EurochanceExporter._copyright): New methods.
	(EurochanceExporter._body): Method removed.

	* lib/lcg/nodes.py (ContentNode): Docstring updated.
	(ContentNode._INHERITED_ARGS): New constant.
	(ContentNode.__init__): New arguments `title', `brief_title',
	`descr' and `content'.  Removed argument `input_encoding'.
	(ContentNode._title, ContentNode._brief_title, ContentNode._descr)
	(ContentNode._create_content): Methods removed.
	(ContentNode._create_child): Use `_INHERITED_ARGS'.
	(ContentNode._input_file, ContentNode._read_file)
	(ContentNode.input_encoding, ContentNode.counter)
	(ContentNode.url, ContentNode.output_file)
	(ContentNode.parse_wiki_text, ContentNode.parse_wiki_file):
	Methods removed.
	(ContentNode.resources): Just return the result of the new
	`resources()' function.
	(WikiNodeMixin, FileNodeMixin): New classes.
	(RootNode): Class removed.
	(_WikiNode): Class removed.
	(WikiNode): Derive from `ContentNode' and `WikiNodeMixin'.
	(WikiNode._source_text, WikiNode._create_content)
	(WikiNode._title): Methods removed.
	(WikiNode._INHERITED_ARGS): New constant.
	(WikiNode.__init__): Just pass the right arguments to the parent
	constructor.
	(DocNode): Derive from `ContentNode' and `FileNodeMixin'.
	(DocNode.__init__): Just pass the right arguments to the parent
	constructor.
	(DocNode._source_text): Method removed.

	* lib/lcg/_test.py (ContentNode.check_misc): Don't use the
	`subdir' constructor argument.  Pass the `content' as constructor
	argument.  Don't test file-related input methods.
	(ContentNode.check_media): Temporarily commented out.

	* lib/lcg/feed.py (VocabFeeder.feed): Allocate the `audio.js'
	script from here.
	(VocabFeeder.feed): Pass a counter to `self._process_pieces()'.
	(VocabFeeder._item): Accept a counter as an argument.  Use it
	to create the resource filename.  Allocate the `Media' resource
	here and pass it to `VocabItem' constructor.

	* lib/lcg/resources.py (_resources_by_parent): New variable.
	(_resource): New function.
	(resource): Use it.
	(resources): New function.
	(Resource.url): Renamed to `uri'.

	* lib/lcg/export/_html.py (link): Argument `url' renamed to `uri'.
	(speaking_text): `url' -> `uri'.

	* lib/lcg/export/__init__.py: Don't resolve cyclic dependencies
	here.

	* lib/lcg/content/__init__.py: Don't resolve cyclic dependencies
	here.

	* lib/lcg/__init__.py: Resolve namespace dependencies of all files
	here.  Import `_html' from `export'.

2006-07-20  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/eurochance.py (EurochanceNode._localized_wiki_content)
	(Unit._create_exercises, Unit._create_content)
	(ExerciseHelp._create_content, VocabIndex._create_content)
	(AnswerSheets._create_content, AnswerSheet._answer_sheets)
	(AnswerSheet._create_content, Help._create_content)
	(EurochanceCourse._create_content, EurochanceExporter._body):
	Don't pass the `parent' argument to the constructors of generated
	content elements.
	(CourseIndex): Class removed.
	(_Section): `wiki.Parser._Section' -> `Parser._Section'.

	* lib/lcg/export/ims.py (IMSExporter._body_parts): Pass `self' to
	the `export' method.

	* lib/lcg/export/html.py (HtmlMarkupFormatter._citation_formatter)
	(HtmlMarkupFormatter._uri_formatter)
	(HtmlMarkupFormatter._email_formatter): Accept also all the
	remaining arguments as **kwargs.
	(HtmlMarkupFormatter._email_formatter)
	(HtmlMarkupFormatter._uri_formatter): Pass `parent' to
	`_link_formatter'.
	(HtmlMarkupFormatter._citation_formatter): Use the `parent'
	arguemnt instead of `self._parent'.
	(HtmlExporter._export_section, HtmlExporter._body_parts): Pass
	`self' to the `export' method.
	(HtmlExporter.format_wiki_text): New method.
	(HtmlExporter.page): Cosmetic change.

	* lib/lcg/export/hhp.py (HhpExporter.__init__):
	`lcg.wiki.Formatter' -> `lcg.HtmlMarkupFormatter'

	* lib/lcg/export/export.py (MarkupFormatter): Docstring updated.
	(MarkupFormatter._HELPER_PATTERNS): Added `resource_cls'.
	(MarkupFormatter._link_formatter): Accept also all the remaining
	arguments as kwargs.
	(MarkupFormatter._link_formatter): Set the parent of the generated
	`Link'.  Pass the exporter argument to its `export' method.
	(MarkupFormatter.format): Pass an empty dict to `_formatter'.

	* lib/lcg/content/exercises.py (Exercise.__init__): Don't pass
	`parent' to parent class constructor.  Call
	`self.set_parent(parent)' instead.
	(Exercise.__init__): Pass `parent
	(Exercise._wiki_content): Set the parent of the generated
	`Container' explicitely.  Don't pass the `parent' to its
	constructor.
	(Exercise._init_resources, _InteractiveExercise._init_resources):
	Use `self.parent()' instead of `self._parent'.
	(Exercise.export): Accept the `exporter' argument.  Pass it to the
	`_export_*' methods.
	(Exercise._export_tasks, Exercise._export_explanation)
	(Exercise._export_example, Exercise._export_reading)
	(Exercise._export_instructions, Exercise._export_recording)
	(Exercise._export_audio_version, Exercise._export_task)
	(_ChoiceBasedExercise._export_task_parts)
	(GapFilling._export_task_parts)
	(_FillInExercise._export_task_parts)
	(Dictation._export_task_parts, _Cloze._export_task_parts)
	(_ExposedCloze._export_instructions, Cloze._export_task_parts):
	Accept the `exporter' argument.
	(Exercise._export_tasks, Exercise._export_explanation)
	(Exercise._export_example, Exercise._export_reading)
	(Exercise._export_instructions, Cloze._export_task_parts): Pass
	the `exporter' argument to subsequent `export()' calls.
	(_InteractiveExercise.answer_sheet): Don't pass the `parent'
	argument to the constructors of generated content elements.

	(_ChoiceBasedExercise._export_task_parts)
	(GapFilling._export_task_parts)
	(_FillInExercise._export_task_parts)
	(_FillInExercise._export_task_parts, _Cloze._export_task_parts):
	Use the `format_wiki_text' method of the exporter, not the parent.

	* lib/lcg/content/content.py (Content): Docstring updated.
	(Content.__init__, TextContent.__init__, Link.__init__)
	(Anchor.__init__, InlineImage.__init__, Container.__init__)
	(ItemizedList.__init__, Definition.__init__, Table.__init__)
	(Field.__init__, SectionContainer.__init__, Section.__init__)
	(TableOfContents.__init__, VocabList.__init__): Argument `parent'
	omitted.  Don't pass it to parent constructor.
	(VocabList.__init__): Docstring updated.
	(Content.set_parent): New method.
	(Content.parent): Return containter's parent if my parent was not
	set.
	(Content.lang): Don't fallback to parent's language.
	(HorizontalSeparator.export, HorizontalSeparator.export)
	(TextContent.export, WikiText.export, PreformattedText.export)
	(Link.export, Anchor.export, InlineImage.export)
	(Container.export, ItemizedList.export, Definition.export)
	(Field.export, Section.export, TableOfNodes.export)
	(VocabList.export, LanguageSelection.export): Take the `exporter'
	argument.
	(WikiText.export): Use the `format_wiki_text' method of the
	exporter, not the parent.
	(Container._exported_content): Take the `exporter' argument.
	(Container._exported_content, Definition.export, Field.export)
	(SectionContainer._exported_content, Section.export): Pass the
	`exporter' argument to subcontent `export' methods.
	(SectionContainer.__init__): Set the container of the
	automatically generated `TableOfContents' to self explicitely.
	(Section.backref, Section.url): Use `self.parent()' instead of
	`self._parent'.
	(TableOfNodes): New class.
	(TableOfContents): Derive from `TableOfNodes'.  The 'item'
	argument renamed to 'start'.
	(TableOfContents._start_item): New method.
	(TableOfNodes._export_title, TableOfNodes.export)
	(TableOfNodes._make_toc): Moved to the parent class.
	(TableOfNodes._make_toc): Use `self.parent()' instead of
	`self._parent'.
	(VocabSection.__init__, LanguageSelection.__init__): Don't pass
	the `parent' arguent to the generated content elements.
	(LanguageSelection.export): Comment out the radio button
	implementation.

	* lib/lcg/wiki.py (Formatter): Class removed / moved to the export
	module.
	(Parser): Docstring imporoved.
	(Parser.__init__): Argument `parent' omitted.
	(Parser._make_sections, Parser._parse_section_content)
	(Parser._store_list_item)
	(Parser._finish_list_item._Context.make_list)
	(Parser._store_field, Parser._finish_field)
	(Parser._store_definition, Parser._finish_definition)
	(Parser._make_paragraph, Parser._make_table, Parser._make_toc)
	(Parser._make_rule): Don't pass the `parent' argument to the
	created `Content' elements'
	(Parser._make_toc): Create either `TableOfNodes'
	or`TableOfContents'.

	* lib/lcg/nodes.py (ContentNode.__init__): Don't create
	`self._wiki_formatter'.  `self._wiki_parser' -> `self._parser'.
	(ContentNode.__init__): Don't pass the `parent' argument to the
	constructor of generated `SectionContainer'.  Set the parent of
	the created content.
	(ContentNode._create_child): Only set the arguments, which are not
	already present in `kwargs'.
	(format_wiki_text): Method removed.
	(ContentNode.parse_wiki_text): `wiki.MacroParser' ->
	`MacroParser'.  `self._wiki_parser' -> `self._parser'.
	(_WikiNode._create_content): Don't pass the `parent' argument to
	the constructor of generated `SectionContainer'.

	* lib/lcg/_test.py (ContentNode.check_misc)
	(ContentNode.check_media): Pass the `id' to the `ContentNode'
	constructor.
	(ContentNode.check_media): Don't expect an exception.
	(Parser): New class.

	* lib/lcg/__init__.py: Import all from the `wiki' module.

2006-07-12  Tomas Cerha  <cerha@brailcom.org>

	* bin/wiki-formatter.py (main): `Exporter' -> `HtmlExporter'.
	Print page to STDOUT if name not given.

	* bin/lcgmake.py: `StaticExporter' -> `HtmlStaticExporter'.

	* lib/lcg/export/html.py: New file.

	* lib/lcg/export/__init__.py: Import also from the new `html' module.

	* lib/lcg/__init__.py: Import order changed.

	* lib/lcg/export/export.py (Exporter): All HTML-specific
	functionality moved to the `HtmlExporter' in the new `html'
	module.
	(FileExporter): New class.
	(MarkupFormatter): New class.

	* lib/lcg/content/content.py (LanguageSelection.__init__):
	Arguments `language' and `variants' removed.  Set them according
	to parent.

	* lib/lcg/eurochance.py (EurochanceNode.current_language_variant):
	New method.
	(output_file): Method removed.
	(EurochanceCourse.__init__): Pass `language_variants' to the
	parent constructor.
	(EurochanceCourse._create_content): Nont add the `LanguageSelection'.
	(EurochanceExporter): `StaticExporter' -> `HtmlStaticExporter'.
	(EurochanceExporter.body): Renamed to `_body'.

	* lib/lcg/nodes.py (ContentNode.__init__): Automatically add the
	current language to `language_variants' if it's not already there.
	Docstring updated.
	(ContentNode.language_variants): Docstring added.
	(ContentNode.current_language_variant): New method.
	(ContentNode.output_file): Cache the name in a privat attribute.
	(ContentNode.src_dir): Cache the dir in a privat attribute.
	(DocNode.__init__): Don't pass `language_variants' to the parent
	constructor, but rewrite `self._language_variants' afterwards,
	when the `_input_file' method works.

2006-07-11  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/eurochance.py (Unit.output_file): Method removed.
	(EurochanceExporter): Derive from `HtmlStaticExporter'.
	(EurochanceExporter.body): Renamed to `_body'.

	* lib/lcg/nodes.py (ContentNode.__init__): New argument
	`language_variants'.  The default value of `language' set to None.
	(ContentNode.language_variants): New method.
	(ContentNode.output_file): Append the language if more language
	variants are present.
	(DocNode.__init__): Make a list of available language_variants and
	pass it to parent constructor.
	(DocNode.language_variants): Method removed.
	(DocNode.output_file): Method removed.
	(DocRoot._create_content): Method removed.

2006-06-19  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export/ims.py (Module): File moved.

	* lib/lcg/export/hhp.py (Module): File moved.

	* lib/lcg/export/export.py (Module): File moved.

	* lib/lcg/export/_html.py (Module): File moved.

	* lib/lcg/export/__init__.py (Module): New file.

	* lib/lcg/content/exercises.py (Module): File moved.

	* lib/lcg/content/content.py (Module): File moved.

	* lib/lcg/content/__init__.py (Module): New file.

	* lib/lcg/__init__.py (Module): Respect the new package
	organization.

	* lib/lcg/eurochance.py (Module): Respect the new package
	organization.

	* lib/lcg/content.py (Message): Moved to the `content' submodule.

	* lib/lcg/exercises.py (Module): Moved to the `content' submodule.

	* lib/lcg/_html.py (Module): Moved to the `export' submodule.

	* lib/lcg/export.py (Module): Moved to the `export' submodule.

	* lib/lcg/hhp.py (Module): Moved to the `export' submodule.
	
	* lib/lcg/ims.py (Module): Moved to the `export' submodule.

2006-05-23  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/hhp.py (HhpExporter.__init__): Refer to the `Formatter'
	as `lcg.wiki.Formatter'.

2006-05-22  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py (__version__): Changed to '0.3.1'.

	* bin/lcgmake.py: New command line option `secondary-language'.
	(main): Pass `secondary-language' to the constructor.

	* resources/images/flags/cs.gif: New file.

	* resources/images/flags/de.gif: New file.

	* resources/images/flags/en.gif: New file.

	* resources/images/flags/es.gif: New file.
	
	* resources/images/flags/no.gif: New file.

	* resources/images/flags/sk.gif: New file.
	
	* lib/lcg/eurochance.py (EurochanceNode.output_file): New method.
	(VocabIndex._create_content): Ignore duplicate items.
	(EurochanceCourse.__init__): Pass `secondary_language' to parent
	class constructor.
	(EurochanceCourse._create_content): Add a language selection to
	the beginning of content for intermediate courses.
	(EurochanceExporter.body): Translate the "Version" label.
	(Formatter): Class removed.

	* lib/lcg/_html.py (_attr): Recognize boolean attributes.
	(form): New argument `cls'.
	(fieldset): New function.
	(_input): New argument `checked'.  Added assertions on `checked'
	and `readonly'.  Pass them both to `_attr'.
	(select): New argument `selected'.

	* lib/lcg/content.py (WikiText): Docstring improved.
	(Link.ExternalTarget): New class.
	(Link.__init__): Allow also `ExternalTarget' instance as `target'.
	(Link.descr): Method removed.
	(Link.label): Method removed.
	(Link._descr): New method.
	(Link.export): Use `self._descr()' and don't use `self.label()'
	and `self.descr()'.
	(InlineImage): New class.
	(Container._CONTENT_SEPARATOR): New constant.
	(Container._export_content): Method removed. 
	(Container._exported_content): New method. 
	(Container.export): Concatenate the `' result using the
	`self._CONTENT_SEPARATOR'.
	(Table._CONTENT_SEPARATOR): New constant.
	(Table._export_content): Replaced by `exported_content'.
	(SectionContainer._export_content): Replaced by `exported_content'.
	(LanguageSelection): New class.

	* lib/lcg/export.py (Exporter.page): Added a nasty hack to include
	MS Media Player object in the page, when the 'audio.js' script is
	being used.
	(StaticExporter._body_parts): Include the navigation only when
	there are multiple pages.

	* lib/lcg/nodes.py (ContentNode.__init__): New keyword argument
	`secondary_language'.
	(ContentNode._create_child): Pass also the `secondary_language'.
	(ContentNode.secondary_language): New method.
	(DocNode.language_variants): New method.
	(DocNode.output_file): New method.
	(DocChapter._create_children): Ignore the 'resources' directory.
	(DocRoot._create_content): Prepend the language selection before
	the actual content, when multiple language versions exist.

	* lib/lcg/resources.py (Image.__init__): Read the file and
	remember the image width and height.
	(Image.title, Image.width, Image.height): New methods.
	(Transcript.__init__, Transcript.__init__): Accept and pass the
	keyword arguments not used here as `**kwargs'.
	(Transcript._export): Add a unicode mark to the begining of the
	output file.  Export with CRLF, not just LF.

	* lib/lcg/util.py (_LANGUAGE_NAMES): New constant.
	(language_name): New function.

	* lib/lcg/wiki.py (Formatter._link_formatter): Use a `Link'
	instance instead of directly rendering the html tag.
	(Formatter._citation_formatter): New method.

	* resources/css/default.css: New styles for language selection.

	* resources/scripts/audio.js (detect): New function.
	(windows_media_player_available): New variable.
	(play_audio, stop_audio): Use it.
	
	* translations/sk.po: New file.

	* translations/no.po: New file.

	* translations/es.po: New file.

	* translations/de.po: Updated.

	* translations/cs.po: Updated.

2006-04-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/wiki.py (Formatter._MARKUP): Allow the Resource
	specification in the link format.
	(Formatter._FORMAT): Don't use old visual HTML formatting tags.
	Use stylesheets instead.
	(Formatter._link_formatter): Added support for included resources.

	* lib/lcg/hhp.py (HhpExporter.__init__): Change the unlerline
	format in `lcg.Formatter'.

	* lib/lcg/eurochance.py (EurochanceNode.meta): `Lawton Idiomas'
	replaced by `Lawton School S.L.'.
	(CopyrightInfo): New class.
	(EurochanceCourse.version): New method.
	(EurochanceCourse._create_children): Create also the
	`CopyrightInfo' node.
	(EurochanceExporter.body): New method.

	* lib/lcg/export.py (Exporter.head): Added `Content-Script-Type'
	meta tag.
	(Exporter.page): Set the `lang' attribute of the `body' element.

	* lib/lcg/content.py (Link.export): Remove any HTML tags from the
	description text.

	* lib/lcg/_html.py (script): Don't output JS comment start before
	sgml comment start.

	* doc/intro.en.txt: Minor improvements.

	* translations/de.po: Updated.

	* translations/cs.po: Updated.

	* translations/help.sk.txt: Added table of contents.

	* translations/help.no.txt: Added table of contents.

	* translations/help.es.txt: Added table of contents.

	* translations/help.en.txt: Added table of contents.

	* translations/help.de.txt: Added table of contents.

	* translations/help.cs.txt: Added table of contents.

	* resources/css/default.css: Reorganized, updated.

2006-03-27  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content.py (Section.anchor): Use dots instead of dashes.
	(VocabList.export): Supply `summary' and `title' attributes.

	* lib/lcg/_html.py (_input): Removed unused arguments `onkeydown'
	and `onfocus'.
	(speaking_text): Don't prefix the handler with "javascript:".

	* lib/lcg/exercises.py (Task.id): Method removed.
	(Exercise._exercise_id): New method.
	(Exercise._form_name): Use it.
	(Exercise._play_button): Cosmetic changes.
	(Exercise._task_name): New method.
	(_SelectBasedExercise._format_choices): Use `self._task_name()'.
	(GapFilling._export_task_parts): Escape the gap to prevent it from
	being formatted as a markup.
	(_FillInExercise._make_field): Accept just two positional
	arguments: `task' and `text'.  Use `self._task_name()'.  Don't
	create the counter here.
	(_FillInExercise._export_task_parts): Use self._task_name(task) as
	label id.  Pass the right arguments to
	`_FillInExercise._make_field'.
	(Cloze._make_field): Don't use the superclass method.  Create the
	field here.  Use a counter here create a field name and
	answer-sheet link.
	(MixedTextFillInTask.text.make_field): Pass just `task' and `text'
	to the `field_maker'.
	(_FillInExercise._export_task_parts): Use `self._task_name()'
	instead of `task.id()'.

	* resources/scripts/exercises.js (Handler.evaluate): Use the first
	attempt percentage, not the current percentage.
	(FillInExerciseHandler._handle_dlbclick): New method.
	(FillInExerciseHandler._init_field): Use it to handle double click
	on input fields.

	* resources/css/default.css: Syntax fixed.

2006-03-16  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/resources.py: Docstrings improved.

	* lib/lcg/wiki.py (Formatter._link_formatter): Improved
	recognition of external links.

2006-03-15  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/exercises.py: Don't import `unicodedata' here.
	(FillInTask.text): Method removed.
	(MixedTextFillInTask.text): Argument names changed.  Formatter
	always required. Don't use `_field_formatter()'
	(MixedTextFillInTask.is_mixed): New method.
	(ClozeTask._field_formatter)
	(MixedTextFillInTask._field_formatter): Method removed.
	(Exercise._TASK_SEPARATOR): Constant removed.
	(Exercise._ANSWER_SHEET_LINK_PER_TASK): New constant.
	(Exercise._wiki_content): New argument `escape'.  Only escape
	square brackets when True.
	(Exercise.__init__): Set `escape' to True just for `example'.
	(Exercise._play_button): New method.
	(Exercise._sound_controls): Use it.  Simplified.
	(Exercise._task_style_cls): New method.
	(Exercise._export_task): Use it.  Automatically append answer
	sheet link.
	(_InteractiveExercise._ANSWER_SHEET_LINK_CLASS): Constant removed.
	(Cloze._ANSWER_SHEET_LINK_CLASS, Cloze._TASK_SEPARATOR): Constants
	removed.
	(Cloze._ANSWER_SHEET_LINK_PER_TASK) New constant.
	(_InteractiveExercise._answer_sheet_link): Surround the link with
	hidden brackets.  Don't use `self._ANSWER_SHEET_LINK_CLASS'.
	(_ChoiceBasedExercise._task_style_cls): New method.
	(_ChoiceBasedExercise._export_task_parts): Don't add the
	answer-sheet link here.
	(_FillInExercise._check_tasks): Assertion extended.
	(_FillInExercise._make_field): Increment the counter forst and
	than use the its `current()' method.  Use `self._play_button()'.
	(_FillInExercise._export_task_parts): Decide which presentation is
	appropriate according to the task type and other properties.
	(Dictation._init_script): Don't escape the square brackets within
	the text.
	(Cloze._make_field): New method.
	(Cloze._export_task_parts): Identifier changed.
	(VocabExercise): Derive also from `_NumberedTasksExercise'.

	* lib/lcg/nodes.py (ContentNode.counter): Initialize the counter
	with a zero, not one.

	* lib/lcg/wiki.py (Formatter._link_formatter): Report the parent
	node id, when reporting an unknown node or section.

	* lib/lcg/util.py (Counter.current): New method.
	(Counter.next): Return the incremented value, not the one before
	increment.

2006-03-02  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py (__version__): 0.3.0.

	* lib/lcg/wiki.py (Formatter._link_formatter): If possible, use
	`Link' and it's `export' method to format the link.

	* lib/lcg/nodes.py (ContentNode._TITLE,
	ContentNode._ABBREV_TITLE): Constants removed.
	(ContentNode.__init__): Initiate the attributes `self._title_',
	`self._brief_title_' and `self._descr_'.
	(ContentNode.__str__): Use just the id and class name.
	(ContentNode._brief_title, ContentNode._descr): New methods.
	(ContentNode._title): Return None in this class.
	(ContentNode._abbrev_title): Removed.
	(ContentNode.title): Argument `abbrev' renamed to `brief'.  Return 
	(ContentNode.descr): New method.

	* lib/lcg/export.py (StaticExporter._link): `abbrev' -> `brief'.

	* lib/lcg/eurochance.py (EurochanceNode._title): New method.
	(Unit._abbrev_title): Renamed to `_brief_title'.
	(Unit._title): Don't take the argument `abbrev'.
	(ExerciseHelp.title): Replaced by `_title'.
	(AnswerSheet._title): `abbrev' -> `brief'.

	* lib/lcg/content.py (Link.target, Link.label, Link.descr): New methods.
	(Link.export): Use them.
	(Anchor.anchor): New method.

2006-02-27  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py (__version__): Changed to 0.3.

	* lib/lcg/export.py (Exporter.head): Add `generator' to the meta
	tags.  Use meta data of the current node, not the root node.
	Expect a tuple from `node.meta()'.

	* lib/lcg/nodes.py (ContentNode.meta): Return a tuple, not a dictionary.

	* lib/lcg/eurochance.py (EurochanceNode.meta): New method.
	(meta): Method removed.
	(EurochanceCourse._unit_dirs): Sort the names alphabetically.

2006-02-21  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/nodes.py (DocRoot): Docstring updated.

	* doc/usage/generic-interface.en.txt: Finished.

2006-02-20  Tomas Cerha  <cerha@brailcom.org>

	* doc/usage/_index.txt: New file.

	* doc/usage/usage.en.txt: New file.

	* doc/usage/generic-interface.en.txt: New file.

	* doc/usage/custom-interface.en.txt: New file.

	* doc/eurochance/eurochance.en.txt: New file.

	* doc/eurochance/_index.txt: New file.

	* doc/eurochance/course-structure.en.txt: New file.

	* doc/eurochance/eurochance-data.en.txt: New file.

	* doc/eurochance/eurochance-translations.en.txt: New file.

	* doc/eurochance/eurochance-recordings.en.txt: New file.

	* doc/data-formats/data-formats.en.txt: New file.

	* doc/data-formats/_index.txt: New file.

	* doc/data-formats/plain-text.en.txt: New file.

	* doc/data-formats/structured-text.en.txt: New file.

	* doc/data-formats/formatting.en.txt: New file.

	* doc/data-formats/exercises.en.txt: New file.

	* doc/data-formats/vocabulary.en.txt: New file.

	* doc/intro.en.txt: Updated.

	* doc/index.en.txt: Updated.

	* doc/_index.txt: Updated.

	* doc/formatting.en.txt: File moved to the `data-formats'
	directory.

	* lib/lcg/nodes.py (ContentNode.__init__): New keyword argument
	`hidden'.
	(ContentNode.hidden): New method.
	(DocChapter,_list_dir): New method.
	(DocChapter._create_children): Use `self._list_dir()' and
	recognize hidden nodes.
	(DocRoot): Docstring updated.

	* lib/lcg/util.py (list_dir): Function removed.

	* lib/lcg/eurochance.py (EurochanceCourse.__init__): Pass language
	as a keyword argument to the parent's method.
	(EurochanceCourse._unit_dirs): Use `os.listdir()' insteadd of the
	list_dir function.

	* lib/lcg/content.py (TableOfContents._make_toc): Omit hidden
	nodes from the table of contents.

	* doc/eurochance.en.txt: File removed.  Contents split into
	smaller files in the `eurochance' directory.

	* doc/data-formats.en.txt: File removed.  Contents split into
	smaller files in the `data-formats' directory.

2006-02-17  Tomas Cerha  <cerha@brailcom.org>

	* doc/intro.en.txt: Updated.

	* bin/generate.py (OPTIONS): Removed command line arguments
	`user-lang' and `advanced'.  They are now deduced from just `lang'.
	(main): Always create the `EurochanceCourse', don't distinguish
	the level here.  Respect the changed `lang' specification format.

	* lib/lcg/eurochance.py (_user_lang): Method removed.
	(EurochanceNode._localized_wiki_content)
	(IntermediateUnit._create_vocab, Help._create_children)
	(ExerciseHelp._create_content): Use `self.root().users_language()'
	instead of `self._user_lang()'.
	(ExerciseHelp.__init__): New argument `id'.  Don't create it here.
	(Help._create_children): Pass `id' to `ExerciseHelp' constructor.
	(EurochanceCourse.__init__): When the languege comnsists of a pair
	of language codes sparated with a hyphen, use the later language
	code as `self._users_language' and consider the course an
	intermediate course.
	(AdvancedCourse, IntermediateCourse): Classes removed.
	(EurochanceCourse._create_children): New method.
	(EurochanceCourse.users_language): New method.

	* lib/lcg/ims.py: Import codecs.
	(_Manifest.write): Open the file using an 'utf-8' codec.
	(_Manifest.__init__): Typo fixed.

	* resources/css/default.css: Added styles for table and fieldset captions.

	* lib/lcg/exercises.py (MixedTextFillInTask._field_formatter): New method.
	(MixedTextFillInTask.text): Use it.
	(TransformationTask._field_formatter): New method.

2006-02-16  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content.py (Link.__init__): Allow also `ContentNode' as
	the link target.

	* lib/lcg/nodes.py (ContentNode._node_path): New optional argument
	`relative_to'.
	(ContentNode.full_title): Method removed again...

	* lib/lcg/hhp.py (HhpExporter.__init__): Refer to
	`HorizontalSeparator' by its full name.

2006-02-15  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/nodes.py (DocChapter._create_children): Whenever a
	python file exists, use it with preference to a plain text file.
	(DocChapter._create_children): Don't test the existence of the
	input file.  Just create a node and rely on it's constructor to
	complain.

	* lib/lcg/hhp.py (HhpExporter.__init__): Added a two more simple
	hacks.

	* lib/lcg/content.py (Content_ALLOWED_CONTAINER)
	(Container._ALLOWED_CONTENT, Container._ATTR): New constants.
	(Content.set_container): Make assertions using
	`_ALLOWED_CONTAINER'.
	(Container.__init__): Make assertions using `_ALLOWED_CONTENT'.
	(Container.export): Add also attributes from `self._ATTR'.
	(DefinitionList._ALLOWED_CONTENT, TableRow._ALLOWED_CONTENT)
	(Table._ALLOWED_CONTENT, FieldSet._ALLOWED_CONTENT)
	(Definition._ALLOWED_CONTAINER, TableCell._ALLOWED_CONTAINER)
	(TableRow._ALLOWED_CONTAINER, Field._ALLOWED_CONTAINER): New constants.
	(TableRow.__init__, FieldSet.__init__, DefinitionList.__init__):
	Methods removed.
	(Table.__init__): New keyword argument `title'.
	(FieldSet): Inherit from `Table'.
	(FieldSet._TAG): Constant removed.
	(Section.section_number): Convert the sections to a list..

2006-02-09  Tomas Cerha  <cerha@brailcom.org>

	* bin/generate.py (OPTIONS): Set the default stylesheet to
	`default'css'.

	* bin/lcgmake.py (main): Pass the filename as `id', not `file'.

	* lib/lcg/content.py (Container.__init__): Added assertion messages.
	(VocabList.export): Use the `scope' attribure in the html output.

	* lib/lcg/eurochance.py: In all `ConetentNode'
	constructor calls, pass the node id as an argument.

	* lib/lcg/nodes.py (ContentNode): Docstring updated.  Order of
	methods in the source file changed.
	(ContentNode._PARENT_ID_PREFIX): Constant removed.
	(ContentNode.__init__): New argument `id'.  Store it in the
	attribute `_id'.  After creating the whole structure, check for
	duplicate identifiers, when this is a root node.
	(ContentNode._id): Method removed.
	(ContentNode.id): Just return `self._id'.
	(ContentNode.__str__): Encode the title into acsii with `replace'
	on errors.
	(RootNode.__init__): New keyword artument `id'.
	(_WikiNode.__init__): New keyword artument `id'.  Don't care about
	the `subdir' argument.
	(_WikiNode._create_content): Use `self._id' instead of
	`self._id()'.
	(WikiNode.__init__): Pass the `id' and not the `subdir' to parent
	class constructor.
	(DocNode.__init__): New keyword artument `id'.  The `dir' argument
	removed.
	(DocNode.id): Method removed.
	(DocNode._source_text): Use
	`self._id' instead od `self._file'.
	(DocChapter._create_children): Pass `subdir' to child constructors
	as a keyword argument, or not at all.  Always pass `id'.
	(DocRoot.__init__): Keyword argument `file' renamed to `id'.  Pass
	`id' to parent's constructor and `subdir' as a keyword argument.

2006-02-08  Tomas Cerha  <cerha@brailcom.org>

	* doc/data-formats.en.txt: A few updates and additions.

	* lib/lcg/__init__.py: `course' -> `nodes'.

	* doc/_index.txt: Order changed.

	* doc/intro.en.txt: Updated.

	* lib/lcg/nodes.py: Renamed file `course.py'.

	* lib/lcg/course.py (DocChapter._create_children): Added support
	for Python files which can generate subcontent programatically.
	(Module): File renamed to `nodes.py'.

2006-02-07  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/_html.py (label): New argument `cls'.w

2006-02-06  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/export.py (Exporter.head): Use just `title()' instead of
	`full_title()'.

	* lib/lcg/course.py (ContentNode.full_title): Method removed.
	(_WikiNode): Docstring added.
	(_WikiNode.__init__): New argument `title'.
	(_WikiNode._create_content): When title was passed as constructor
	argument, don't extract the title from the top level section.

	* lib/lcg/eurochance.py (EurochanceNode.full_title): 

2006-01-30  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/hhp.py: New module.

	* bin/generate.py: Import `getoptions' and `usage' from `lcgmake'.
	(main): Use getoptions' and `usage' from `lcgmake'.
	(usage): Removed.

	* bin/lcgmake.py (OPTIONS): The default input file extension set
	to `txt'.
	(main): Use `DocRoot' instead of `DocMaker'.

	* doc/_index.txt: New file.

	* doc/index.en.txt: New file.
	
	* doc/intro.en.txt: New file.

	* doc/data-formats.en.txt: New file.

	* doc/eurochance.en.txt: New file.

	* doc/formatting.en.txt: New file.

	* doc/fdl.en.txt: New file.

	* doc/data-formats.wiki: File removed.

	* doc/eurochance.wiki: File removed.

	* doc/formatting.wiki: File removed.

	* doc/intro.wiki: File removed.

	* doc/index.txt: File removed.

	* lib/lcg/util.py (list_dir): New keyword argument `indexfile'.

	* lib/lcg/course.py (_WikiNode.__init__): The argument 'title' removed.
	(_WikiNode._create_content): Always require one top-level
	section.  Initialize `self._document_title'.
	(_WikiNode._title): Return `self._document_title'.
	(DocNode.__init__): New argument `ext'.
	(DocNode._title): Method removed.
	(DocNode._id): Method removed.
	(DocNode.id): New method.
	(DocNode._source_text): Pass also `lang' to `_source_file'.
	(DocMaker): Class removed.
	(DocChapter): New class.
	(DocRoot): New class.

2006-01-26  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/util.py (list_dir): Strip the extensions from filenames
	and return only distinct names.  Ignore comments in index files.

	* bin/docmaker.py: File removed.

	* translations/de.po: Updated.

	* doc/formatting.wiki: Toc syntax extensions documented.

	* lib/lcg/wiki.py (Parser._MATCHERS): Extended syntax for Table of
	Contents.
	(Parser._HELPER_PATTERNS): New items `toctype' and `tocdepth'.
	(Parser._make_toc): Support the new syntax, allowing to specify
	the toc depth and type.  The new type `NTOC' makes the toc of the
	current node (listing it's child nodes), while TOC makes the toc
	of the current content element (eg. current section).

	* lib/lcg/ims.py (IMSExporter.export): Write the meanifest only
	for the root node.
	(IMSExporter._body_parts): New method.

	* lib/lcg/export.py (Exporter._body_parts): New method.
	(Exporter.body): Use it.
	(body): Method removed.
	(StaticExporter._body_parts): New method.

	* lib/lcg/eurochance.py (Help._create_children): When
	`self._user_lang()' is None, use `self.language()'.

	* lib/lcg/_html.py (br): New funftion.

	* lib/lcg/config.py (lcg_dir): Name of the environment variable
	changed to `LCGDIR'.

	* lib/lcg/content.py (TableOfContents._export_title): New method.
	(TableOfContents.export): Use it.

2006-01-23  Tomas Cerha  <cerha@brailcom.org>

	* translations/de.po: Updated.

2006-01-16  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Added styles for numbered tasks.

	* lib/lcg/util.py (positive_id): New function.

	* lib/lcg/resources.py: Import `textwarp'.

	* lib/lcg/_html.py (list): Don't ignore the `cls' argument.

	* lib/lcg/exercises.py: New module - all exercise related classes
	from `contetnt.py'.
	(Exercise._wrap_exported_tasks): New method.
	(Exercise._export_tasks): Use it.
	(_NumberedTasksExercise): New class.
	(_ChoiceBasedExercise, Substitution, Transformation)
	(NumberedCloze): Derive from it.
	(NumberedCloze._export_task_parts): Don't add the numbers
	manually.
	(_InteractiveExercise._results): Mark the result display labels as
	`label's.

	(Exercise._form_name, _ChoiceBasedExercise._js_choice_control)
	(Task.id): Use `positive_id()' instead of `id()'.

	* lib/lcg/__init__.py: Added `exercises'.

	* lib/lcg/content.py: Documentation improved.  Don't import
	`unicodedata', `textwrap' and `random'.   All exercises and tasks
	removed -- moved to the module `exercises.txt'.

	* lib/lcg/course.py: Import `unicodedata'.

2006-01-06  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/eurochance.py (EurochanceNode._localized_wiki_content):
	New argument `macro'.
	(EurochanceNode._localized_wiki_content): New argument `macro'.
	(Unit._exercise_sections): Supply the unit number for the title
	here.
	(Unit._create_content): Create also the `Aims and Objectives' and
	`Checklist' sections.
	(IntermediateUnit._exercise_sections): Supply the `Section %d:'
	prefix to section titles here.
	(Instructions._create_content): Replaced by `_create_exercises'.
	(Instructions._create_exercises): Don't create the `Aims and
	Objectives' and `Checklist' sections here.
	(Instructions._create_content): Expand macros in instructions.
	(ExerciseInstructions._create_content): Don't expand macros here,
	leave it to `parse_wiki_text()'.

	* resources/scripts/audio.js: Don't use Windows Media Player in
	Windows 98.

	* lib/lcg/content.py (Exercise._wiki_content): Report the actual
	type in assertion.
	(WikiText.export): Use parents `format_wiki_text()' method.
	(Task, Choice, _ChoiceTask): Docstring updated.
	(FillInTask.__init__): Also remove '\r' from the answer text.
	(MixedTextFillInTask._fields): Also remove '\r' from the answer
	text.
	(Exercise._READING_INSTRUCTIONS): New constant.
	(Exercise.__init__): Set the default value of
	`reading_instructions' to the above constant.  Pass
	`fallback=False' when creating media instances.
	(_ChoiceBasedExercise._export_task_parts): Format the prompt as a
	wiki text.
	(GapFilling): Derive from `_ChoiceBasedExercise', not
	`_SelectBasedExercise'.
	(GapFilling._export_task_parts): Method removed.
	(_FillInExercise._export_task_parts): Format the prompt as a
	wiki text.
	(Dictation.__init__): Test None as a result of `resource()'.
	(_FillInExercise._export_task_parts): Format the task text as a
	wiki text.

	* lib/lcg/course.py (ContentNode.format_wiki_text): New method.
	(ContentNode.parse_wiki_text): New arguments `macro' and
	`globals'.
	(ContentNode.parse_wiki_file): New arguments `macro' and
	`globals'.
	(ContentNode._node_path): Docstring improved.
	(ContentNode.resources, ContentNode.resource): Test if the
	resource is `None'.
	(DocMaker._create_children): Recourse directories.

	* lcg-mode.el (lcg-args): New variable.
	(lcg-args): New function.
	(lcg-font-lock-keywords): Use it.
	(lcg-mode): Derive the mode from `text-mode'.

	* resources/css/default.css: Updated.

	* lib/lcg/util.py (log): Encode the message into 8 bits before
	writing it to stderr.

	* lib/lcg/resources.py (_ResourceNotFound): Class removed.
	(resource): New argument `fallback'.  Return None if `fallback' is
	False and log the problem.
	(Resource.__init__): Argument `raise_error' removed.  Don't log
	inexisting source file here.
	(Resource.ok): New method.
	(Resource._needs_source_file): Method removed.
	(Transcript.__init__): Argument `raise_error' removed.
	(Transcript._needs_source_file): Method removed.
	(Transcript.ok): New method.
	(Transcript._export): Test whether the file exists.

2005-10-31  Tomas Cerha  <cerha@brailcom.org>

	* translations/help.sk.txt: New translation.

	* lcg-mode.el: New file.

	* lib/lcg/util.py (log): Indent the log message with two spaces.

	* lib/lcg/wiki.py (Formatter._link_formatter): Don't search the
	node for external links.  Report unknown nodes.

	* lib/lcg/resources.py (resource): Search the source directories
	in outer cycle and the alternative filenames in inner.  Restore
	original file extension when creating wildcard match instances.

	* translations/help.cs.txt: New translation.

2005-10-27  Tomas Cerha  <cerha@brailcom.org>

	* translations/help.txt (Module): Minor fix.

	* resources/media/responses/o0-49a.mp3: 

	* lib/lcg/content.py (_InteractiveExercise._RESPONSES): Use
	wildcard filenames to include all new files.

2005-10-26  Tomas Cerha  <cerha@brailcom.org>

	* doc/eurochance.wiki: Section structure improved.  General
	translation instructions added.

	* lib/lcg/resources.py (resource): Docstring updated.  Pass parent
	in kwargs for resource types which are not shared.  Search all
	files given by `cls.ALT_SRC_EXTENSIONS' within the source paths.
	(Resource.ALT_SRC_EXTENSIONS, Media.ALT_SRC_EXTENSIONS): New
	constants.
	(Resource.__init__): New argument 'file'.  Argument `dst_path'
	removed.  New keyword argument `parent'.
	(Resource._dst_path): New method.
	(Resource.url, Resource.export): Use it.
	(Transcript.__init__): Respect the new constructor args.
	

	* translations/help.no.txt: New file.

	* translations/help.es.txt: New file.

	* translations/help.de.txt (Listening): Removed the part about
	shorter sections.

	* translations/help.txt (answer-sheets): Mark 'Answer Sheets' as a
	translatable string.

2005-10-24  Tomas Cerha  <cerha@brailcom.org>

	* doc/index.txt: Updated.

	* doc/formatting.wiki: The renamed `wiki-formatting.wiki' file.

	* doc/wiki-formatting.wiki: Renamed to `formatting.wiki'.

	* doc/data-formats.wiki: New document.

	* doc/eurochance.wiki: Reorganized.  Sections about translations
	written.  Course structure for both courses Described in more
	detail.  All general information for the LCG taken out into the
	new document `data-formats'.

	* translations/help.txt (Listening): Improved.

2005-10-21  Tomas Cerha  <cerha@brailcom.org>

	* translations/help.txt: All the formulations improved and errors
	fixed.

2005-10-19  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Improved.

	* translations/help.de.txt: Updated.

	* translations/de.po: Updated.

	* translations/help.txt: Updated.

2005-10-18  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/__init__.py: Import `*' from `util'.  Version set to `0.1'.

	* lib/lcg/export.py (Module): Don't import `shutil'.  Import
	`_html'.
	(StaticExporter.body, StaticExporter._navigation)
	(StaticExporter._link): Use all identifiers from `_html' module
	with their full name `_html.*'.
	(StaticExporter._link): Localize the string `None' with gettext.

	* lib/lcg/_html.py (Module): Don't import `operator'.
	(b): Function replaced by `strong'.
	(strong): New function.
	(itemize): Renamed to `list'.
	(_input, button): New argument `title'.

	* lib/lcg/eurochance.py (ExerciseInstructions._create_content):
	Use gettext as `substitution_provider' when creating the
	`MacroParser' instance.

	* lib/lcg/course.py (ContentNode._read_file): Use `log' instead of
	`print'.

	* lib/lcg/content.py (Module): Import `operator'.  Import `_html',
	not `* from _html'.  Use all identifiers from `_html' module with
	their full name `_html.*'.
	(Exercise.__init__): Don't catch `ResourceNotFound' exeptions..
	(Exercise.__init__, Exercise._wiki_content): Use `log' instead of
	`print'.
	(VocabItem._DIACRITICS_MATCHER, VocabItem._DANGER_CHAR_MATCHER):
	Constants removed.
	(FillInTask.__init__): New argument `media'.
	(FillInTask.media): New method.
	(FillInTask.text): Pass `media' arg. to `field_formatter'.
	(_ClozeTask): Renamed to `MixedTextFillInTask'.
	(TransformationTask, ClozeTask): `_ClozeTask' ->
	`MixedTextFillInTask'.
	(Exercise._sound_controls): New argument `cls'.
	(Exercise._export_audio_version): Use it.
	(_FillInExercise._make_field): New arguemnt `media'.  Create sound
	control buttons when passed.
	(VocabExercise._check_tasks): Create the tasks together with
	corresponding `media'.
	(ItemizedList.export, TableOfContents._make_toc)
	(_ExposedCloze._export_instructions): `itemize' -> `_html.list'.

	* lib/lcg/wiki.py (Formatter._link_formatter): Log an invalid
	section name.
	(MacroParser._VARIABLE_REGEX): Removed.
	(MacroParser._SUBSTITUTION_REGEX): New constant.
	(MacroParser.__init__): New argument `substitution_provider'.
	`self._vars' renamed to `self._globals'.
	(MacroParser._python_eval_provider): `self._vars' ->
	`self._globals'.
	(MacroParser._substitute_variables): Removed.
	(MacroParser._substitute): New method.
	(MacroParser._substitution): New method.
	(MacroParser.add_globals): `self._vars' -> `self._globals'.
	(MacroParser.parse): Use `self._substitute' instead of
	`self._substitute_variables'.

	* lib/lcg/resources.py (ResourceNotFound): Class removed.
	(Resource.__init__): Use `log' instead of `print'.  Don't create
	the `ResourceNotFound' exception instance. 
	(Resource._export, Media._export): Use `log' instead of `print'.
	(Image): New class.

	* lib/lcg/util.py (log): New function.

	* translations/de.po: Updated.

	* translations/help.txt: Updated.

	* translations/help.de.txt: Updated.

2005-10-17  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content.py (SectionContainer.__init__): Don't create the
	table of contents, when there is one already.

	* translations/help.de.txt: New file.

	* translations/help.txt: Updated.

	* translations/de.po: Updated.

2005-10-14  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/eurochance.py (EurochanceCourse._create_content): Read
	the localized version of the `intro' file.

	* lib/lcg/util.py (copy_stream): Function removed.

	* lib/lcg/feed.py (Feeder._panic): Cosmetic change.
	(SplittableTextFeeder._process_pieces): Cosmetic change.

	* translations/de.po: Updated.

	* translations/help.txt: Minor tweaks.

2005-10-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/feed.py (VocabFeeder.__init__): Initialize `self._attr'
	instead of `self._phrases'.
	(VocabFeeder._item): Set `self._attr' when a marker is found.  Set
	`VocabItem's `attr' argument according to `self._attr'.

	* lib/lcg/content.py (VocabItem.ATTR_EXTENDED)
	(VocabItem.ATTR_PHRASE): New constants.
	(VocabItem.__init__): New argument `attr' replacing the
	`is_phrase' flag.
	(VocabItem.attr): New method.
	(VocabItem.is_phrase): Method removed.
	(VocabSection.__init__): Call `self._subsections()' to get a list
	of vocab sections.
	(VocabSection._subsections): New method.
	(VocabIndexSection._subsections): New class.
	(Exercise.help): Method removed.
	(Exercise.set_help_node, Exercise.typedict): New methods.
	(SentenceCompletion._INSTRUCTIONS)
	(SentenceCompletion._AUDIO_VERSION_LABEL)
	(_ChoiceBasedExercise._INSTRUCTIONS, Selections._INSTRUCTIONS)
	(TrueFalseStatements._INSTRUCTIONS)
	(TrueFalseStatements.._INSTRUCTIONS, GapFilling._INSTRUCTIONS) 
	(VocabExercise._INSTRUCTIONS, Transformation._INSTRUCTIONS) 
	(Transformation._instructions, Dictation._INSTRUCTIONS) 
	(_Cloze._INSTRUCTIONS, _Cloze._instructions) 
	(_ExposedCloze._INSTRUCTIONS): Instruction texts improved.

	* lib/lcg/eurochance.py (_lang): Renamed to `_user_lang'.
	(EurochanceNode._localized_wiki_content): New method.
	(IntermediateUnit._create_vocab): `self._lang()' ->
	`self._user_lang()'.
	(Instructions._create_content): Use `self._localized_wiki_content()'.
	(ExerciseInstructions.__init__): Call `set_help_node()' on the
	exercise type.
	(ExerciseInstructions._create_content): Instead of using
	`Exercise.help()', run the parser right from here.
	(GrammarBank._create_content): Use `self._localized_wiki_content()'.
	(VocabIndex._create_content): Use `VocabIndexSection' instead of
	`VocabSection'.
	(Help._create_children): `self._lang()' ->
	`self._user_lang()'.
	(_Section): Redefine the parser's `_Section' class.

2005-09-22  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/eurochance.py (EurochanceNode._lang): New method.
	(IntermediateUnit._create_vocab, Instructions._create_content)
	(ExerciseInstructions._create_content)
	(GrammarBank._create_content, Help._create_children): Use it.
	(ExerciseInstructions.__init__): New argument `template'.
	(IntermediateUnit._create_content): Don't include the grammar
	sections here.
	(ExerciseInstructions._create_content): Don't open the template
	here.  Don't use the `exercise-context' file.
	(GrammarBank): New class.
	(GrammarIndex): Removed.
	(Help._create_children): Read the template once and pass it to the
	children.
	(AdvancedCourse._create_children)
	(IntermediateCourse._create_children): Omit `CourseIndex' and
	`GrammarIndex'.
	(IntermediateCourse._create_children): Add the `GrammarBank'.

	* lib/lcg/content.py (Exercise._BUTTONS): Removed.
	(Exercise._DISPLAYS): Renamed to `_INDICATORS'.
	(Exercise._INDICATORS): New constant.
	(Exercise.help): Don't add the `buttons' and `displays' to
	parser's globals.  Pass class as `type', not `cls'.
	(_InteractiveExercise._RESPONSES): Added also the overall
	evaluation results.
	(_InteractiveExercise._DISPLAYS): -> `_INDICATORS'.
	(_InteractiveExercise._BUTTONS): Removed.
	(_InteractiveExercise._results): Define buttons right
	here. `_DISPLAYS' -> `_INDICATORS'.
	(_FillInExercise._RESPONSES): Removed.
	(_FillInExercise._BUTTONS): Removed.
	(VocabExercise._NAME): Changed to "Test Yourself".

	* resources/css/default.css: Minor improvements.

	* resources/scripts/exercises.js (Handler.evaluate): Cycle
	through the fields, not the results.
	(Handler.evaluate): Use new responses according to the parcentage.
	(ChoiceBasedExerciseHandler._error_handler): New method.

	* resources/media/responses/i02.mp3: Removed.

	* resources/media/responses/c12.mp3: Removed.

	* translations/help.txt: New file.

	* translations/exercise-instructions.txt: Renamed to `help.txt'.

2005-09-13  Tomas Cerha  <cerha@brailcom.org>

	* translations/exercise-instructions.txt: Dictation instructions
	updated.  Formatting improved.

	* lib/lcg/content.py (Dictation.__init__): New method adding a
	keyword argument `pieces'.
	(Dictation._export_recording): Removed.
	(Dictation._init_script): Use `self._pieces', not
	`self._recording' to initialize the handler.

	* doc/eurochance.wiki (transcript): New Dictation argument
	`pieces' documented.

2005-09-12  Tomas Cerha  <cerha@brailcom.org>

	* resources/scripts/exercises.js (event_key): Append modifiers
	only for mapped (special) keys.  Map also a `Backspace' key.
	(init_form): Function removed.
	(FillInExerciseHandler._handle_key): New method.
	(FillInExerciseHandler._handle_text_field_keypress): Call it.
	(DictationHandler.init_recordings): New method.
	(DictationHandler._handle_key): New method.

	* resources/css/default.css (Module): New styles added.

	* lib/lcg/wiki.py (Formatter.__init__): Fixed order of the parts
	within the paired regexp.

	* lib/lcg/util.py (SplittableText.split): Include also the groups
	of the match within the result (when there are any).
	

	* lib/lcg/eurochance.py (Unit._EXERCISE_SECTION_SPLITTER): Allow
	titled sections.
	(Unit._exercise_sections): New method.
	(Unit._create_exercises): Make use of `self._exercise_sections()'.
	(Unit._create_content): Just wrap the result od `_create_exercises()'.
	(Formatter): Don't override the `_MARKUP' constant.
	(AnswerSheet._create_content): Expect sections for both types of
	courses.

	* lib/lcg/content.py (Exercise._wiki_content): Use backslash as a
	Wiki parser escape.
	(Exercise._export_reading): Wrap the label to a div with a class
	`label'.
	(Exercise._export_instructions): Avoid an empty paragraph on
	output when the instructions are empty.
	(_InteractiveExercise._init_script): Don't rely on the Javascript
	function `init_form()' and initialize the handler directly.
	(Dictation._export_recording): Return None if the recording is a list.
	(Dictation._init_script): Call handler's method `init_recordings'
	when the recording is a list.

2005-08-26  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/feed.py (ExerciseFeeder._exercise): New assertion.
	(ExerciseFeeder._exercise.maketask): Don't print warnings here.

	* doc/eurochance.wiki: Updated.

	* doc/wiki-formatting.wiki: Updated.

	* lib/lcg/content.py (Content.export): New class.
	(GapFillStatement._REGEXP): Renamed to `_GAP_MATCHER'.
	(GapFillStatement.__init__, GapFillStatement.substitute_gap):
	Honour the change above.
	(Choice.__init__): Replace newlines in the answer by spaces.
	(_ClozeTask._REGEXP): Renamed to `_FIELD_MATCHER'.
	(_ClozeTask._fields, _ClozeTask.text, _ClozeTask.plain_text)
	(TransformationTask.__init__): Honour the change above.
	(_ClozeTask._fields): Replace newlines in answers by spaces.
	(Exercise._TASK_COUNT, Dictation._TASK_COUNT, Cloze._TASK_COUNT):
	Constant removed.
	(Exercise.__init__): Don't check task count.  Use
	`_check_tasks()'.
	(Exercise._check_tasks): New method.
	(_FillInExercise._check_tasks, VocabExercise._check_tasks) 
	(Dictation._check_tasks, Cloze._check_tasks): New methods.
	(VocabExercise.__init__): Method removed.

	* lib/lcg/wiki.py (Formatter._MARKUP): The horizontal rule
	removed.
	(Formatter._FORMAT): The format for horizontal rule removed.
	(Formatter._PAIR): Constant removed.
	(Formatter.__init__): Include the end markup rule first in the
	regexp.  Initialize the attribute `_paired_on_output'.  Allow
	backslashes in front of any markup for escaping insted of an
	exclamation mark.
	(Formatter._markup_handler): Process the escape characters
	correctly.  Don't allow improperly nested markup.  Write the
	invalid markup as is to the output.  Don't use `self._PAIR'.
	(Formatter._formatter): Use `self._paired_on_output' instead of
	`self._PAIR'.
	(Parser._MATCHERS): New matcher for horizontal rule.
	(Parser._make_rule): New method.

2005-08-22  Tomas Cerha  <cerha@brailcom.org>

	* bin/generate.py (main): Use whichever exporer with same arguemnts.

	* lib/lcg/ims.py (_Manifest.__init__): Set the `default'
	attributte for `organizations'.
	(_Manifest._create_item): Sort the resources alphabetically.
	(_Manifest.write): Set the xml encoding.
	(IMSExporter.export): Accept `node' and `directory' as arguments.

2005-08-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content.py (Exercise._TASK_TYPE): Set to None.
	(Exercise._TASK_SEPARATOR): New constant.
	(Exercise.__init__): New argument `reading_instructions'.  Don't
	try to open the file for reading, leave it to `_wiki_content'.
	Allow also `template' to be read from an external file.
	(Exercise._wiki_content): New arguments `allow_file' and `subdir'.
	When `allow_file' is true `text' is only one line, consider it a
	filename and read that file.
	(Exercise._sound_controls): Make a non-empty `action' attribute
	for the form.
	(Exercise.export): Use self._EXPORT_ORDER if not None.  The
	default export order changed (explanation goes after reading).
	(Exercise._export_tasks): Wrap the tasks and results bar into a
	form here.
	(Exercise._export_reading): Use `self._reading_instructions'.
	(Exercise._export_instructions): Don't wrap the wiki formatted
	custom instructions into a paragraph.
	(Reading._NAME): Set to "Reading".
	(Selections._NAME): Set to "Selections".
	(_FillInExercise._make_field): Give the field a name.
	(_Cloze._INSTRUCTIONS): New constant.
	(_Cloze._instructions): Use it.
	(NumberedExposedCloze, ExposedCloze): Changed order of inherited
	classes.
	(Exercise.__init__): Docstring updated.

	* lib/lcg/_test.py (ContentNode.check_misc): 'root_node' -> 'root'.

	* lib/lcg/wiki.py (Formatter._link_formatter): 'root_node' -> 'root'.

	* lib/lcg/resources.py (resource): 'root_node' -> 'root'.

	* lib/lcg/feed.py (ExerciseFeeder._exercise): Code reorganized and
	simplyfied.
	(ExerciseFeeder._read_multiline_args): Return template as None,
	when there is no more content.

	* lib/lcg/export.py (Exporter.head, StaticExporter._navigation):
	'root_node' -> 'root'.
	(StaticExporter.head): Add a `rel' link to `start'.

	* lib/lcg/eurochance.py (IntermediateUnit._create_vocab) 
	(IntermediateUnit._create_content, Instructions._create_content) 
	(ExerciseInstructions._create_content): 'root_node' -> 'root'.

	* lib/lcg/course.py (ContentNode.root_node): Renamed to `root'.
	(ContentNode.root, ContentNode.next, ContentNode.prev) 
	(ContentNode.src_dir, ContentNode.id): 'root_node' -> 'root'.

	* lib/lcg/_html.py (form): New function.
	(_input): Add a slash at the end of the tag for XHTML compatibility.
	(script_write): Escape also the `</' sequence.

	* translations/de.po: Updated.

2005-08-09  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/feed.py
	(ExerciseFeeder._TEMPLATE_TASK_MATCHER): New constant.
	(ExerciseFeeder._exercise): Added support for the `template' argument.

	* lib/lcg/content.py (Anchor.export): Use `link()'.
	(Link.export): Use `link()'.
	(Exercise._TASK_SEPARATOR): New constant.
	(Exercise.__init__): New argument template.  Simplified processing
	of `example', `explanation' and `instructions'.
	(Exercise._wiki_content): Return None, when the arguemnt is None.
	Assertion added in the other case.
	(Exercise._form_name): Use '%d', not '%s' to format the id.
	(Exercise._sound_controls): Don't use the `brackets' argument of
	`link()'.
	(Exercise.export): Wrap the header into a div and add the help
	link here.  Use `self._export_tasks()'.
	(Exercise._export_tasks): New method.
	(Exercise._export_instructions): Don't include the link "detailed
	instructions".
	(Exercise._export_task): Append `self._TASK_SEPARATOR'.
	(_InteractiveExercise._answer_sheet_link): Don't use the
	`brackets' argument of `link()'.  Don't wrap the link into a `span'.
	(_InteractiveExercise.answer_sheet): Dont include the link back to
	the exercise.
	(_FillInExercise._answer_sheet_items): Join the alternatives using
	a semicolon.
	(Cloze._TASK_SEPARATOR): New constant.

	* lib/lcg/course.py (ContentNode._read_file): Don't try the
	version without the language extension when tha language was not
	specified at all.

	* lib/lcg/_html.py (link): Arguemnt 'brackets' removed.
	Add the 'external-link' class when target is not None.

	* lib/lcg/eurochance.py (IntermediateUnit._create_content): Don't
	create the local Table of Contants at the and Grammar Exercises
	sections.
	(Instructions._create_content): Act differently for the advanced
	course.

	* resources/css/default.css: New styles added.

	* translations/de.po: Updated.

	* resources/scripts/exercises.js (Handler.eval_answer): Don't
	focus the field.

2005-08-08  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/feed.py (Feeder.__init__): Method removed.
	(FileFeeder, PySpecFeederError, PySpecFeeder): Classes removed.
	(VocabFeeder._item): Also consider the term a phrase, when "(phr.)
	note found.
	(VocabFeeder._item): Pass `None' as translation, when no
	translation found.
	(ExerciseFeeder._MULITLINE_ARG_MATCHER): New constant.
	(ExerciseFeeder.__init__): Method removed.
	(ExerciseFeeder._exercise): Parse also task comments
	(ExerciseFeeder._parse_exercise_spec)
	(ExerciseFeeder._read_multiline_args): New methods.
	(ExerciseFeeder._read_header): Docstring updated.
	(ExerciseFeeder._read_task): New arguemnt `comment'.  More task
	types added.  Method mapping updated.
	(ExerciseFeeder._read_selection): Method removed.
	(ExerciseFeeder._read_generic_task): New method.
	(ExerciseFeeder._read_choices): New method.
	(ExerciseFeeder._read_multiple_choice_question): Method removed.
	(ExerciseFeeder._read_prompt_and_choices): New method.
	(ExerciseFeeder._read_cloze, ExerciseFeeder._read_dictation)
	(ExerciseFeeder._read_fill_in_task): Methods removed.
	(ExerciseFeeder._read_true_false_statement): New arguemnts `type'
	and `comment'.

	* lib/lcg/eurochance.py (Unit._read_xls_vocab): Method removed.
	(Unit): Docstring updated.
	(Unit._create_content): Implement a simple reader for the advanced
	course.
	(IntermediateUnit): New class.
	(IntermediateUnit._create_vocab): Don't pass the `input_encoding'
	argument to `VocabFeeder' constructor.
	(IntermediateUnit._create_exercises): Use '#' as a comment start.
	Don't pass `input_encoding' argument to `ExerciseFeeder'
	constructor.
	(IntermediateUnit._create_content): `_parse_wiki_file()' ->
	`parse_wiki_file()'.  Use the grammar file in the user's language.
	(Instructions._create_content): Use the instructions in the user's
	language.
	(GrammarIndex._TITLE): Changed to "Grammar Bank".
	(AnswerSheet._answer_sheets): New method.
	(AnswerSheet._create_content): Different implementation for the advanced
	course.
	(AdvancedCourse, IntermediateCourse): New classes.

	* bin/generate.py (main): Don't call `lcg.set_language()'.  Just
	set the environment variable `LCG_LANGUAGE' and import lcg afterwards.

	* lib/lcg/wiki.py (Formatter._FORMAT): Don't insert a "\n" after
	the "br" tag.

	* lib/lcg/export.py: 
	(Exporter.HTTP_EQUIV): Constant removed. 
	(Exporter.head): Don't use it.  Just supply `Content-Type' and
	`Content-Language' here.  Also add meta information from the
	`ContenNode.meta()' method.
	(StaticExporter.head): Don't add the meta information here.

	* lib/lcg/course.py (ContentNode._read_file): When the file of
	given language extension is not found, try the same file without
	this extension.
	(set_language): Function removed.

	* lib/lcg/content.py (Content.lang): When `self._lang' is None,
	return container's or parent's language.
	(TextContent.__init__): Pass keyword arguments to parent class.
	(Container._TAG, Container._CLASS, Container.EXPORT_INLINE): New
	constants.
	(Container._export_content): New method.
	(Container.export): Implemented a general HTML tag exporter with a
	support for `lang' and `class' attributes configurable by class
	constants.
	(Paragraph.export, DefinitionList.export, FieldSet.export)
	(TableCell.export, TableRow.export, Table.export): Methods removed.
	(Paragraph._TAG, DefinitionList._TAG, FieldSet._TAG, FieldSet._CLASS) 
	(TableCell._TAG, TableCell._EXPORT_INLINE, TableRow._TAG)
	(Table._TAG, Table._CLASS): New constants.
	(ItemizedList.__init__): Pass keyword arguments to parent class.
	(SectionContainer._export_content): New method.
	(SectionContainer.export): Method removed.

	* lib/lcg/_test.py (Module): Don't care about `gettext'.
	(ContentNode.check_misc): Use keyword arguemnts with their names.
	Don't assume b in a's children.
	(ContentNode.check_media): Don't use the removed arguemnt `tts_input'.
	(ContentNode.check_media): Don't expect the result of
	`resources()' in any particular order.
	(SplittableText.check_it): Import `lcg.feed'.  Refer to the feeder
	using a full name.
	

	* lib/lcg/_html.py (_tag): Cosmetic improvements.
	(itemize): New argument `lang'.

	* lib/lcg/__init__.py: When the environment variable
	`LCG_LANGUAGE' is set, install gettext with an appropriate language.

	* translations/de.po: File updated. Translations added.

2005-08-03  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: New styles added.

	* TODO: Updated.

	* resources/scripts/exercises.js (last_correct_char_index):
	Function removed.
	(Handler.get_answer): Renamed to `get_value'.
	(Handler._eval_answer): New method.
	(Handler._eval_answers): `get_answer' -> `get_value'.  Use
	`_eval_answer()'.
	(Handler._fill_answer): New method.
	(Handler.fill): Use it.
	(ChoiceBasedExerciseHandler.get_answer): Renamed to `get_value'.
	(FillInExerciseHandler._find_answer): New method.
	(FillInExerciseHandler._error_handler): Use it.
	(FillInExerciseHandler._eval_answer)
	(FillInExerciseHandler._fill_answer): New methods.
	(FillInExerciseHandler._handle_text_field_keypress): Define
	`_this' instead of inexistent `this'.  Use it.  Use
	`_find_answer()' and chnge the hint behavior accordingly.

	* lib/lcg/content.py (Section._ANCHOR_PREFIX): New constant.
	(Section.__init__): initialize `self._backref_used'.
	(Section.anchor): Use `self._ANCHOR_PREFIX'.
	(backref): New argument node.  Return backref only for the TOC
	links within the same page.
	(TableOfContents._make_toc): Pass parent to `i.backref()'.
	(Link): New class.
	(Task.__init__): New keyword argument `comment'.
	(Task.comment): New method.
	(_ChoiceTask.__init__, Selection.__init__)
	(GapFillStatement.__init__): Pass the **kwargs.
	(TrueFalseStatement.__init__, FillInTask.__init__)
	(TransformationTask.__init__): Pass the `comment' kwarg.
	(_ClozeTask, TransformationTask, ClozeTask): Heavilly rewritten.
	(Exercise._ANCHOR_PREFIX): Redefined.
	(Exercise._TASK_COUNT): New constant.
	(Exercise.__init__): Check task count.
	(Exercise._export_task): Call `self._export_task_parts()' and
	format the resulting parts.
	(_InteractiveExercise._ANSWER_SHEET_LINK_CLASS): New constant.
	(_InteractiveExercise._answer_sheet_answers): Removed.
	(_InteractiveExercise._answer_sheet_items): New method.
	(_InteractiveExercise._answer_sheet_anchor): Use `self.anchor()'
	to make the anchor.
	(_InteractiveExercise._answer_sheet_link): New method.
	(_InteractiveExercise.answer_sheet): Append comments (if they
	exist) after the answer.
	(_ChoiceBasedExercise._answer_sheet_answers): Removed.
	(_ChoiceBasedExercise._answer_sheet_items): New method.
	(_ChoiceBasedExercise._export_task)
	(GapFilling._export_task_parts, _FillInExercise._TASK_FORMAT):
	Replaced by `_export_task_parts()'.  Don't wrap the text into a
	paragraph.
	(_FillInExercise._answers): Don't care about the Cloze Task here.
	(_FillInExercise._answer_sheet_items): new method.
	(_FillInExercise._make_field): Use `self._answer_sheet_link()'.
	(_FillInExercise._export_task): Replaced by `_export_task_parts()'.
	(VocabExercise._TASK_FORMAT): Don't add a linebreak at the end.
	(Transformation._TASK_FORMAT): Don't wrap the text into a paragraph.
	(Cloze): Renamed to `_Cloze'.
	(ExposedCloze): Renamed to `_ExposedCloze'.
	(_Cloze._export_task): Removed.
	(NumberedCloze): Derive from `_Cloze', not `Cloze'.
	(NumberedExposedCloze): Derive from `_ExposedCloze' and `NumberedCloze'.
	(Cloze): New class derived from `_Cloze'.
	(ExposedCloze) New class derived from `_ExposedCloze' and Cloze:

2005-07-29  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content.py (TextContent.__str__): New method.
	(PreformattedText.export): Replace the '<', '>', '&' and '"'
	characters by HTML entities.
	(Field): New class.
	(FieldSet): New class.
	(Section.backref, Section._backref): New methods.
	(Section._header): Make the header a beck-reference to the TOC.
	(TableOfContents._make_toc): Set also the link names to allow
	back-referencing.
	(VocabList.export): Export `None' translations as `???'.
	(GapFillStatement.__init__): Removed assert to allow just plain
	sentences between the statements.
	(_ChoiceTask.__init__): Allow a plain sentence without choices.
	(FillInTask.text): New method.
	(_ClozeTask): New class.
	(ClozeTask, TransformationTask): Derive from it.
	(Exercise._READING_REQUIRED): New constant.
	(Exercise._INSTRUCTIONS, Exercise._AUDIO_VERSION_LABEL): New
	constants.
	(Exercise.__init__): New keyword arguemnts `instructions',
	`reading', `explanation' and `example'.
	(Exercise._wiki_content): New method.
	(Exercise._sound_controls): Make the `Stop' button invisible, when
	Media Player is not in use.
	(Exercise.export): Export also explanations, reading example and
	recording.
	(Exercise._export_explanation, Exercise._export_example)
	(Exercise._export_reading): New methods.
	(Exercise._export_instructions): Use self._INSTRUCTIONS constant
	or the custom instructions from the constructor argument.
	(Exercise._export_recording): Return `None', when there is no
	recording.
	(Exercise._export_audio_version): Use the constant
	`self._AUDIO_VERSION_LABEL'.
	(Listening, Reading): New classes.
	(SentenceCompletion._instructions)
	(MultipleChoiceQuestions._instructions, Selections._instructions)
	(TrueFalseStatements._instructions, GapFilling._instructions)
	(VocabExercise._instructions, Substitution._instructions)
	(Cloze._instructions): Methods removed.
	(MultipleChoiceQuestions._INSTRUCTIONS, Selections._INSTRUCTIONS)
	(TrueFalseStatements._INSTRUCTIONS, GapFilling._INSTRUCTIONS)
	(VocabExercise._INSTRUCTIONS, Substitution._INSTRUCTIONS)
	(Cloze._INSTRUCTIONS): New constants.
	(_InteractiveExercise._RESPONSES): Use the glob-style filenames.
	(_InteractiveExercise._init_resources): Dont search the existing
	responses here.
	(_InteractiveExercise._answer_sheet_url): New method.
	(_InteractiveExercise._results): Use it.
	(_ChoiceBasedExercise._answers): Ignore tasks with no choices.
	(_ChoiceBasedExercise._choice_label): New method.
	(_ChoiceBasedExercise._format_choice):  Use it.
	(TrueFalseStatements._choice_label): New method.
	(GapFilling._export_task): Use `.replace()', not string
	formatting, to replace the gap (it may not be there...).
	(_FillInExercise._answers): Act according to task type.
	(_FillInExercise._make_field): Use `self._answer_sheet_url()'.
	(_FillInExercise._export_task): Use the `text()' method of the task.
	(VocabExercise._AUDIO_VERSION_LABEL): Redefined here.
	(VocabExercise.__init__): Include each word only once and allow
	multiple correct answers, where there are more translations.
	(Cloze._answers): Method removed.
	(Cloze._export_task): Format the text using self._wiki_content().
	(NumberedCloze): New class.
	(ExposedCloze): New class.
	(NumberedExposedCloze): New class.

	* lib/lcg/course.py (ContentNode.__init__): Create instance's own
	wiki Parser as `self._wiki_parser'.
	(ContentNode._read_file): Remove the UNICODE marker from the first line.
	(ContentNode.parse_wiki_text): New method.
	(ContentNode.parse_wiki_file): Use `self._wiki_parser'.
	(_WikiNode._create_content): Use `ContentNode.parse_wiki_text()'.

	* resources/css/default.css: Updated.

	* doc/wiki-formatting.wiki: Updated.

	* doc/eurochance.wiki: Updated.

	* lib/lcg/wiki.py (Formatter._MARKUP): New items added.  Some
	items renamed.
	(Formatter._PAIR, Formatter._FORMAT): Respect the changes in `_MARKUP'.
	(Parser._LIST_MARKER): Allow also a minus sign and a preceding bracket.
	(Parser._SPLITTER_RE): Allow also tabs in list item indentation.
	Split also at field-set item start.
	(Parser._MATCHERS): New rules for `field' and `definition'.
	(Parser._REGEXPS): Allow empty lines preceding any of the regesps.
	(Parser._HELPER_PATTERNS): Add new patterns from new rules.
	(Parser._build_sections): Renamed to `_make_sections()'.
	(Parser._parse_sections): `_build_sections()' -> `_make_sections()'.
	(Parser._store_list_item, Parser._finish_list_item) 
	(Parser._store_field, Parser._finish_field) 
	(Parser._store_definition, Parser._finish_definition) 
	(Parser._parse_blocks): Completely rewritten.
	(Parser._list_item_type): Recognize a minus sign as an unordered type.
	(escape): Removed.
	(_log): New funftion.
	(Parser.parse): Remove all comment lines before further processing.

	New method.

	* lib/lcg/_html.py (link): New keyword argument 'name'.
	(script): Add a final newline after the comment end.
	(script_write): New keyword argument 'condition'.

	* lib/lcg/resources.py (Resource._export): Don't do anything, when
	the source file doesn't exist.
	(Resource.__init__): Don't raise the exception, just print it.
	(resource): Forgotten debug prints removed.
	(Resource._export): Use `shutil.copyfile()' instead of
	``shutil.copy()'.

	* lib/lcg/util.py (_create_piece): Renamed to 'piece()'.
	(SplittableText.split): New keyword argument `maxsplit'.

2005-07-19  Tomas Cerha  <cerha@brailcom.org>

	* translations/de.po: File updated.

	* translations/Makefile (LCG_SOURCE_FILES): Path fixed.

2005-07-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/course.py (ContentNode._read_file): Cosmetic changes.
	(ContentNode._parse_wiki_file): Renamed to `parse_wiki_file'.
	(ContentNode.resources): Return keys, not the values of
	`self._resources'.
	(ContentNode.resources): Make a tuple from the returned list.
	(ContentNode.resource): Don't cache the resources here, use the
	new `resource()' function instead.

	* lib/lcg/resources.py (_cache): New variable.
	(resource): New function.
	(Resource.SHARED): New constant.
	(Resource.__init__): The arguments replaced just by `src_path' and
	`dst_path'.
	(Resource._check_file): Method removed.
	(Removed._needs_source_file): New method.
	(Resource._find_source_file): Method removed.
	(Resource._export): Catch the `IOError' when copying
	(Media.SHARED): New constant.
	(Media.__init__): Reflect the constructor args change.
	(Media._find_source_file): Method removed.
	(SharedMedia.SHARED): New class.
	(Transcript.__init__): Reflect the constructor args change.
	(Transcript._check_file): Method removed.
	(Transcript._needs_source_file): New method.

	* lib/lcg/wiki.py: Typos fixed.

	* lib/lcg/util.py: Typos fixed.

	* lib/lcg/ims.py: Typos fixed.

	* lib/lcg/_test.py: Typos fixed.

	* doc/wiki-formatting.wiki: Typos fixed.

	* doc/eurochance.wiki: Typos fixed.

	* translations/exercise-instructions.txt: Typos fixed.

	* TODO: Updated.

2005-07-12  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: New classes `reading' and `explanation'.

	* bin/generate.py (main): New command-line argument '--advanced'.
	Generate an `AdvancedCourse' if given, or 'IntermediateCouirse'
	otherwise.w
	(usage): Call `sys.exit(2)' at the end.
	(main): Don't call `sys.exit(2)' after `usage()'.

	* doc/eurochance.wiki: Bad unicode fixed.

	
2005-05-18  Tomas Cerha  <cerha@brailcom.org>

	* doc/eurochance.wiki: New file.

	* doc/structure.wiki: File remoevd.

	* doc/formats.wiki: File remoevd.

	* doc/index.txt: `wiki-formatting.wiki' added.  `structure.wiki'
	and `formats.wiki' replaced with `eurochance.wiki'.

	* doc/wiki-formatting.wiki: New file.

	* lib/lcg/wiki.py (Formatter._link_formatter): Get the groups
	using `.get()', not directory indexing.
	(Formatter._FORMAT): Use the `<u></u>' tag for `underline'.

2005-05-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/content.py (Section.url): Handle the `relative' flag
	correctly.
	(TableOfContents._make_toc): Pass the `relative' flag correctly.

	* lib/lcg/course.py (_WikiNode._create_content): Test
	`self._title_' for None, not just as boolean.

	* lib/lcg/__init__.py (__version__): New variable.

2005-05-11  Tomas Cerha  <cerha@brailcom.org>

	* lib/lcg/config.py (_base_dir): Removed.
	(lcg_dir): New variable.
	(translation_dir, default_resource_dir): Use it.

	* resources/media/responses/*.mp3: New sound files.

	* resources/css/default.css (a): Updated for new `speaking_text'
	implementation.

	* bin/generate.py (main): Recognize the `ims' arg and use the IMS
	exported when passed.

	* lcg/content.py (VocabList.export): Use `span' for the
	translation, not a `label'.

	* lcg/_html.py (span): New function.
	(speaking_text): Implement the JavaScript control as a button.

2005-04-07  Tomas Cerha  <cerha@brailcom.org>

	* lcg/_html.py (div): New keyword argument `lang'.

	* lcg/content.py (Content.__init__): New argument `lang'.
	(Content.lang): New method.
	(Container.__init__): Pass **kwargs to the super-class.
	(SectionContainer.__init__): Pass **kwargs to the super-class.
	(SectionContainer.export): Wrap the content to a `div()' with the
	language set correctly.
	(Section.__init__): Pass **kwargs to the super-class.
	(VocabItem.__init__): Don't pass the removed `tts_input' argument
	to the `Media' constructor.
	(Exercise.help): Don't wrap the content into the `SectionContainer'
	(_InteractiveExercise._RESPONSES): Changed specification format.
	(_InteractiveExercise._RESPONSE_TTS): Constant removed.
	(_InteractiveExercise.__init__): The creation of `self.responses' reimplemented.
	(_InteractiveExercise._response): Select a random response with
	given selector.
	(_FillInExercise._RESPONSES): Changed specification format.
	(_FillInExercise._RESPONSE_TTS): Constant removed.
	* lcg/eurochance.py (EurochanceNode.resource): New method.
	(ExerciseInstructions._create_content): Added support for reading
	the instructions in users language.  Wrap the result af calling
	`Exercise.help()' into a `SectionContainer'.
	

	* lcg/wiki.py (MacroParser._ConditionalText.__str__): Use
	`unicode()' instead of `str()'.
	(MacroParser.parse): Use `unicode()' instead of `str()'.

	* lcg/resources.py (ResourceNotFound): New exception class.
	(Resource._check_file): Raise `ResourceNotFound' when the resource
	was not found.
	(Resource._destination_file): Method removed.
	(Resource.export): Don't use `self._destination_file()'. Pass
	`infile' and `outfile' to `self._export()'.
	(Resource._export): New arguments `infile' and `outfile' replacing
	the old `dir'.
	(Media._FORCE_OUTPUT_FORMAT): Constant removed.
	(Media.__init__): Argument `tts_input' removed.  Don't care about
	`_FORCE_OUTPUT_FORMAT'.
	(Media._check_file): Method removed.
	(Media._find_source_file): Don't add the transcript dir to input
	dirs.  Omit the text formats from input formats.
	(Media._command, Media._open_stream_from_tts)
	(Media._open_stream_from_encoder): Methods removed.
	(Media._export): Don't care about TTS, just do the conversion if
	necessary.
	(Transcript._export): New arguments `infile' and `outfile'
	replacing the old `dir'.

2005-04-06  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (Exercise._sound_controls): Don't add the colon
	after the label.
	(Exercise._export_recording): Add a colon to the label.
	(Exercise._export_audio_version): Add a colon to the label.
	(SentenceCompletion._export_audio_version): Add a colon to the label.

2005-04-01  Tomas Cerha  <cerha@brailcom.org>

	* translations/exercise-instructions.txt: New file.

	* resources/scripts/exercises.js (simulate_click_on_keypress): New
	function.
	(SelectBasedExerciseHandler.set_answer): Bug fixed.

	* resources/css/default.css: Updated.

	* lcg/eurochance.py (ExerciseInstructions._create_content): Read
	the template file and pass it to `Exercise.help()'.
	(Help._create_children): Don't set the `subdir' constructor arguement.

	* lcg/content.py (VocabItem.export): Wrap the translation into a
	`label'.
	(VocabItem): Derive from `object', not `Record'.
	(VocabItem.word, VocabItem.word, VocabItem.word, VocabItem.word)
	(VocabItem.word, VocabItem.word): New methods.
	(Task.__init__, Task.id, Task.prompt): New methods.
	(Choice): Derive from `object', not `Record'.
	(Choice.answer, Choice.answer): New methods.
	(_ChoiceTask.__init__): Pass prompt to super-class's constructor.
	(_ChoiceTask.prompt): Removed.
	(Selection.__init__): Pass `None', not an empty string as `prompt'
	to super-class's constructor.
	(FillInTask): New class.
	(TransformationTask): Class removed.
	(DictationTask): Derive from `FillInTask'.
	(Exercise._KEYS, Exercise._HELP): Constants removed.
	(Exercise.help): Method completely rewritten using the
	`MacroParser' and a template passed as an argument.
	(SentenceCompletion._HELP, _InteractiveExercise._HELP)
	(_ChoiceBasedExercise._HELP, Selections._HELP)
	(_SelectBasedExercise._HELP, MultipleChoiceQuestions._HELP)
	(TrueFalseStatements._HELP, GapFilling._HELP)
	(_FillInExercise._HELP, Cloze._HELP, VocabExercise._HELP)
	(Transformation._HELP, Substitution._HELP, Dictation._HELP):
	Constants removed.
	(_FillInExercise._KEYS): Constant removed.
	(_InteractiveExercise._DISPLAYS, Dictation._DISPLAYS)
	(_InteractiveExercise._BUTTONS, _FillInExercise._BUTTONS): Make
	the name the first item in the spec and don't include the help in
	the spec at all.
	(_InteractiveExercise._results): Respect the changed display and
	button spec.
	(_ChoiceBasedExercise._js_choice_control): Wrap the choice into a
	`label' element.  Put the Radio-button in front of the label and
	assign id an `id'..
	(_ChoiceBasedExercise._export_task): Don't wrap the task into a
	paragreph, separate each line using the `br' element.
	(_SelectBasedExercise._format_choices): Assign an `id' to the
	combo-box and pass the handler as `onchange' to `select()'.
	(_SelectBasedExercise._export_task): New method.
	(_FillInExercise._TASK_TYPE): Set to `FillInTask'.
	(_FillInExercise._TASK_FORMAT): New constant.
	(_FillInExercise._answers): Make use of `FillInTask.answer()'.
	(_FillInExercise._make_field): New argument `id'.  Pass it to `field()'.
	(_FillInExercise._export_task): Wrap the prompt into a `label'
	element and assign an `id' to the field.
	(VocabExercise._TASK_FORMAT): New constant.
	(VocabExercise._export_task): Method removed.
	(Transformation._TASK_TYPE): Constant removed.
	(Transformation._export_task): Method removed.
	(Dictation._transcript_text): Make use of `FillInTask.answer()'.
	(Cloze._answers): New method.

	* lcg/util.py (Record): Class removed.

	* lcg/wiki.py (MacroParser): New Class.

	* lcg/feed.py (ExerciseFeeder._exercise)
	(ExerciseFeeder._exercise): Use `FillInTask', not `ClozeTask', for
	`VocabExercise'.
	(ExerciseFeeder._read_task): Update the mapping.
	(ExerciseFeeder._read_fill_in_task): New method.
	(ExerciseFeeder._read_transformation): Method removed.

	* lcg/course.py (ContentNode._input_file): New argument `dir'.
	(ContentNode._read_file): New argument `dir'.  Pass it to
	`self._input_file()'.

	* lcg/config.py: Declare the base directory as `_base_dir' and use it.

	* lcg/_html.py (label): New function.
	(_input): New argument `id'.
	(field, radio): Accept and pass the arguments as `**kwargs'.
	(select): New argument `id'.
	(label): New function.
	(_input): New arguments `onclick', `onkeydown' and `onfocus'.
	Arguemnt `handler' removed.
	(button, reset): Arguemnt `handler' renamed to `onclick'.
	(select): Arguemnt `handler' renamed to `onchange'.
	(speaking_text): Implement the control using a read-only text field.

2005-03-31  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (Exercise.__init__): Don't use
	`self._create_transcript()'.  Create the instance here, but use
	`self._transcript_text()' as a value for it's `text' argument.
	(Exercise._create_transcript, Cloze._create_transcript): Methods
	removed.
	(Exercise._transcript_text, Cloze._transcript_text)
	(Dictation._transcript_text): New method.

	* lcg/resources.py (Resource.export): Also do the export if
	`self._additional_export_condition()' returns True.
	(Resource._additional_export_condition): New method.
	(Transcript._additional_export_condition): New method.
	(Transcript._export): Wrap the text before exporting.

	* doc/index.txt: Order changed.

2005-03-29  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py (DocNode._id): New method.
	(DocMaker._create_content): TOC depth set to 2.

	* lcg/export.py (StaticExporter._INDEX_LABEL): New constant.
	(StaticExporter._navigation): Use it.

	* lcg/eurochance.py (EurochanceExporter): New class.

	* bin/generate.py: Use `EurochanceExporter'.

	* doc/manual.wiki: File removed.

	* doc/structure.wiki: Updated.

	* doc/intro.wiki: New file.

	* doc/index.txt: New file.

	* doc/formats.wiki: New file.

2005-03-24  Tomas Cerha  <cerha@brailcom.org>

	* bin/docmaker.py: New script.

	* lcg/course.py (RootNode, _WikiNode, DocNode, DocMaker): New
	classes.
	(WikiNode): Derive from `_WikiNode'.

	* lcg/eurochance.py (EurochanceCourse._create_children): Use
	`list_dir' instead of `list_subdirs'.

	* lcg/util.py (list_subdirs): Removed.
	(list_dir): New function.

	* lcg/content.py (Container.content): New method.

	* doc/roles.wiki: File removed.

2005-03-23  Tomas Cerha  <cerha@brailcom.org>

	* resources/scripts/audio.js: Don't set the statusbar messages.
	Some cosmetical changes.

	* lcg/eurochance.py (Unit._create_content): Supply the `anchor'
	argument to the Exercises section.
	(AnswerSheets, AnswerSheet): New classes.
	(EurochanceCourse._create_children): Include also `AnswerSheets'.

	* lcg/content.py (Section.url): Return the relative url when
	`relative' is True, not vice versa /bug/.
	(Anchor): New class.
	(Exercise.__init__): The title string changed to include the `%d'
	formatting mark (for translations).
	(_InteractiveExercise._init_script): Added a semicolon to the end
	of the JavaScript expression.
	(_InteractiveExercise._results): Include a link to the answer
	sheets in the non-JavaScript version.
	(_InteractiveExercise._answer_sheet_answers) 
	(_InteractiveExercise._answer_sheet_anchor) 
	(_InteractiveExercise.answer_sheet) 
	(_ChoiceBasedExercise._answer_sheet_answers): New methods.
	(_FillInExercise._make_field): Append a direct link to the answer
	sheet in the non-JavaScript version.
	(VocabExercise._NAME): Name changed.

	* lcg/course.py (ContentNode._PARENT_ID_PREFIX): New constant.
	(ContentNode.sections): Docstring added.
	(ContentNode.id): Dont prefix the id with the parent's id when
	`self._PARENT_ID_PREFIX' is False.

	* lcg/_html.py (speaking_text): Add a semicolon to the handler
	statement.
	(script): Add a Javascript comment in front of the HTML comment.
	(script_write): Write no script when the `conetnt' is an emptyu
	srting.
	(script): Don't wrap the script into comments when there is no
	code.

2005-03-19  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (VocabItem.__init__): Make the filename as
	`item-01.ogg' - `item-50.ogg'.

	* lcg/course.py (ContentNode.__init__): Don't create the counter
	here, just initialize a dictionary.
	(ContentNode.counter): New argument `key'.  Try to find a counter
	for given key in the dictionary or create a new one.

	* lcg/export.py (StaticExporter._hotkey): Key bindings changed. 

2005-03-17  Tomas Cerha  <cerha@brailcom.org>

	* lcg/export.py (StaticExporter._hotkey): Key names changed.
	(StaticExporter.body): Don't include the navigation bar at the top
	of the page.  Don't include the 'content-beginning' anchor.
	(StaticExporter._navigation): Use the renamed hotkay identifiers.
	(StaticExporter._navigation): If the "Up" link is omitted, include
	it as an invisible link (for the shortcut key to work).

	* resources/scripts/exercises.js (Handler.init): Instead of
	`this._answered' initialize two independent arrays `this._results'
	and `this._first_attempt'.
	(Handler._eval_answer): Replaced by `Handler._eval_answers()'.
	Remember the first attempts separately from current results.
	(Handler.eval_answer): Use `Handler._eval_answers()' instead of
	`Handler._eval_answer()' and `Handler.display_results()'
	(Handler.set_answer, Handler.get_answer): New methods.
	(Handler.evaluate): New method.
	(Handler.correct, Handler.incorrect): Use `this._results' instead
	of `this._answers'.
	(Handler.first_attempt_correct, Handler.first_attempt_percentage):
	New methods.
	(Handler.display_results): Display the current results as well as
	the first attempt results.
	(Handler.fill): Use `this.set_answer()' instead of
	`this.set_field()'.  Call `this._eval_answers()' at the end.
	(Handler.reset): Instead of `this._answered' initialize two
	independent arrays `this._results' and `this._first_attempt'.
	(ChoiceBasedExerciseHandler.set_answer)
	(ChoiceBasedExerciseHandler.get_answer): New mothods.
	(ChoiceBasedExerciseHandler.set_field): Removed.
	(SelectBasedExerciseHandler): Derive directly from `Handler', not
	`ChoiceBasedExerciseHandler'.
	(SelectBasedExerciseHandler._init_field): New method.
	(SelectBasedExerciseHandler.set_answer): New method.
	(FillInExerciseHandler.evaluate): Method moved to `Handler'.
	(DictationHandler._eval_answer): Method removed.

	* lcg/wiki.py (Formatter._link_formatter): Try to find a node
	by an id and use it's title and url instead of the id.
	(Formatter._MARKUP): Put the link anchor to a separate group.
	(Formatter._HELPER_PATTERNS): New item `anchor'.
	(Formatter._formatter): Don't call the formatter in the try/except
	block.
	(Formatter._link_formatter): The logic of searching the url and
	title within the content rewritten.

	* lcg/eurochance.py (Unit._id): Method removed.
	(Instructions._create_content): Don't include the index of
	children within the content.
	(Instructions._create_children, Instructions._id): Methods removed.
	(Help): New class.
	(EurochanceCourse._create_content): Pass `item=self' to the
	constructor of `TableOfContents'.  
	(EurochanceCourse._create_children): Add `Help' as a last child.

	* lcg/course.py (ContentNode._id): Don't add a number to the id.
	(ContentNode.find_node): New method.
	(ContentNode.id): Add an index number to the id if it is not
	unique.
	(ContentNode.__init__): Wrap the content into a `SectionContainer'
	instead of `Container'.
	

	* lcg/content.py: 
	(_InteractiveExercise._MESSAGES): A message added.
	(_InteractiveExercise._DISPLAYS): Help texts improved.
	(_ChoiceBasedExercise._HELP): Text improved.
	(Selections._HELP): Text improved.
	(_FillInExercise._BUTTONS): Help texts improved.
	(_FillInExercise._KEYS): Help texts improved.
	(Dictation._MESSAGES): Marge also the super-class messages.

2005-03-16  Tomas Cerha  <cerha@brailcom.org>

	* resources/scripts/exercises.js (DictationHandler._eval_field):
	New method.

	* lcg/eurochance.py (ExerciseInstructions.__init__): Argument
	`exercise_class' renamed to `type'
	(ExerciseInstructions._create_content): Use the class method
	`Exercise.help()' instead of reading the help from a file.
	(ExerciseInstructions._id): Make the id here instead of using the
	class method `Exercise.id()'.
	(ExerciseInstructions.src_dir): Method removed.
	(ExerciseInstructions._create_content): Pass the `pre' argument to
	`Exercise.help()' if a file for given exercise type exists in the
	source direstory.

	* lcg/content.py (Definition): New class.
	(DefinitionList): New class.
	(Exercise._BUTTONS, Exercise._DISPLAYS, Exercise._KEYS)
	(Exercise._HELP, Exercise._help_node): New constants.
	(Exercise.id): Method removed.
	(Exercise.help): New class method.
	(Exercise._export_instructions): Use `self._help_node' instead of
	a hardcoded URL.
	(SentenceCompletion._instructions): Text improved.
	(SentenceCompletion._HELP):
	(_InteractiveExercise._INITIAL_RESULT): Constant removed.
	(_InteractiveExercise._DISPLAYS, _InteractiveExercise._BUTTONS)
	(_ChoiceBasedExercise._HELP, MultipleChoiceQuestions._HELP)
	(Selections._HELP, TrueFalseStatements._HELP, GapFilling._HELP)
	(_FillInExercise._BUTTONS, _FillInExercise._KEYS)
	(_FillInExercise._HELP, Cloze._HELP, VocabExercise._HELP)
	(Transformation._HELP, Substitution._HELP, Dictation._DISPLAYS)
	(Dictation._HELP): New constants.
	(_InteractiveExercise._buttons, _InteractiveExercise._display):
	Methods removed.
	(_InteractiveExercise._results): Use the constants `_BUTTONS' and
	`_DISPLAYS' instead of the methods.
	(_ChoiceBasedExercise._buttons, _FillInExercise._buttons) 
	(Dictation._display): Methods removed.
	(GapFilling._instructions): Text improved.
	(Exercise.help): New keyword argument `pre'.  Add the `pre'
	content before the instructions.  Only wrap instructions into a
	section, when other sections exist.

2005-03-11  Tomas Cerha  <cerha@brailcom.org>

	* doc/structure.wiki: Updated.

	* doc/roles.wiki: Updated.

	* doc/manual.wiki: Updated.

	* bin/generate.py (Module): Completely rewritten.

	* bin/wiki-formatter.py (Module): New file.

	* lcg/wiki.py (Formatter._MARKUP): Uncomment the rules for
	`italic' and `fixed'.  The pair markup defined now as one item.
	New rules for `link', `uri', `email', `comment' and `rule'
	(Formatter._HELPER_PATTERNS): New constant.
	(Formatter._FORMAT): New formats for `comment' and `rule'.
	(Formatter._REGEXPS, Formatter._RULES): Constants removed.
	(Formatter.__init__): Compile the rules here.
	(Formatter._markup_handler): Check whether the type is not in
	`_HELPER_PATTERNS'.
	(Formatter._markup_handler): Pass the match groupdict to the
	formatter.
	(Formatter._formatter): New argument `groups'.  Pass it to the
	spicialized formatter.
	(Formatter._link_formatter, Formatter._uri_formatter)
	(Formatter._email_formatter): New methods.
	(Formatter.format): Use `self._rules', not `self._RULES'.  Pass an
	empty groupdict to the closing formatter.
	(Parser._SECTION_RE): Allow the anchor name behind the heading.
	(Parser._PRE_BLOCK_RE): New regexp.
	(Parser._MATCHERS): New rule for `toc'.
	(Parser._HELPER_PATTERNS): New `title' pattern.
	(Parser._Section.__init__): New argument `anchor'.
	(Parser._parse_sections): Honour it.
	(Parser._parse_section_content): Search for the preformatter
	blocks here.
	(Parser._parse_blocks): New method.  Everything whar was before in
	`_parse_section_content()' was copied here.
	(Parser._make_toc): New method.
	(Formatter._MARKUP): New rule for a `dash'.
	(Formatter._FORMAT): New format for a `dash'.

	* resources/css/default.css: New class `lcg-preformatted-text'.

	* lcg/export.py (Exporter.DOCTYPE, Exporter.HTTP_EQUIV): New
	constants.
	(Exporter.__init__): New arguments `stylesheet' and
	`inlinestyles'.  Arguments `dir' and `course' removed.
	(Exporter._styles, Exporter.head, Exporter.body, Exporter.page):
	New methods.
	(Exporter.export): New arguments `node', `directory'.  Don't call
	`_export_node()', do everything here.
	(Exporter._wrap_content, Exporter._export_node): Methods removed
	(StaticExporter.DOCTYPE, StaticExporter.__init__): Removed.
	(StaticExporter.head, StaticExporter.body): New methods.
	(StaticExporter._wrap_content): Method removed.

	* lcg/__init__.py: Install `NullTranslations' as a default
	`gettext' handler.  Import the `config' module.

	* lcg/resources.py (Resource.__init__): Prepend current directory
	to the list of src directories.
	(Resource.get): New method.

	* lcg/eurochance.py (EurochanceNode): New class.
	(Unit, Instructions, ExerciseInstructions, _Index)
	(EurochanceCourse): Derive from it
	(Unit._create_exercises): Use `comment' as a keyword arg. when
	calling `self._read_file()'.
	(Instructions._create_content): Don't use superclass method, just
	use `self._parse_wiki_file()' instead.
	(ExerciseInstructions): New class (moved from `course.py').
	(EurochanceCourse.__init__): Reflect the superclass change.
	(EurochanceCourse._title, EurochanceCourse._create_content): New
	methods.
	(Formatter._MARKUP): Exclude the `italics' and `fixed' rules.
	(Instructions._create_content): Pass `self' as the `item' to
	`TableOfContents' constructor.
	(EurochanceCourse._create_content): 

	* lcg/content.py (PreformattedText): New class.
	(TableOfContents.__init__): Don't use the `parent' as deafult
	`item'.  Docstring updated.
	(TableOfContents.export): When the `item' is None, use the
	container.  If the container is None or not a `SectionContainer'
	instance, use the parent.
	(Section.url): New keyword argument `relative'.  Return only the
	anchor part if true.
	(TableOfContents._make_toc): Make the URLs of the local sections
	relative.

	* lcg/config.py (Module): New file.

	* lcg/course.py (ContentNone.__init__): Argument
	`default_resource_dir' removed.
	(ContentNode.__init__): Don't allocate the default stylesheet.
	(ContentNode._create_child): Don't pass `default_resource_dir'.
	(ContentNode._read_file): New argument `ext'.
	(ContentNode._parse_wiki_file): New argument `ext'.
	(default_resource_dir): Method removed.
	(InnerNode, RootNode, TextNode): Classes removed.
	(ExerciseInstructions): Moved to the `eurochance' module.  Classes
	removed.
	(WikiNode): New Class.
	(WikiNode._create_content): Always wrap the sections into a
	`SectionContainer'.
	(WikiNode._title): New function.
	(set_language): Honour the `translation_dir' argument if given.

2005-03-09  Tomas Cerha  <cerha@brailcom.org>

	* resources/scripts/exercises.js (init_form): New argument
	`messages'.  Pass it to `handler.init()'
	(Handler.init): New argument `messages'.
	(Handler.msg): New method.
	(FillInExerciseHandler._recognize_field): Recognize also
	`textarea' fields.
	(FillInExerciseHandler._error_handler): Focus the field.
	(FillInExerciseHandler._handle_text_field_keypress): Return false
	after handling the `Enter' key.  Don't remove the trailing text
	when handling the `Ctrl-Space' key.  Just insert the next correct
	character.
	(FillInExerciseHandler.evaluate): Move the cursor to the first
	incorrect answer.
	(FillInExerciseHandler.evaluate): When there is only one field,
	use the simple `correct/incorrect' responses.
	(DictationHandler): New class.

	* lcg/content.py (SectionContainer.__init__): Don't generate the
	TOC when there is only one item.
	(VocabList.export): Handle `None' value of `VocabItem.note()'.
	(VocabItem.__init__): Allow `None' value for the `note' argument.
	(ClozeTask.plain_text): News class.
	(_InteractiveExercise._INITIAL_RESULT) 
	(_InteractiveExercise._MESSAGES): New constants.
	(_InteractiveExercise._init_script): Pass the `messages'
	dictionary to JavaScript `init_form()'.
	(_InteractiveExercise._display): New method.
	(_InteractiveExercise._results): Use it.
	(_FillInExercise._INITIAL_RESULT): New constant.
	(Dictation._TASK_TYPE, Dictation._FORM_HANDLER) 
	(Dictation._MESSAGES): Redefined here.
	(Dictation.__init__): Redefined here.
	(Dictation._instructions): Real instructions added.
	(Dictation._export_task): New method.
	(Dictation._display): New method.

	* lcg/feed.py (SplittableTextFeeder._process_pieces): The argument
	`error_message' removed.
	(VocabFeeder.feed): Honor that.
	(ExerciseFeeder.feed): Honor that.
	(VocabFeeder._item): Set note to `None', if none found.
	(ExerciseFeeder._read_task): Added support for DictationTask.
	(ExerciseFeeder._read_dictation): New method.

	* lcg/_html.py (js_dict): Surround the keys in quotes.

	* resources/css/default.css: Added styles for `vocab-list' class.

2005-03-08  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (WikiText.export): Use `wiki.Formatter', not
	`wiki.InlineFormatter'.
	(VocabList.export): Put the translation into a `span' with the
	`lang' attributte set.  Set the table class to `vocab-list'.
	(VocabItem.__init__): New arguments `is_phrase' and
	`translation_language'.
	(VocabItem.word, VocabItem.translation): Methods removed.
	(VocabSection): New class.

	* lcg/feed.py (FileFeeder.__init__): Don't pass `*args', just `**kwargs'.
	(SplittableTextFeeder._pieces): Method removed.
	(SplittableTextFeeder._process_pieces): New method.
	(ExcelVocabFeeder): Class removed.
	(VocabFeeder): New class.
	(ExerciseFeeder.feed): Use `self._process_pieces()'.
	(ExerciseFeeder._exercise): Don't handle exceptions here.

	* lcg/wiki.py (InlineFormatter): Renamed to `Formatter'.
	(Formatter._FORMAT): Added format for `citation'.
	(Formatter._formatter): Try the method first and use the `_FORMAT'
	as a falback.
	(Formatter._citation_formatter): Method removed.

	* lcg/course.py (ContentNode.__init__): Improved assertion.
	(ContentNode._input_file): New argument `lang'.
	(ContentNode._read_file): New argument `lang'.  Pass it to
	`_input_file()'.
	(ContentNode._parse_wiki_file): New moethod.
	(TextNode._create_content): Use `_parse_wiki_file()'.
	(InnerNode._create_content): Use `_parse_wiki_file()'.
	(Unit, Instructions, _Index, CourseIndex, GrammarIndex._TITLE)
	(VocabIndex._TITLE, EurochanceCourse): Classes moved to
	`eurochance.py'.

	* lcg/eurochance.py: New module.  This module isolates the classes
	specific for the Eurochance course (taken from `course.py').

2005-03-05  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Added styles for `lcg-table' class.

	* lcg/content.py (Table.export): Specify the class `lcg-table' for
	the generated table.

2005-03-04  Tomas Cerha  <cerha@brailcom.org>

	* lcg/_html.py (ul): Renamed to `itemize()'.
	(itemize): New arguments `ordered', `style' and `class'.

	* lcg/content.py (Section.__init__): New argument `anchor'.
	Docstring improved.
	(Section.anchor): If the `anchor' was specified, return it.
	(TableOfContents.__init__): Allow also a sequence of `Content'
	instances as the `item' arguemnt.
	(TableOfContents._make_toc): Handle the sequence of `Content'
	instances as the `item' arguemnt.
	(VocabList.__init__): New argument `reverse'.
	(VocabList.export): Reverse the word pair if `reverse' is true.
	(ListItem): Class removed.
	(ItemizedList.__init__): Expect a sequence of `Content' instance,
	not `ListItem'.
	(ItemizedList.export): Use `itemize()'.
	(TableOfContents._make_toc): Use `itemize()', not `ul()'.

	* resources/css/default.css (citation, quotation): New classes. 
	(results): BG color changed.
	(display): BG color for input fields set to `none'.

	* lcg/wiki.py: File encoding set to utf-8.
	(InlineFormatter._MARKUP): New markup added.
	(InlineFormatter._PAIR): New constant.
	(InlineFormatter._FORMAT): New formatting rules adeed.
	(InlineFormatter._markup_handler): Handle the pair/unpair tags.
	(InlineFormatter._formatter): Handle the pair/unpair tags.
	(InlineFormatter._example_formatter): Renamed to `_citation_formatter'. 
	(InlineFormatter._citation_formatter): CSS class changed to `citation'.
	(Parser._LIST_MARKER): New constant.
	(Parser._SECTION_RE, Parser._SPLITTER_RE): Use it.
	(Parser._MATCHERS): New rule for `table'.
	(Parser._MATCHER): Use `re.DOTALL' and not `re.MULTILINE'.
	(Parser._make_itemized_list): Method removed.
	(Parser._identify_block): Return the type `paragraph' for
	unmatched block.
	(Parser._parse_section_content): Handle the list type for list
	items.  Handle all other blocks by the `_make_<type>' method.
	(Parser._make_paragraph, Parser._make_paragraph) 
	(Parser._list_item_type): New methods.
	(Parser._parse_section_content): Use just the `WikiText', not
	`ListItem' for list items.

	* lcg/course.py (Unit._create_content): Don't limit the TOC depth.
	(CourseIndex._create_content): Set TOC depth to 99.
	(ContentNode.find_section): New method.
	(Unit._create_content): Save the vocab items to the attribute
	`self.vocab'.
	(Unit._create_content): Pass the `anchor' argument to the Grammar
	section constructor.
	(_Index): New class.
	(CourseIndex): Derive from `_Index'.
	(GrammarIndex): New class.
	(VocabIndex): New class.
	(EurochanceCourse._create_children): Add `GrammarIndex' and
	`VocabIndex' to children.

2005-03-03  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (ItemizedList.TYPE_UNORDERED, ItemizedList.TYPE_ALPHA)
	(ItemizedList.TYPE_NUMERIC): New constants.
	(ItemizedList.__init__): New argument `type'.
	(ItemizedList.export): Reflect the list type.
	(TableCell, TableRow, Table): New classes.
	(SectionContainer.__init__): Only count sections with `in_toc' set
	to True.
	(Section.__init__): New argument `in_toc'.
	(Section.in_toc): New method.
	(TableOfContents._make_toc): Only use sections with `in_toc' set
	to True.
	(Exercise.__init__): Set `in_toc' to False in superclass
	constructor call.

	* lcg/wiki.py (InlineFormatter._MARKUP): Italics commented out.
	(Parser._REGEXPS): added the MULTILINE switch.
	(Parser.parse): Call `self._parse_sections()' instead of
	`self._parse_section_content()'

2005-03-02  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py: Just import * from `lcg' and don't import all the
	used LCG modules separately.
	(TextNode._create_content): Use the `wiki.Parser' to create the
	content.
	(InnerNode._create_content): Use the `wiki.Parser' to create the
	content.
	(Unit._create_content): Refer to the feeder as
	`feed.ExcelVocabFeeder', not just `ExcelVocabFeeder'.
	(Unit._create_content): Use the `wiki.Parser' to create some
	sections.  Use `SectionContainer' instead of just `Container'.
	(Unit._create_grammar): Method removed.
	(Unit._create_exercises): Refer to the feeder as
	`feed.ExerciseFeeder', not just `ExerciseFeeder'.
	(Instructions._create_content): Expect a tuple form super method
	call.
	(ExerciseInstructions._create_content): Use the `wiki.Parser' to
	create the content.

	* bin/generate.py: New argument `LCG dir'.  Use it to locate
	translations and default resources.

2005-03-01  Tomas Cerha  <cerha@brailcom.org>

	* lcg/wiki.py: All the code borrowed before from the Trac Wiki
	formatted finally removed.  Thus all the copyright notices removed
	and added Copyright to Brailcom, o.p.s.  Don't import `time' and
	`string' and `StringIO'.  Import * from `lcg'.
	(CommonFormatter, OneLinerFormatter, Formatter, _Node, Section):
	Classes removed.
	(InlineFormatter, Parser): New classes.
	(parse_sections, format, wiki_to_oneliner): Functions removed.

	* lcg/resources.py: Just import * from `lcg' and don't import all
	the used LCG modules separately.

	* lcg/feed.py: Just import * from `lcg' and don't import all
	the used LCG modules separately.

	* lcg/export.py: Just import * from `lcg' and don't import all
	the used LCG modules separately.

	* lcg/content.py: Just import * from `lcg' and don't import all
	the used LCG modules separately.
	(Content): Docstring updated.
	(Content.set_container): Added class assertion.
	(GenericText): Renamed to `TextContent'.
	(TextContent.export): New method.
	(WikiText.export): Use `wiki.InlineFormatter' class instead of
	`wiki.format()' function.
	(Container): Don't care about the contained sections and TOC. 
	(Container.__init__): Argument `toc_depth' removed.
	(SectionContainer): New class.
	(Paragraph): New class.
	(ListItem.export): New Class
	(Section): Derive from `SectionContainer', not `Container'.
	

	* lcg/__init__.py: Import also the `feed' and `wiki' and `ims'
	modules and don't import * from ims.
	

2005-02-23  Tomas Cerha  <cerha@brailcom.org>

	* lcg/wiki.py (CommonFormatter._rules): Markup changed.  Rules for
	`htmlescapeentity' and `fancylink' removed.
	(CommonFormatter._htmlescapeentity_formatter)
	(CommonFormatter._url_formatter)
	(CommonFormatter._fancylink_formatter): Removed.
	(OneLinerFormatter): Class removed.
	(OneLinerFormatter): Removed the `url' rule.
	(Formatter._rules): Removed `svnimg', `macro', `url' and `imgurl'
	rule.
	(Formatter._compiled_rules): Removed the unnecessary items.
	(Formatter._macro_formatter, Formatter._svnimg_formatter): Removed.
	(_Node, Section): New classes.
	(parse_sections): New function.

	* lcg/course.py (Unit._create_grammar): New method.
	(Unit._create_content): Use it.

	* lcg/content.py (Section.__init__): Set `self._title' before
	calling superclass constructor.

2005-02-21  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (GapFillStatement.__init__): Overriden.
	(GapFillStatement._REGEXP): New constant.
	(GapFillStatement.substitute_gap): New method.
	(Exercise._form): Method removed.
	(Exercise._sound_controls)
	(Exercise._export_instructions): Use `_html.p()'.
	(SentenceCompletion._TASK_TYPE): Set to `None'.
	(SentenceCompletion._export_task): Removed.
	(_InteractiveExercise): Docstring added.
	(_InteractiveExercise.__init__): Allocate the script 'audio.js'.
	(_InteractiveExercise._js_array): Removed.
	(_InteractiveExercise._response): New method.
	(_InteractiveExercise._init_script): Don't use `self._form()' and
	`self._js_array()'.  Use `html.js_array()', `html.js_dict()'.
	(_ChoiceBasedExercise._answer_control): Method removed.
	(_ChoiceBasedExercise._non_js_choice_control)
	(_ChoiceBasedExercise._js_choice_control): New methods.
	(_ChoiceBasedExercise._format_choice): Use them instead of
	`self._answer_control()'.  Put the control behind the answer text.
	(_ChoiceBasedExercise._format_choices): New method.
	(_ChoiceBasedExercise._export_task): Use it.
	(_SelectBasedExercise): New class.
	(GapFilling, TrueFalseStatements): Derive from
	`_SelectBasedExercise', not `_ChoiceBasedExercise'.
	(GapFilling._export_task): Overriden.
	(Transformation._export_task, _FillInExercise._export_task): Use
	`html.p()'
	(Cloze, VocabExercise, Transformation, Substitution, Dictation):
	Docstring updated.
	(Dictation._RECORDING_REQUIRED): Set to `True'.

	* lcg/_html.py: Import all from `util'.
	(_attr): Cosmetic improvement.
	(_tag): New function.
	(p): New function.
	(div): Use `types.ListType' and `types.TupleType' to decide.
	(radio): Make `handler' a keyword argument.
	(select): New function.
	(js_value, js_array, js_dict): New functions.
	(div): Use `_tag()'.  Make `cls' a keyword argument.
	(link): Use `_tag()'.

	* lcg/feed.py (ExerciseFeeder._read_gap_fill_statement): Don't
	check for the gaps here.

	* resources/scripts/exercises.js:
	(ChoiceBasedExerciseHandler._init_fields)
	(FillInExerciseHandler._init_fields): Removed.
	(Handler.init): Instead of `this._init_fields()', call
	`this._init_field()' for each recognized field.  Create the
	`this._fields' array here.
	(Handler._eval_answer): Define `i' before the if/else block.
	(Handler.fill): New method.
	(Handler.set_field): New method.
	(ChoiceBasedExerciseHandler.prototype._init_fields)
	(FillInExerciseHandler._init_fields): Removed.
	(ChoiceBasedExerciseHandler._recognize_field)
	(FillInExerciseHandler._recognize_field): New methods.
	(ChoiceBasedExerciseHandler._init_field)
	(FillInExerciseHandler._init_field): New methods.
	(ChoiceBasedExerciseHandler.fill)
	(FillInExerciseHandler.fill): Removed.
	(ChoiceBasedExerciseHandler.set_field): New method.
	(SelectBasedExerciseHandler): New class.
	
	* resources/css/default.css (results): Minor improvements.

2005-02-18  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (_ChoiceTask.__init__): Assertion added.
	(_ChoiceTask.correct_choice): New method.
	(Exercise._AUDIO_VERSION_LABEL): Removed.
	(Exercise.__init__): Don't allocate the JavaScript code resource.
	(Exercise._export_instructions): Use `self._export_recording()'
	and `self._export_audio_version()'.
	(Exercise._export_recording): New method.
	(Exercise._export_audio_version): New method.
	(SentenceCompletion._AUDIO_VERSION_LABEL): Removed.
	(SentenceCompletion._export_audio_version): New method.
	(_InteractiveExercise): New class.
	(_FillInExercise): New class.
	(_Cloze): Class removed.
	(Cloze): Derive from `_FillInExercise', not `_Cloze'.
	(_ChoiceBasedExercise): Derive from `_InteractiveExercise', not
	`Exercise'.
	(_ChoiceBasedExercise._FORM_HANDLER): New constant.
	(_ChoiceBasedExercise._answer_control): Completely rewritten.
	(_ChoiceBasedExercise._answers): New method.
	(_ChoiceBasedExercise._results): Method removed.
	(_ChoiceBasedExercise._buttons): New method.
	(_ChoiceBasedExercise._format_choice): Pass the `Choice' to
	`self._answer_control()'.
	(TrueFalseStatements._format_choice): Pass the `Choice' to
	`self._answer_control()'.
	(VocabExercise, Transformation, Dictation): Derive from
	`_FillInExercise', not `_Cloze'.

	* lcg/_html.py (_attr, _input): New functions.
	(field, button): Reimplemented using `_input()'.
	(reset, hidden, radio): New functions.
	(link): Use `_attr()'.

	* resources/css/default.css (results): Minor improvements.

	* resources/scripts/exercises.js (eval_choice, reset_choices)
	(display_choice_results, init_cloze_form, eval_cloze_field)
	(handle_cloze_field_keypress, fill_cloze, eval_cloze): Functions
	removed and replaced by handler class methods.
	(Handler, ChoiceBasedExerciseHandler, FillInExerciseHandler): New
	classes.

2005-02-16  Tomas Cerha  <cerha@brailcom.org>

	* translations/de.po: Updated.

	* lcg/wiki.py (CommonFormatter._rules): The `wikilink' rule removed.
	(CommonFormatter._wikilink_formatter): Method removed.

	* lcg/course.py (RootNode): Docstring updated.

	* lcg/content.py (VocabExercise2): Class removed.

	* lcg/resources.py (Transcript._export): Encode the text to UTF-8
	before writing.

2005-02-15  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (ClozeTask.plain_text): New method.
	(Exercise._AUDIO_VERSION_REQUIRED, Exercise._AUDIO_VERSION_LABEL):
	New constants.
	(Exercise.__init__): New argument `audio_version'.  Create the
	transcript using the `_create_transcript()' method.  Make sure the
	`audio_version' was specified if `self._AUDIO_VERSION_REQUIRED' is
	true.
	(Exercise._create_transcript): New method.
	(Exercise._sound_controls): New method.
	(Exercise._export_instructions): Use it for both the recording and
	the audio version.
	(Cloze._RECORDING_REQUIRED): Unset.
	(SentenceCompletion._AUDIO_VERSION_REQUIRED): Set to True.
	(SentenceCompletion._AUDIO_VERSION_LABEL): Set.
	(SentenceCompletion._instructions): Teext improved.
	(Cloze._create_transcript): New method.
	(Cloze._instructions): The condition corrected.
	(Substitution): New class.

2005-02-14  Tomas Cerha  <cerha@brailcom.org>

	* lcg/feed.py (ExerciseFeeder._exercise): Cosmetical improvement.

	* lcg/resources.py (Media._FORCE_OUTPUT_FORMAT): New constant.
	(Media.__init__): Change the format if `_FORCE_OUTPUT_FORMAT' is set.
	(Media._export): Raise the exception as an `Exception' instance.
	(Transcript.__init__): New argument `text'.
	(Transcript._check_file, Transcript._check_file): New methods.

2005-02-10  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py (ContentNode._read_file): New argument `comment'.
	Omit the matching lines from the source file.
	(Unit._create_exercises): Pass the comment regexp to to
	`_read_file()'.

	* lcg/feed.py (Feeder._current_input_position): New argument
	`object'.  Return None here.
	(Feeder._panic, Feeder._warn): Test the result of
	`_current_input_position()' for None.
	(FileFeeder._current_input_position): Use the line number from the
	argument, if given.
	(SplittableTextFeeder._current_input_position): Use the given
	`SplittableText' instance, if given.
	(ExerciseFeeder._exercise): Check for `SentenceCompletion'
	corrected.  Pass current piece of text to `_panic()'.  Check for
	`TrueFalseStatements' added.
	(ExerciseFeeder._read_task): Pass current piece of text to
	`_panic()'.

2005-01-19  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py (Unit._create_content): Pass the vocabulary items
	to the `ExerciseFeeder' constructor.
	(Unit._create_exercises): Read all five sections from the source
	file.
	

	* lcg/feed.py (ExerciseFeeder.__init__): New keyword argument
	`vocabulary'.
	(ExerciseFeeder._exercise): Allow also exercises with no tasks.
	Automatically generate tasks for `VocabExercise'.

	* lcg/content.py (VocabExercise.__init__): Removed.
	(VocabExercise._create_task): Removed.

2005-01-18  Tomas Cerha  <cerha@brailcom.org>

	* lcg/resources.py (Resource.__init__): Expect the source files in
	the SUBDIR.
	(Media._find_source_file): Search also the `Transcript' source
	directory.

	* lcg/course.py (ContentNode._input_file): New method.
	(ContentNode._read_file): Use it.
	(InnerNode._create_content): Minor change in TOC title.
	(_ExerciseNode, VocabularyPractice, ExerciseNode)
	(ListeningComprehension, GeneralComprehension, GrammarPractice)
	(Consolidation): Removed.
	(Unit._create_content): Pass the full path to the input file to
	`ExcelVocabFeeder'.  Use `self._create_exercises()' to create the
	`Exercises' section content.  Wrap the sections to a Container to
	be able to specify the `toc_depth' here.
	(Unit._create_exercises): New method.

	* lcg/feed.py (FileFeeder.__init__): Arguments `dir' and `file'
	replaced just by one `filename'.
	(FileFeeder._input_file): Removed.
	(FileFeeder._current_input_position): Use just the attribute
	`self._filename' instead of `self._input_file()'.
	(PySpecFeeder): Docstring updated.
	(PySpecFeeder._input_file): Removed.
	(PySpecFeeder._get_module): Get the dirname and modulename out of
	`self._filename'.
	(ExcelVocabFeeder.feed): Use just the attribute
	`self._filename' instead of `self._input_file()'.

	* lcg/content.py (Content.__init__): Initialize `self._container'.
	(Content.set_container, Content.container)
	(Content._container_path): New methods.
	(Container.__init__): Argument `parts' renamed to `content'.
	Allow a sequence of 'Content' instances, as well as a `Content'
	instance as `content' argument.  Set the container for all
	contained elements.  Don't insert TOC into the contents, just
	remember it as a separate attribute `self._toc'.
	(Container.export): Honour the constructor changes.
	(Section): Docstring rewritten.
	(Section._HEADING_LEVEL): Removed.
	(Section.__init__): Argument `contains_children' removed.  New
	argument `toc_depth'.  Pass it to parent's constructor.  Don't
	deal with the subsections here, leave it up to the parent class.
	(Section.contains_children): Removed.
	(Section.title): Substitute the section number here.
	(Section.anchor): Include the section numbers of all parent
	sections in the hierarchy.
	(Section._header): Set the heading level according to the depth in
	the section hierarchy.
	(Section._section_path, Section.section_number): New methods.
	(TableOfContents.__init__): The argument `local' removed.
	(TableOfContents._make_toc): Don't consider self._local and
	`Section.contains_children'.

2005-01-14  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py (ContentNode._TOC_TITLE): Constant removed.
	(ContentNode._ABBREV_TITLE): New constant.
	(ContentNode.__init__): When `self._create_content()' returns a
	sequence, wrap it into a `Container'.
	(ContentNode._create_content): Docstrint updated.
	(ContentNode._id): Docstrint updated.
	(ContentNode._title): New method.
	(ContentNode._abbrev_title): New method.
	(ContentNode.sections): New method.
	(ContentNode.url): New method.
	(ContentNode.subdir): Docstrint updated.
	(ContentNode.title): New keyword arguemnt `abbrev'.  Reimplemented
	using the new methods `_title()' and `_abbrev_title()'.
	(ContentNode.toc_title): Method removed.
	(ContentNode.full_title): Docstrint updated.
	(ContentNode.has_index): Method removed.
	(InnerNode._create_content): Add a `TableOfContents' after the
	intro text.
	(InnerNode.title): Removed.
	(InnerNode._title): New method.
	(RootNode.has_index): Removed.
	(Vocabulary): Class removed.
	(Grammar): Class removed.
	(_ExerciseNode): New class.
	(VocabularyPractice): Derive from `_ExerciseNode'.
	(VocabularyPractice._create_content): Create just one exercise.
	(ExerciseNode): Derive from `_ExerciseNode'.
	(GeneralComprehension): New class.
	(ListeningComprehension._TITLE): Changed.
	(Summary): Class removed.
	(Unit): Derive from `ContentNode', not `InnerNode'.
	(Unit._TOC_TITLE, Unit._TITLE): New constants.
	(Unit._create_content): Completely reimplemented -- create
	everything except for exercises as inline section.
	(Unit._create_children): Create only the `ExerciseNode' sections.
	(Unit.title): Removed.
	(Unit._abbrev_title): New mothod.
	(Unit._title): New mothod.
	(ExerciseInstructions.title): New keyword arguemnt `abbrev'.
	(ExerciseInstructions.src_dir): New method.
	(CourseIndex): New class.
	(Instructions._create_content): New method.
	(EurochanceCourse.has_index): Removed.
	(EurochanceCourse._create_children): Create also the `CourseIndex'.

	* lcg/ims.py (_Manifest._create_item): Use `ContentNode.url()'
	instead of `ContentNode.output_file()'.
	

	* lcg/export.py (StaticExporter._wrap_content): Use list
	comprehension.  Use `ContentNode.url()' instead of
	`ContentNode.output_file()'.
	(StaticExporter._link): Use `ContentNode.url()' instead of
	`ContentNode.output_file()'.

	* lcg/content.py (Content.sections): New method.
	(Content.parent): New method.
	(Section, SubSection, SubSubSection, TableOfContents)
	(Container.__init__): New arguments `toc_depth' and `toc_local'.
	Prepend a `TableOfContents' to the parts when there is more than
	one `Section' contained.
	(Container.sections): New method.
	(Exercise): Derive from `Section'.
	(Exercise._RECORDING_REQUIRED): New constant.
	(Exercise.__init__): Honour the two changes above.
	(Exercise._header): Removed.
	(Exercise._results): New method.
	(_Cloze): New class.
	(Cloze): Derive from it.  All methods except for `_instructions()'
	moved to `_Cloze.
	(TrueFalseStatements._instructions)
	(MultipleChoiceQuestions._instructions, Selections._instructions)
	(GapFilling._instructions, VocabExercise._instructions)
	(VocabExercise2._instructions, Transformation._instructions):
	Instructions simplified and wrapped by gettext.
	(Dictation, Transformation, VocabExercise): Derive from `_Cloze',
	not `Cloze'.
	(SentenceCompletion): Derive from `Exercise' not `Cloze'..

	* lcg/_html.py (h, b): New functions.

2005-01-13  Tomas Cerha  <cerha@brailcom.org>

	* lcg/feed.py (Feeder._current_input_position)
	(Feeder._current_input_position, Feeder._current_input_position)
	(FileFeeder._current_input_position): New methods.
	(SplittableTextFeeder): Descend from `Feeder'.
	(SplittableTextFeeder.__init__): Always expect just a
	`SplittableText' instance as an argument.
	(SplittableTextFeeder._pieces): Don't reduce the sequence.  There
	is just one `SplittableText' instance in `self._text'.
	(SplittableTextFeeder.__init__): New method.
	(ExcelVocabFeeder.feed): Use `self._panic()'.
	(ExcelVocabFeeder.feed): Use `self._warn()'.
	(ExerciseFeeder._panic): Method removed.
	(ExerciseFeeder._exercise): Check the tasks for
	`SentenceCompletion' /temporary hack/.
	(ExerciseFeeder._exercise, ExerciseFeeder._read_task): Don't pass
	filename and linenumber to `self._panic()'.

	* lcg/export.py (StaticExporter._div, StaticExporter._toc)
	(StaticExporter._make_toc): Methods removed.
	(StaticExporter._link): Use the `link()' function from `_html'.
	Unused keyword argument `title' removed /always use
	`node.title()'/.  Use the abbreviated title for label.
	(StaticExporter._navigation): Use just "Up" instead of
	`node.toc_title()'.  Use `div()' instead of `self._div()'.

	* lcg/_html.py: Import `operator' and `types'.
	(div): New function.
	(link): New arguments `hotkey' and `title'.  Order of keyword
	arguments changed.

	* lcg/resources.py: Import `codecs' and everything from `util'.

	* translations/Makefile: New file.

	* Makefile: File removed from CVS.

2005-01-07  Tomas Cerha  <cerha@brailcom.org>

	* lcg/util.py (camel_case_to_lower): New function.

	* lcg/export.py (StaticExporter._toc): Use
	`ContentNode.has_index()' instead of testing node class.

	* lcg/course.py (ContentNode.__init__): Store the children in the
	order as returned by `_create_children()', not as registered.
	(ContentNode._register_child): Append registered children to
	`self._registered_children', not `self._children'.
	(ContentNode._id): Use `camel_case_to_lower()'.
	(ContentNode.has_index, InnerNode.has_index, RootNode.has_index):
	New method.
	(Unit._id, Unit.title): Don't add one to the index.
	(ExerciseInstructions): New class.
	(Instructions): New class.
	(EurochanceCourse._create_children): Add `Instructions' as a first
	node.

	* lcg/content.py (Exercise._used_types): New class variable.
	(Exercise.__init__): Append the exercise class to
	`Exercise._used_types' if it is not already there.
	(Exercise.task_type): Cosmetical changes.
	(Exercise.task_type, Exercise.name, Exercise.id) 
	(Exercise.used_types): New methods.
	(Dictation._NAME): New constant.
	(Exercise._export_instructions): Append a link to detailed
	instructions to the end of inline instructions.

2005-01-06  Tomas Cerha  <cerha@brailcom.org>

	* lcg/export.py: Import everything from `resources' instead of
	`content'.
	(StaticExporter._wrap_content): Use `ContentNode.resource()'
	instead of `ContentNode.stylesheet()'.

	* lcg/course.py: Import everything from `resources'.
	(ContentNode.__init__): Use `ContentNode.resource()' instead of
	`ContentNode.stylesheet()'.
	(_resource): Removed.
	(ContentNode.resource): New method /transformed from
	`_resource()'/.
	(media, script, stylesheet): Removed.
	(Unit._create_children): Use a list comprehension instead of
	creating each child separately.
	(ContentNode.subdir): Return an empty string for the root node.
	(ContentNode.src_dir): Return just `self._subdir' for the root node.
	(RootNode.__init__): Argument `dir' removed.  Pass args and kwargs
	as they are.  Only sypply None for `parent'.
	(RootNode.src_dir): Removed.

	* lcg/content.py: Import everything from `_html'.
	(Resource, Media, Script, Stylesheet): Moved from here to the new
	`resources' module.
	(_field, _button, _script, _script_write, _speaking_text): Moved
	to the new `_html' module and renamed.
	(VocabList.export, Exercise.export)
	(Exercise._export_instructions, Cloze._results)
	(Cloze._make_field, _ChoiceBasedExercise._answer_control)
	(_ChoiceBasedExercise._results): Use functions from the `_html'
	module instead of the removed methods.
	(VocabItem.__init__, Exercise.__init__, Exercise.__init__)
	(Cloze.__init__, _ChoiceBasedExercise._answer_control): Use
	`ContentNode.resource()' instead of `ContentNode.media()' and
	`ContentNode.script()'.
	(VocabList.__init__): Allocate the `audio.js' script.

	* lcg/resources.py (Module): New module.  
	(Resource, Media, Script, Stylesheet): Moved here from the
	`content' module.
	(Transcript): New class.
	(Resource.__init__): Argument `check_file' Removed.  Don't check
	the existence of source file here, just call 'check_file()'
	(Resource._check_file): New method.
	(Media._check_file): New method.

	* lcg/__init__.py: Import everything from `resources'.

2005-01-05  Tomas Cerha  <cerha@brailcom.org>

	* lcg/feed.py: Docstring updated.  Don't import `unicodedata'.
	(Feeder.__init__): Arguments `file' a `dir' removed.  The
	`encoding' argument renamed to `input_encoding'.  Docstring added.
	(FileFeeder): New class.
	(SplittableTextFeeder): New class.
	(PySpecFeeder): Docstring updated.
	(ExcelVocabFeeder): Derive from `FileFeeder'.
	(ExcelVocabFeeder.feed): Don't create the `Media' instance here
	and don't pass it to `VocabItem' constructor.  Return the items as
	a sequence.  Don't wrap them.
	(ExcelVocabFeeder.feed.safe_char): Removed.
	(ExerciseFeeder): Derive from `SplittableTextFeeder'.
	(ExerciseFeeder._EXERCISE_MATCHER)
	(ExerciseFeeder._BLANK_LINE_MATCHER): Renamed to
	`ExerciseFeeder._EXERCISE_SPLITTER' and
	`ExerciseFeeder._BLANK_LINE_SPLITTER'
	(ExerciseFeeder.feed): Don't read the input file.  Take the source
	text from the constructor argument /from `SplittableTextFeeder'/.
	Don't wrap the exercises into a `Container'.  Return them as a
	sequence.
	(ExerciseFeeder._panic): New method.
	(ExerciseFeeder._exercise): `self._BLANK_LINE_MATCHER' ->
	`self._BLANK_LINE_SPLITTER'.
	(ExerciseFeeder._exercise): Use the new `_panic()' method.
	(ExerciseFeeder._read_task): Use the new `_panic()' method.

	* lcg/course.py: Docstring updated.
	(ContentNode): Docstring updated.
	(ContentNode.__init__): Make the `subdir' argument a kayword
	argument which defaults to 'None'.
	(ContentNode._create_child): New method.
	(ContentNode._id): Comment transformed to a docstring.
	(ContentNode._id): Split the CamalCase names with dashes.
	(ContentNode.subdir): Return parents `subdir()' when
	`self._subdir' is None.
	(Resource, Media, Script, Stylesheet): Moved from here to the
	`content' module.
	(Use): Class removed.
	(Vocabulary._create_content): Pass correct arguments to the
	feeder.  Wrap feered output to a `VocabList'.
	(Vocabulary.items): New method.
	(Grammar._TITLE): Changed.
	(VocabularyPractice, ExerciseNode, ListeningComprehension) 
	(GrammarPractice, Consolidation): New classes.
	(Unit._create_children): Completely rewritten.
	(EurochanceCourse._create_children): Use `_create_child()'.

	* lcg/content.py (VocabItem._DIACRITICS_MATCHER)
	(VocabItem._DANGER_CHAR_MATCHER): New constants. 
	(VocabItem.__init__): Argument `media' removed.  Create the
	`Media' instance here.
	(VocabItem.word): New method.
	(VocabItem.word): New method.
	(Exercise.__init__): When `transcript' not defined, make it out of
	`sound_file' filename.
	(VocabExercise): New class.
	(VocabExercise): New class.
	(Resource, Media, Script, Stylesheet): Moved here from the
	`course' module.

	* lcg/util.py (SplittableText.__init__): New argument `input_file'.
	(SplittableText): Documentation updated.
	(SplittableText.__init__): New argument `input_file'.  Docstring added.
	(SplittableText.input_file): New method.
	(SplittableText._create_piece): Pass the `input_file' to the
	constructor and use keyed arguments.

	* lcg/export.py: Import everything from `content'.

2004-12-18  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (en de): Added some preprocessing of wrong unicode files.

	* lcg/wiki.py
	(CommonFormatter._tickethref_formatter)
	(CommonFormatter._changesethref_formatter) 
	(CommonFormatter._reporthref_formatter)
	(CommonFormatter._svnhref_formatter): Removed.
	(CommonFormatter._rules): Removed rules for removed methods.
	(CommonFormatter._wikilink_formatter): Don't look for a page in
	the `page_dict'.

	* lcg/feed.py (ExerciseFeeder._exercise): Pass a `SplittableText'
	instance to `self._read_task()', not a string .
	(ExerciseFeeder._read_task): Convert the `SplittableText' to a
	string before passing to a method.

2004-12-15  Tomas Cerha  <cerha@brailcom.org>

	* bin/generate.py: Set the input encoding to 'utf-8'.

	* lcg/feed.py (ExcelVocabFeeder._TRANSLATION_ORDER): Include just
	the tuple of laguage codes here.
	(ExcelVocabFeeder._ENCODING): New constant.
	(ExcelVocabFeeder.feed): Use the new constants.
	(ExcelVocabFeeder.feed.safe_char): Return an empty string for
	punctuation characters.
	(ExcelVocabFeeder.feed): Report the filename and the
	word for `UnicodeDecodeError'.
	(ExerciseFeeder.feed): Report the filename for
	`UnicodeDecodeError'.
	(ExerciseFeeder._exercise): Use the `text()' method when passing
	the pieces of `SplittableText' to further processing.
	(ExerciseFeeder._read_header): Consider `text' as a string. not
	`SplittableText'.
	(ExerciseFeeder._read_header): Convert the key to a plain string.
	Convert the exercise type to a plain string.


	* lcg/util.py (SplittableText.text): New method.

	* lcg/course.py (ContentNode._read_file): Reportthe filename on
	`UnicodeDecodeError'.
	(Consolidation): Renamed to `Summary'.
	(Summary._TITLE): Reflect the name change. 
	(Unit._create_children): `Consolidation' -> `Summary'.

	* lcg/content.py (Exercise.__init__): Make an assertion to an
	instance of `types.StringTypes'.

2004-12-12  Tomas Cerha  <cerha@brailcom.org>

	* translations/de.po: Translations improved.

2004-12-08  Tomas Cerha  <cerha@brailcom.org>

	* doc/manual.wiki (Vocabulary): Section updated.
	(Transformation): Section updated.

	* lcg/content.py (TrueFalseStatement.__init__): Use gettext to get
	the translated labels.

	* lcg/export.py (StaticExporter._navigation): Use the
	`toc_title()' method of parent node, not of the current one.

	* lcg/feed.py (ExcelVocabFeeder.feed): Use the diacritical
	characters for filenames, but strip the diacritics.  Exclude the
	parent node's language from the translation column order.

	* translations/de.po: New strings added.  Initial dictionary
	translations made.

2004-12-07  Tomas Cerha  <cerha@brailcom.org>

	* translations/de.po: New file.

	* Makefile (LCG_TTS_COMMAND): Export the LCG environment
	variables.  Make the German course as well as the English one.
	Extract the translatable strings and create gettext message
	catalogs.

	* bin/generate.py: New agument language.  Install the gettext
	translator.  Pass the `language' and `encoding' arguments to the
	course constructor. 

	* lcg/content.py (VocabItem.__init__, Choice.__init__)
	(Choice.__init__, TrueFalseStatement.__init__, ClozeTask.__init__)
	(TransformationTask.__init__): Expect the arguments in unicode.
	Don't convert them here.
	(_ChoiceBasedExercise._answer_control): Translate the strings with
	gettext.
	(Exercise._task_type): Renamed to `_TASK_TYPE'.
	(Exercise._name): Renamed to `_NAME.
	(Exercise._header): Translate the strings using gettext.
	(Exercise._export_instructions): Translate the strings using
	gettext.
	(_ChoiceBasedExercise._task_format): Renamed to `_TASK_FORMAT.
	(SentenceCompletion, Transformation, Cloze,
	MultipleChoiceQuestions)
	(Selections, GapFilling): Define `_NAME'.  `_TASK_TYPE' ->
	`_task_type'.

	* lcg/export.py (StaticExporter._navigation, StaticExporter._toc):
	Use gettext to translate language dependent strings.
	(StaticExporter._navigation): Use `node.toc_title()' instead of
	defining the titles here.

	* lcg/feed.py (Feeder.__init__): New keyword argument `encoding'.
	(ExcelVocabFeeder._LANGUAGE_ORDER, ExcelVocabFeeder._CHARSET):
	Removed.
	(ExcelVocabFeeder._TRANSLATION_ORDER): New constant.
	(ExcelVocabFeeder.feed): Don't use `parent.lang()'.  Use
	`self._TRANSLATION_ORDER' instead of
	`ExcelVocabFeeder._LANGUAGE_ORDER' and `ExcelVocabFeeder._CHARSET'
	Convert the `VocabItem' constructor arguments to unicode first.
	(ExerciseFeeder._slitter_matcher,
	ExerciseFeeder._blank_line_matcher)
	(ExerciseFeeder._header_matcher): Renamed to upper case names.
	(ExerciseFeeder.feed): Read the input file through
	`codecs.open()'.
	(ExerciseFeeder._exercise): `self._blank_line_matcher' ->
	`self._BLANK_LINE_MATCHER'.
	(ExerciseFeeder._read_header): `self._header_matcher ->
	`self._HEADER_MATCHER.
	(ExerciseFeeder._read_task): Covert the text to unicode before
	calling the right method. 
	(ExerciseFeeder._read_transformation): Add default brackets to the
	transformation when no brackets found.

	* lcg/course.py: Import `codecs'.
	(ContentNode._TITLE): New constant.
	(ContentNode.__init__): New keyword attributes `language' and
	`input_encoding'.
	(ContentNode._read_file): Open the file using `codecs.open()' and
	use the `input_encoding' passed to the constructor.
	(ContentNode.title): Just return `self.TITLE'.
	(ContentNode.full_title): Use a list comprehension instead of
	`map()'.
	(ContentNode.lang): Removed.
	(ContentNode.language): New method.
	(ContentNode.input_encoding): New method.
	(RootNode.__init__): Pass the keyword arguments to the parent
	class constructor.
	(Media._open_stream_from_tts): Use `codecs.open()' to read the
	transcript file with a direct conversion to unicode.
	(Media._open_stream_from_tts): Encode the text written to the
	pipe.
	(Vocabulary._TITLE, Use._TITLE, Grammar._TITLE, Exercises._TITLE)
	(Consolidation._TITLE, Unit._TITLE): New constants.
	(Use._title, Grammar._title): Removed.
	(Vocabulary._create_content): Pass the `encoding' to the feeder.
	(Exercises._create_content): Pass the `encoding' to the feeder.
	(Unit._create_children): Use a list comprehension instead of
	`map()'.  Pass the keyword arguments to node constructors.
	(Unit.title): Use `self._TITLE' to get the node name.
	(EurochanceCourse._create_children): Use a list comprehension
	instead of `map()'.
	(EurochanceCourse.meta): Values changed.
	(ContentNode._TOC_TITLE): New constant.
	(ContentNode.title): New method.
	(Unit._TOC_TITLE): New constant.

	* lcg/util.py: Import `types'.
	(SplittableText.__init__): Use `isinstance()' with a corresponding
	type for assertions.

2004-11-03  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (LCG_MP3_COMMAND): New variable.
	(LCG_OGG_COMMAND): New variable.
	(all): Export new variables.

	* lcg/course.py (Resource.SUBDIRECTORY, Media.SUBDIRECTORY)
	(Script.SUBDIRECTORY, Stylesheet.SUBDIRECTORY): Renamed to
	`SUBDIR'.
	(Resource.__init__): Initialize the variables `self._src_path' and
	`self._dst_path'.
	(Resource.source_file): Method removed.
	(Resource._find_source_file): New Method.
	(Resource.destination_file): Renamed to `_destination_file'.  Use
	`self._dst_path'.
	(Resource.export, Resource.export): New methods.
	(Media.__init__): Media type assertion.
	(tts_input): Method removed.
	(Media._find_source_file): New Method.
	(Media._command): New Method.
	(Media._open_stream_from_tts): New Method.
	(Media._open_stream_from_encoder): New Method.
	(Media._open_stream_from_encoder): New Method.

	* lcg/content.py (Exercise.__init__): Don't set the `tts_input'
	argument for the Media instance of the recording.

	* lcg/util.py (copy_stream): New function.

2004-10-23  Tomas Cerha  <cerha@brailcom.org>

	* resources/scripts/exercises.js (count):
	(event_key): New function.
	(event_target): New function.
	(highlight): New function.
	(eval_choice): New function.
	(reset_choices): New function.
	(display_choice_results): New function.
	(init_cloze_form): New function.
	(last_correct_char_index): New function.
	(handle_cloze_field_keypress): New function.
	(eval_cloze_field): New function.
	(eval_answer): Function removed.
	(eval_cloze): Don't take the `answers' as argument.
	(fill_cloze): Don't take the `answers' as argument.
	

	* resources/scripts/audio.js (play_audio): Don't set status-bar
	messages.

	* resources/css/default.css: Reflect the changes in page structure.

	* lcg/content.py (Content._field): Cosmetic hanges.
	(Content._button): Always add the `button' class.
	(Content._script): New method.
	(Content._script_write): Use it.
	(Exercise.task_index): Method removed.
	(Exercise.form_name): Renamed to `_form_name'.
	(Exercise._form): New method.
	(Exercise._export_tasks): Method removed.
	(Exercise._init_script): New method.
	(Exercise.export): Print the Javascript code returned by the
	`_init_script()' method after the form.  Don't use
	`_export_tasks()', just map `_export_tasks()' to all tasks.
	(Cloze._init_script): New method.
	(Cloze._results): New method.
	(Cloze._export_tasks): Method removed.
	(Cloze._make_field): Use `self._field()'.
	(_ChoiceBasedExercise._answer_control): Take `task' as argument
	and not form_name and task number.  Use `eval_choice()' as
	javascript handler.
	(Cloze._export_tasks): Removed (transformed to `_results()').
	(_ChoiceBasedExercise._results): New method.
	(_ChoiceBasedExercise._format_choice): Reflect the change in
	`_answer_control()' arguments.
	(TrueFalseStatements._format_choice): Reflect the change in
	`_answer_control()' arguments.

2004-10-22  Tomas Cerha  <cerha@brailcom.org>

	* resources/scripts/exercises.js (eval_answer): New function.

	* resources/css/default.css (a): Styles improved.

	* lcg/feed.py (ExcelVocabFeeder.feed): Don't print warnings on
	untranslated words.
	(ExerciseFeeder._read_task): Don't take the `parent' the first argument.
	(ExerciseFeeder._exercise): Respect it.
	(ExerciseFeeder._read_multiple_choice_question) 
	(ExerciseFeeder._read_gap_fill_statement) 
	(ExerciseFeeder._read_cloze, ExerciseFeeder._read_transformation) 
	(ExerciseFeeder._read_true_false_statement) 
	(ExerciseFeeder._read_multiple_choice_question): Don't take
	`parent' as argument'
	(ExerciseFeeder._read_task): Respect it.

	(ExerciseFeeder._read_selection)
	(ExerciseFeeder._read_multiple_choice_question):

	* lcg/content.py (Content._button): method.
	(Content._field): New method.
	(Content._answer_control): Method removed.
	(Task): Don't derive from `Content' (just `object').
	(_ChoiceTask): New class.
	(Selection, MultipleChoiceQuestion, TrueFalseStatement): Derive
	from `_ChoiceTask'.
	(Selection._format_choice, Selection._choice_controls)
	(Selection.export, TrueFalseStatement._format_choice)
	(TrueFalseStatement.export, ClozeTask._make_field)
	(ClozeTask._export_text, ClozeTask.export)
	(TransformationTask.export): All removed.
	(ClozeTask, TransformationTask, Selection, TrueFalseStatement,
	(MultipleChoiceQuestion, GapFillStatement): Don't take parent as
	constructor argument.

	(Exercise.task_type): New method.
	(Exercise.task_type): New Method.
	(Exercise.export): Use it.
	(Exercise._export_task) New method.
	(Exercise._export_instructions): Use `Content._button' and
	`Content._script_write()' for rendering the controls.
	(Exercise.__init__): Require the script `exercises.js'.
	(Cloze._export_tasks): Use `Content._button' and
	`Content._field()' and `Content._script_write()' for rendering the
	controls.
	(Cloze._make_field): New method.
	(Cloze._export_task): New method.
	(_ChoiceBasedExercise): New class.
	(TrueFalseStatements, MultipleChoiceQuestions, Selections) 
	(GapFilling): Derive from `_ChoiceBasedExercise'.
	(Dictation._export_task): New method.

	(TransformationTask.orig): New method.
	(ClozeTask.text): New method.
	
2004-10-21  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: New styles added.

	* lcg/export.py (Exporter._export_node): Pass the exported content
	to `self._wrap_content()'.
	(Exporter._wrap_content, StaticExporter._wrap_content): Take the
	exported content as an argument.

	* lcg/content.py (Content._script_write): New method.
	(Content._speaking_text): New method.
	(Content._answer_control): New method.
	(VocabList.export): Use self._speaking_text() to render the
	english word.
	(VocabItem.__init__): The `sound_file' arguemtnt renamed to `media'.
	(Selection._format_choice): New method.
	(Selection._choice_controls): Use `self._format_choice()' to
	format the choice.
	(Selection._export_choices): Render choices as a div with separate
	lines, rather than
	an ordered list.
	(MultipleChoiceQuestion.export): Enclose the whole task in a
	paragraph (including the choices).
	(TrueFalseStatement._format_choice): New method.
	(TrueFalseStatement._export_choices): Return the controls just as
	they are, without any aditional formatting.
	(Exercise.export): Wrap all the tasks in a form.  Pass the form
	name to `self._export_tasks()'.
	(Exercise._export_tasks): Take the `form_name' argument.
	(Exercise._export_instructions): Use `self._script_write()' to
	format the recording controls compatible also with non-javascript
	enabled browsers.
	(Cloze._export_tasks): Take the `form_name' argument.  Prefix the
	onClick handler with "javascript: ".
	(Cloze._export_tasks): Don't wrap the tasks in a form.
	(TrueFalseStatements._instructions): Cosmetic changes.
	(Selection._export_choices): Method removed.
	(TrueFalseStatement._export_choices): Method removed.
	(Selection.export): Don't use `self._export_choices()'.
	(MultipleChoiceQuestion.export): Don't use `self._export_choices()'.
	(TrueFalseStatement.export): New method.

2004-10-20  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (all): Don't pass the stylesheet argument to the
	generator script.
	(sync-data): Directories fixed.

	* lcg/course.py (ContentNode.__init__): New argument `default_resource_dir'.
	(ContentNode.default_resource_dir): New method.
	(Resource.source_file): If the source file does not exist, try the
	`default_resource_dir' directory.
	(Resource.name): New method.
	(Media.name): Moved to parent class.

	* lcg/content.py (Cloze.__init__): The script name changed to
	`exercises.js'.
	(VocabItem.__init__, Choice.__init__)
	(MultipleChoiceQuestion.__init__, TrueFalseStatement.__init__)
	(ClozeTask.__init__, TransformationTask.__init__)
	(Exercise.__init__): Use `isinstance()' for type assertions
	/`StringTypes' for strings and BooleanType' for boolean data/.
	Convert string values to unicode.

	* resources/scripts/exercises.js: New file.

	* resources/scripts/audio.js: New file.

	* resources/css/default.css: New file.

	* lcg/export.py (StaticExporter._wrap_content): Don't export the
	MediaPlayer object.
	(StaticExporter._wrap_content): Alocate the stylesheet only if
	it is not None.

2004-10-19  Tomas Cerha  <cerha@brailcom.org>

	* TODO: New file.

	* COPYING: New file.

	* Makefile (sync-data): New target.
	(sync): New target.

	* lcg/export.py (Exporter._export_node): Convert the contents to
	UTF-8 before writing the file.
	(StaticExporter._wrap_content): Set the charset to UTF-8.  Include
	the Media Player object in the header to make it available in MSIE.

	* lcg/feed.py (ExcelVocabFeeder._CHARSET): New constant.
	(ExcelVocabFeeder.feed): Convert the translation to unicode.

	* lcg/content.py (VocabItem.__init__): Accept also a unicode
	string as a `translation' arg.
	(Exercise.__init__): Allocate the dependency on the `audio.js'
	script.
	(Transformation._instructions): Unwanted backslash removed.

	* lcg/content.py (Exercise._export_instructions): Format the
	Recording launcher as a button, rather than a link.

2004-10-18  Tomas Cerha  <cerha@brailcom.org>

	* lcg/export.py (StaticExporter._hotkey): Use just numbers as
	shortcut keys.

	* lcg/course.py (Media.name): New method.

	* lcg/content.py (Transformation._instructions): New method.

2004-10-05  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py (TrueFalseStatement.export): New method.
	(ClozeTask._export_text): New method.
	(ClozeTask.export): Use it.
	(TransformationTask._make_field): Method removed.
	(TransformationTask.__init__): New method.
	(TransformationTask.export): New method.

	* lcg/feed.py (ExcelVocabFeeder_LANGUAGE_ORDER): Spanish added.
	(ExerciseFeeder._read_transformation): Make sure that there are
	just two lines.  Pass each line as a separate argument to
	`TransformationTask' constructor.

	* doc/manual.wiki: Exercise names updated.  New exercise types
	added.  Task type descriptions moved to the descriptions of
	corresponding exercise types.

2004-10-04  Tomas Cerha  <cerha@brailcom.org>

	* lcg/feed.py (ExerciseFeeder._read_task): Honour the name change
	`Cloze' -> `ClozeTask' and `Transformation' ->
	`TransformationTask'.
	(ExerciseFeeder._read_cloze): Honour the name change `Cloze' ->
	`ClozeTask'.
	(ExerciseFeeder._read_transformation): Honour the name change
	 `Transformation' -> `TransformationTask'.

	* lcg/content.py (Selection.export): Don't wrap the choices into a
	paragraph.
	(MultipleChoiceQuestion.export): Don't include the choices in the
	paragraph, leave there just the question.
	(Cloze): Renamed to `ClozeTask'.
	(ClozeTask.__init__): Honour the change `Cloze' -> `ClozeTask'.
	(Transformation): Honour the change `Cloze' -> `ClozeTask'.
	(Transformation): Renamed to `TransformationTask'.
	(TransformationTask._make_field): Honour the change
	`Transformation' -> `TransformationTask'.
	(Exercise.__init__): New optional arguments `sound_file' and
	`transcript'.  Initialize the corresponding media object if a
	`sound_file' specified.
	(Exercise._header): If `self._name' is Null, take the name from
	class name.
	(ListeningExercise): Class removed.
	(Exercise._export_instructions): If `sound_file' was specified in
	constructor, include the link to play the recording.
	(ClozeTest): Renamed to `Cloze'.
	(Cloze_task_type): Honour the change `Cloze' -> `ClozeTask'.
	(Cloze_name): Removed.
	(Cloze.__init__): Honour the change `ClozeTest' -> `Cloze'.
	(Cloze._instructions): Return different instructions when the
	`sound_file' was specified at constructor.
	(Cloze._export_tasks): Use the 'action' attribute for the <form>
	tag.
	(ListeningClozeTest): Class removed.
	(TrueFalseExercise): Renamed to `TrueFalseStatements'.
	(TrueFalseComprehensionExercise): Class removed.
	(MultipleChoiceExercise): Renamed to `MultipleChoiceQuestions'.
	(MultipleChoiceQuestions._name): Removed.
	(MultipleChoiceComprehensionExercise): Class removed.
	(SelectionExercise): Renamed to `Selections'.  Honour the parent
	class name change.
	(ListeningSelectionExercise): Class removed.
	(GapFillingExercise): Renamed to `GapFilling'.  Honour the parent
	class name change.
	(GapFilling._name): Removed.
	(SentenceCompletionExercise): Renamed to `SentenceCompletion'.
	Honour the parent class name change.
	(SentenceCompletion._name): Renmoved.
	(TransformationExercise): Renamed to `Transformation'.  Honour the
	parent class name change.
	(Transformation._task_type): Honour the change `Transformation' ->
	`TransformationTask'.
	(Transformation._name): Removed. 
	(Dictation): Honour the change `ClozeTest' -> `Cloze'.
	(Dictation._name): Removed. 

	* lcg/export.py (StaticExporter._wrap_content): Added support for
	http-equiv meta tags and encoding specified.  Don't forget to
	close the <script> header tag.  Use the 'type' attribute with the
	<script> tag.

2004-10-01  Tomas Cerha  <cerha@brailcom.org>

	* lcg/content.py
	(Selection): New class based on `MultipleChoiceQuestion'
	implementation.
	(MultipleChoiceQuestion): Derive from `Selection' and only extend
	the cnostructor and the `export()' method with the question.
	(TrueFalseStatement._export_choices): Respect the changes in
	parent class.
	(Cloze._REGEXP): New constant.
	(Cloze.__init__): Don't allocate the resources (media and
	scripts).
	(Cloze.answers): New method.
	(Cloze._make_field): Don't add the word to self._answers().
	(Cloze.export): Don't export anything related to the form.  Export
	just a paragraph of text with input fields.
	(Transformation): New class.
	(Exercise._export_tasks): New method.
	(Exercise.export): Use it.
	(ListeningExercise.__init__): Read the transcript file and use it
	as `tts_input' argument for the created `Media' object.
	(ClozeTest.__init__): Allocate the media and script for exercise
	evaluation.
	(ClozeTest._instructions): New method.
	(ClozeTest._export_tasks): Export also a form and controls for
	exercise evaluation.
	(ListeningClozeTest): New class.
	(SelectionExercise): New class.
	(ListeningSelectionExercise): New class.
	(GapFillingExercise._instructions): Text updated.
	(MultipleChoiceExercise._instructions): Text updated.
	(SentenceCompletionExercise): New class.
	(TransformationExercise): New class.
	(Dictation): New class.

	* lcg/export.py (Exporter._export_resource): Escape apostrophes in
	a TTS input.
	(StaticExporter._wrap_content): Don't use the `type' attribute for a
	`script' tag (doesn't work with Mozilla).

	* lcg/course.py (ContentNode.lang): New method.

	* lcg/feed.py (ExcelVocabFeeder._LANGUAGE_ORDER): New constant.
	(ExcelVocabFeeder.feed): Assertion for parent language existence
	in `self._LANGUAGE_ORDER'.
	(ExcelVocabFeeder.feed): Search the translation according to
	parents language and the `_LANGUAGE_ORDER' constant.  Don't
	require all the columns to exist (but report missing
	translations).
	(ExerciseFeeder._read_task): Add a mapping for `Selection' type
	task.
	(ExerciseFeeder._process_choices): Don't expect the statement in
	the input, unpack just the choices.  Take the sequence of lines as
	argument instead of multiline text.
	(ExerciseFeeder._read_selection): Nová metoda.
	(ExerciseFeeder._read_multiple_choice_question)
	(ExerciseFeeder._read_gap_fill_statement): Split the text to lines
	and treat the question/statement separately.  Process only the
	remaining lines with `_read_selection()'.
	(ExerciseFeeder._read_task): New mapping for `Transformation'.
	(ExerciseFeeder._read_transformation): New method'

2004-09-24  Tomas Cerha  <cerha@brailcom.org>

	* lcg/ims.py (_Manifest._create_item): Use
	`ContentNode.resources()' instead of `ContentNode.list_media()'.
	Use `self._export_resource()' instead of
	`ContentNode._export_media()'.

	* lcg/export.py (Exporter._export_node): Use
	`ContentNode.resources()' instead of `ContentNode.list_media()'.
	Use `self._export_resource()' instead of
	`ContentNode._export_media()'.
	(Exporter._export_media): Renamed to
	`Exporter._export_resource()'.
	(Exporter._export_resource): Do the TTS only for Media instances.
	(StaticExporter._wrap_content.tags): New function.
	(StaticExporter._wrap_content): Use it instead of `self._meta()'
	and `self._links()'.  Include HTML head tags for all `Script' and
	`Stylesheet' instances this node depends on.
	(StaticExporter._meta): Method removed.
	(StaticExporter._links): Method removed.
	(StaticExporter.export): Method removed.
	(StaticExporter._wrap_content): Set the `language' attribute of
	the header `script' tag.

	* lcg/course.py: Docstring updated.
	(ContentNode): Docstring updated.
	(ContentNode.__init__): Docstring updated.
	(ContentNode._media: Renamed to `_resources'.
	(ContentNode._read_resource): Renamed to `_read_file'.
	(ContentNode.list_media): Renamed to `resources'.  New argument
	cls to filter the returned list.
	(ContentNode._resource): New method.
	(ContentNode.media): Use it.
	(ContentNode.script): New method.
	(ContentNode.stylesheet): New method.
	(TextNode._create_content, InnerNode._create_content)
	(InnerNode.title): `ContentNode._read_resource()' ->
	`ContentNode._read_file'.
	(Resource): New class (based on the Media code.
	(Media): Derive from it.  Most methods moved to Resource.
	(EurochanceCourse._create_children): Suppose only directories
	beginning with numbers as unit subdirectories.
	(Script, Stylesheet): New classes.

	* lcg/content.py (Cloze.__init__): Allocate media files for the
	evaluation response.
	(Cloze._form_name): Method removed.
	(Cloze._script.check): Function removed.
	(Cloze._script): Make the evaluation function generic, taking the
	form and correct answers as arguments.  Play a response sound
	after evaluation.  Mark incorrect answers by an exclamation mark.
	(Cloze.export): Pass the form name and correct answers as an
	argument to a Javascript evaluation function.
	(Cloze.__init__): Don't store the media in attributtes, just
	allocate the dependency as well as the new dependency for the
	Javascript code `eval-cloze.js'.
	(Cloze._script): Method removed.
	(Cloze.export): Don't use the removed `_script()' method.

2004-09-23  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (all): Pass a stylesheet filename to the generator.

	* bin/generate.py (course): Take the stylesheet name as a third
	argument and pass it to the StaticExporter constructor.

	* lcg/content.py (Cloze.__init__): Initialize the variable
	`self._answers'.
	(Cloze._make_field): Don't set fields style at all.  Store the
	words in the `self._answers' array.
	(Cloze._form_name): New method.
	(Cloze._script.check): New method.
	(Cloze.export): Include also the evaluate button and the
	Javascript code to evaluate the results.
	(Exercise._header): New method.
	(Exercise.export): Use it.

	* lcg/export.py (StaticExporter.__init__): New method.
	(StaticExporter._wrap_content): Add a stylesheet link to the
	header if a stylesheet is defined.  Set the class of the `<hr>'
	tag to separate the nevigation.  Don'd set the bgcolor body
	attributte.  Wrap the content in a div.
	(StaticExporter._div): New method.
	(StaticExporter._navigation): Wrap the result in a div.
	(StaticExporter._toc): Wrap the result in a div.
	(StaticExporter.export): New method (copy the stylesheet file
	after exporting).
	(StaticExporter._wrap_content): Add the `next' and `prev' `link'
	tags to the header.  Add an anchor with an accesskey to the
	beginning of the contents.
	(StaticExporter._hotkey): New variable. 
	(StaticExporter._links): New method. 
	(StaticExporter._navigation): Add hotkeys to the links.
	(StaticExporter._link): New keyword argument 'key'.

2004-09-03  Tomas Cerha  <cerha@brailcom.org>

	* lcg/export.py (StaticExporter._link): New method.
	(StaticExporter._navigation): Use it.  Also create a link to
	parent node when it's not a root node.

	* lcg/course.py (ContentNode.parent): New method.
	(Media.source_file): Cosmetic improvements. 

2004-09-01  Tomas Cerha  <cerha@brailcom.org>

	* lcg/export.py (StaticExporter._toc): New method.
	(StaticExporter._make_toc): New method.
	(StaticExporter._wrap_content): Use self._toc().

	* lcg/content.py (TableOfContents): Class removed.

	* Makefile: Remove the html files before running the generator.
	Don't zip the package.  Export the `LCG_TTS_COMMAND' variable.

	* lcg/course.py (ContentNode.linear, ContentNode.next) 
	(ContentNode.prev): Docstring written.
	(ContentNode.index): New method.
	(ContentNode._node_path): New method.
	(ContentNode._id): New method.
	(ContentNode.id): Don't use the subdir to construct the id, use
	concatenating the hierarchy of `self._id()'.
	(ContentNode.full_title): Use `self._node_path()'.
	(ContentNode.counter): Docstring updated.
	(NumberedNode): Class removed.
	(Course.output_file): Method removed.
	(Unit): Inherit `InnerNode', not `NumberedNode'.
	(Unit._id): New method.
	(Unit.title): New method.
	(EurochanceCourse._create_children): Don't create the counter for
	counting NumberedNode's number.
	(ContentNode.__str__): Don't report the `output_file'.
	(Course): Renamed to `RootNode'.
	(RootNode.__init__): Honour the name change.
	(Media.__init__): Docstring updated.
	(EurochanceCourse): `Course' -> `RootNode'.
	(RootNoode._create_content): Method removed. 

2004-08-31  Tomas Cerha  <cerha@brailcom.org>

	* bin/generate.py: Use the `StaticExporter' to export the content.

	* lcg/__init__.py: Import also the  modules `export' a `ims'.

	* lcg/course.py: Module docstring updated.
	(ContentNode): Docstring updated.
	(ContentNode._export): Method removed.
	(full_title): Method removed.
	(ContentNode.content): New method.
	(export): Method removed.
	(Course): Docstring updated.
	(_export): Method removed.
	(Media._source_file): Renamed to `source_file()'.
	(Media._destination_file): Renamed to `destination_file()'.
	(Media.__init__, Media.url): Honour the change above.
	(Media.export): Method removed.
	(ContentNode.__str__): Report `subdir' instead of `src_dir'.
	(ContentNode.__str__): Use
	(ContentNode.linear): New method.
	(ContentNode.next): New method.
	(ContentNode.prev): New method.
	(ContentNode.subdir): New method.
	(ContentNode.dst_dir): Method removed.
	(ContentNode.src_dir): Construct the path out of root nodes
	`src_dir' and the `subdir'.
	(ContentNode.id): Make the id out of name and `subdir'.
	(ContentNode.full_title): New method.
	(ContentNode.meta): New method.
	(Course.output_file): Don't use `self.dst_path()'.
	(Media.shared_directory): Renamed to `SUBDIRECTORY'.
	(Media.source_file): `self.shared_directory' ->
	`self.SUBDIRECTORY'.
	(Media.destination_file): Put all media files into one directory,
	with a subdirectory for each node.
	(EurochanceCourse._create_children): New method.

	* lcg/ims.py (Manifest): Renamed to `_Manifest'. 
	(IMSExporter): New class.

	* lcg/export.py (Module): New module.
	(Exporter._full_title): Method removed.
	(Exporter._export_node): Put all files into the same directory.
	(Exporter._wrap_content): Use `node.full_title()' instead of
	`self._full_title()'.
	(Exporter._export_media): Don't take the `dir' argument.  Use
	`self._dir' instead.
	(StaticExporter._wrap_content): Print the doctype, meta
	information, title header and navigation.
	(StaticExporter._wrap_content): New method.
	(StaticExporter._wrap_content): New method.

2004-06-25  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py (Media.export): Set the `cmd' to None first.

2004-06-24  Tomas Cerha  <cerha@brailcom.org>

	* lcg/course.py (Media.export): Use the LCG_TTS_COMMAND
	environment variable.  If not set, don't try to synthesize the text.

2004-06-23  Tomas Cerha  <cerha@brailcom.org>

	* Makefile: Set the `LCG_TTS_COMMAND' environment variable.

2004-05-21  Tomas Cerha  <cerha@brailcom.org>

	* doc/structure.wiki: Finished.

	* doc/manual.wiki: Finished.

2004-05-20  Tomas Cerha  <cerha@brailcom.org>

	* doc/manual.wiki: New file.

	* doc/structure.wiki: New file.

	* doc/roles.wiki: New file.

2004-05-14  Tomas Cerha  <cerha@brailcom.org>

	* lcg/util.py (SplittableText): New class.

	* lcg/_test.py (SplittableText): New set of tests.

	* lcg/feed.py: Import the Python module `traceback'.  Import `util'.
	All commented-out classes at the end of file removed.
	(Feeder.__init__): New method.
	(Feeder._input_file): New method.
	(PySpecFeeder): More documentation added.
	(PySpecFeeder._input_file): New method.
	(PySpecFeeder.__init__): Method removed.
	(PySpecFeeder._get_module): Use `self._file' instead of
	`self._name'.
	(ExcelVocabFeeder.__init__): Method removed.
	(ExcelVocabFeeder.feed): Use `self._input_file()'
	(ExerciseFeeder): New class.
	(ExerciseFeeder_PieceOfText): Removed.
	(ExerciseFeeder.feed): Use `SplittableText' instead of
	`self._PieceOfText'.
	(ExerciseFeeder._exercise, ExerciseFeeder._read_task): Use the
	`traceback' module for printing tracebacks instead of
	`code.InteractiveInterpreter'.
	(ExerciseFeeder._read_header): Docstring added.  Assertion message
	simplified.

	* lcg/course.py (ContentNode._read_resource): Don't use the language
	extension for filenames.
	(Module): Class removed.
	(Exercises._create_content): Use `ExerciseFeeder' instead of
	`PySpecFeeder'.
	(Unit._create_children): Act as the removed `Module' node
	according to course structure changes.
	(EurochanceCourse): Documentation updated.
	(EurochanceCourse._create_children): Create just a sequence of `Unit's.

	* lcg/content.py (Exercise.__init__): Report the actual `tasks' value
	in assertion error message..
	(Exercise.task_type): New method.
	(ComprehensionExercise.__init__): Method removed.
	(ClozeTest.__init__): Method removed.
	(ClozeTest._task_type): Set.
	(Container.__init__, GenericText.__init__, VocabList.__init__)
	(MultipleChoiceQuestion.__init__, Cloze.__init__)
	(Exercise.__init__, ComprehensionExercise.__init__): Call parent
	constructor prior to everyting else.

	* lcg/__init__.py: Update globals for module `feed' as well.

2004-05-04  Tomas Cerha  <cerha@brailcom.org>

	* lcg/_test.py (ContentNode.check_misc): Check also the methods
	`counter()', `id()' and `children()'.

	* lcg/course.py (ContentNode._create_content) 
	(ContentNode._create_children): More documentation added.
	(ContentNode._register_child): New method.
	(ContentNode.__init__): Use it.
	(Course): Docstring improved.
	(ContentNode._create_children): Docstring improved.
	(ContentNode._create_content): Docstring improved.
	(ContentNode): Docstring improved.

2004-05-03  Tomas Cerha  <cerha@brailcom.org>

	* lcg/_test.py (Module): Import `lcg' and `os', not `lesson'.
	(ContentNode): New class
	(Client): Class removed.
	

	* lcg/course.py (Module): Code reorganized to separate the general
	classes from the classes implementing concrete Eurochance Course
	structure.
	(EurochanceCourse): New class.
	(Course._create_children): Method moved to the new
	`EurochanceCourse' class.
	(Course.__init__): Unused argument `lang' removed.
	(NumberedNode.__init__, Course.__init__): Use `super()' to call
	the constructor of parent class.
	(ContentNode.src_dir): Return just the subdir if parent is None.
	(ContentNode.dst_dir): Return just the subdir if parent is None.
	(Course.output_file): New method.
	(dst_dir): Method removed.

	* lcg/util.py (list_subdirs): Ignore `CVS' directories.

	* Makefile: New target `test'.

	* bin/generate.py: Use `EurochanceCourse' instead of `Course'.
	Don't use the `lang' argument.

